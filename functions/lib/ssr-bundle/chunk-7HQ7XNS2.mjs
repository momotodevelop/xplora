import './polyfills.server.mjs';
import{$ as yt,$a as pw,A as Op,Aa as Fp,Ba as Bp,Ca as Rt,Cb as Cw,Db as Zu,Ea as Fa,Eb as Iw,F as Tn,Fb as es,Ga as Ju,Gb as Gn,H as Qi,Ha as Xu,Hb as Qr,Ia as Xs,J as Sr,Ja as ze,Ka as Up,L as Np,La as uw,Lb as jp,M as Qs,Ma as Zs,Ob as el,P as Ys,Pb as Dw,Q as Wr,Qa as lw,Qb as $p,Ra as Vp,Rb as Va,S as kp,Sa as dw,Sb as qa,T as sw,Ta as Kr,Tb as Aw,Va as qp,W as Pp,Wa as hw,Ya as fw,Za as Ba,_ as Mp,a as ZS,aa as ow,ad as tl,b as bp,bb as Ua,bd as kw,c as nn,ca as st,cb as Ji,cd as Pw,d as Cp,da as oe,db as eo,dd as za,e as Ip,eb as gw,ed as Mw,f as En,fb as mw,fc as Rw,g as Ne,ga as K,gb as yw,ha as Yi,hb as vw,i as ew,ia as aw,ib as Ew,id as Gp,j as tw,ja as X,jb as _w,jd as ro,ka as xp,kb as Tw,kd as xw,l as _n,la as Y,lb as Xi,lc as Ow,ld as Lw,m as Qu,ma as F,mc as Mt,n as Dp,nc as Le,nd as Fw,o as Ap,oa as qt,p as We,pb as Sw,pd as Bw,q as W,qa as rn,qd as ja,r as La,ra as cw,rc as Nw,s as nw,sa as $n,sb as Zi,t as rw,ta as vt,tb as zp,ua as Lp,ud as nl,v as he,va as Js,vb as ww,w as Yu,wb as to,x as Pt,xb as Ce,y as Rp,yb as bw,yd as Uw,z as iw,zb as no}from"./chunk-IB7CNCDV.mjs";import{a as $,b as it,c as _e,d as JS,e as A,f as XS,h as E}from"./chunk-S6KH3LOX.mjs";var ve=A(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=an.DEFAULT_MAX_SEND_MESSAGE_LENGTH=an.Propagate=an.LogVerbosity=an.Status=void 0;var SI=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n}(SI||(an.Status=SI={})),wI=function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n}(wI||(an.LogVerbosity=wI={})),bI=function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n}(bI||(an.Propagate=bI={}));an.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;an.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var hy=A((fX,xB)=>{xB.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Be=A(Nt=>{"use strict";var fy,py,gy,my;Object.defineProperty(Nt,"__esModule",{value:!0});Nt.isTracerEnabled=Nt.trace=Nt.log=Nt.setLoggerVerbosity=Nt.setLogger=Nt.getLogger=void 0;var di=ve(),LB=_e("process"),FB=hy().version,BB={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},Ts=BB,Ro=di.LogVerbosity.ERROR,UB=(py=(fy=process.env.GRPC_NODE_VERBOSITY)!==null&&fy!==void 0?fy:process.env.GRPC_VERBOSITY)!==null&&py!==void 0?py:"";switch(UB.toUpperCase()){case"DEBUG":Ro=di.LogVerbosity.DEBUG;break;case"INFO":Ro=di.LogVerbosity.INFO;break;case"ERROR":Ro=di.LogVerbosity.ERROR;break;case"NONE":Ro=di.LogVerbosity.NONE;break;default:}var VB=()=>Ts;Nt.getLogger=VB;var qB=n=>{Ts=n};Nt.setLogger=qB;var zB=n=>{Ro=n};Nt.setLoggerVerbosity=zB;var jB=(n,...e)=>{let t;if(n>=Ro){switch(n){case di.LogVerbosity.DEBUG:t=Ts.debug;break;case di.LogVerbosity.INFO:t=Ts.info;break;case di.LogVerbosity.ERROR:t=Ts.error;break}t||(t=Ts.error),t&&t.bind(Ts)(...e)}};Nt.log=jB;var $B=(my=(gy=process.env.GRPC_NODE_TRACE)!==null&&gy!==void 0?gy:process.env.GRPC_TRACE)!==null&&my!==void 0?my:"",yy=new Set,CI=new Set;for(let n of $B.split(","))n.startsWith("-")?CI.add(n.substring(1)):yy.add(n);var GB=yy.has("all");function HB(n,e,t){II(e)&&(0,Nt.log)(n,new Date().toISOString()+" | v"+FB+" "+LB.pid+" | "+e+" | "+t)}Nt.trace=HB;function II(n){return!CI.has(n)&&(GB||yy.has(n))}Nt.isTracerEnabled=II});var Id=A(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.getErrorCode=Oo.getErrorMessage=void 0;function WB(n){return n instanceof Error?n.message:String(n)}Oo.getErrorMessage=WB;function KB(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}Oo.getErrorCode=KB});var Ft=A(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});Ad.Metadata=void 0;var QB=Be(),YB=ve(),JB=Id(),XB=/^[0-9a-z_.-]+$/,ZB=/^[ -~]*$/;function eU(n){return XB.test(n)}function tU(n){return ZB.test(n)}function AI(n){return n.endsWith("-bin")}function nU(n){return!n.startsWith("grpc-")}function Dd(n){return n.toLowerCase()}function DI(n,e){if(!eU(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(AI(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!tU(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var vy=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=Dd(e),DI(e,t),this.internalRepr.set(e,[t])}add(e,t){e=Dd(e),DI(e,t);let r=this.internalRepr.get(e);r===void 0?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=Dd(e),this.internalRepr.delete(e)}get(e){return e=Dd(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let i=r[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[r,i]of this.internalRepr){let s=i.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(r,s)}return e}merge(e){for(let[t,r]of e.internalRepr){let i=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(rU);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new n;for(let r of Object.keys(e)){if(r.charAt(0)===":")continue;let i=e[r];try{AI(r)?Array.isArray(i)?i.forEach(s=>{t.add(r,Buffer.from(s,"base64"))}):i!==void 0&&(nU(r)?i.split(",").forEach(s=>{t.add(r,Buffer.from(s.trim(),"base64"))}):t.add(r,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{t.add(r,s)}):i!==void 0&&t.add(r,i)}catch(s){let o=`Failed to add metadata entry ${r}: ${i}. ${(0,JB.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,QB.log)(YB.LogVerbosity.ERROR,o)}}return t}};Ad.Metadata=vy;var rU=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var wy=A(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});Rd.CallCredentials=void 0;var Sy=Ft();function iU(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var No=class n{static createFromMetadataGenerator(e){return new _y(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,r)=>{let i;iU(e)?i=e.getRequestHeaders(t.service_url):i=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,c)=>{if(a){o(a);return}if(!c){o(new Error("Headers not set by metadata plugin"));return}s(c)})}),i.then(s=>{let o=new Sy.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);r(null,o)},s=>{r(s)})})}static createEmpty(){return new Ty}};Rd.CallCredentials=No;var Ey=class n extends No{constructor(e){super(),this.creds=e}generateMetadata(e){return E(this,null,function*(){let t=new Sy.Metadata,r=yield Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of r)t.merge(i);return t})}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,r)=>t._equals(e.creds[r])):!1}},_y=class n extends No{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?t(s):r(i)})})}compose(e){return new Ey([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},Ty=class n extends No{generateMetadata(e){return Promise.resolve(new Sy.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var Cy=A(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.getDefaultRootsData=ko.CIPHER_SUITES=void 0;var sU=_e("fs");ko.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var RI=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,by=null;function oU(){return RI?(by===null&&(by=sU.readFileSync(RI)),by):null}ko.getDefaultRootsData=oU});var kd=A(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.ChannelCredentials=void 0;var aU=_e("tls"),cU=wy(),OI=Cy();function Iy(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var Po=class{constructor(e){this.callCredentials=e||cU.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var s;if(Iy(e,"Root certificate"),Iy(t,"Private key"),Iy(r,"Certificate chain"),t&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,aU.createSecureContext)({ca:(s=e??(0,OI.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:r??void 0,ciphers:OI.CIPHER_SUITES});return new Od(o,i??{})}static createFromSecureContext(e,t){return new Od(e,t??{})}static createInsecure(){return new Dy}};Nd.ChannelCredentials=Po;var Dy=class n extends Po{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},Od=class n extends Po{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new Ay(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},Ay=class n extends Po{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var fi=A(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.validateLoadBalancingConfig=_t.getFirstUsableConfig=_t.isLoadBalancerNameRegistered=_t.createLoadBalancer=_t.registerDefaultLoadBalancerType=_t.registerLoadBalancerType=_t.createChildChannelControlHelper=void 0;function uU(n,e){var t,r,i,s,o,a,c,u,l,d;return{createSubchannel:(r=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&r!==void 0?r:n.createSubchannel.bind(n),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(u=(c=e.addChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&u!==void 0?u:n.addChannelzChild.bind(n),removeChannelzChild:(d=(l=e.removeChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&d!==void 0?d:n.removeChannelzChild.bind(n)}}_t.createChildChannelControlHelper=uU;var hi={},Ry=null;function lU(n,e,t){hi[n]={LoadBalancer:e,LoadBalancingConfig:t}}_t.registerLoadBalancerType=lU;function dU(n){Ry=n}_t.registerDefaultLoadBalancerType=dU;function hU(n,e){let t=n.getLoadBalancerName();return t in hi?new hi[t].LoadBalancer(e):null}_t.createLoadBalancer=hU;function fU(n){return n in hi}_t.isLoadBalancerNameRegistered=fU;function pU(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in hi)return t;return e&&Ry?new hi[Ry].LoadBalancingConfig:null}_t.getFirstUsableConfig=pU;function gU(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in hi)return hi[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}_t.validateLoadBalancingConfig=gU});var Oy=A(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.extractAndSelectServiceConfig=pi.validateServiceConfig=pi.validateRetryThrottling=void 0;var mU=_e("os"),Pd=ve(),yU=fi(),Md=/^\d+(\.\d{1,9})?s$/,vU="node";function EU(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function _U(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Md.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Md.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Pd.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Pd.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function TU(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Md.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Pd.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Pd.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function SU(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let r of n.name)t.name.push(EU(r));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Md.test(n.timeout)){let r=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:r[0]|0,nanos:((e=r[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=_U(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=TU(n.hedgingPolicy));return t}function NI(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}pi.validateRetryThrottling=NI;function kI(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let r of n.loadBalancingConfig)e.loadBalancingConfig.push((0,yU.validateLoadBalancingConfig)(r));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let r of n.methodConfig)e.methodConfig.push(SU(r));"retryThrottling"in n&&(e.retryThrottling=NI(n.retryThrottling));let t=[];for(let r of e.methodConfig)for(let i of r.name){for(let s of t)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);t.push(i)}return e}pi.validateServiceConfig=kI;function wU(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:kI(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let r of n.clientLanguage)if(typeof r=="string")e.clientLanguage.push(r);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let r of n.clientHostname)if(typeof r=="string")e.clientHostname.push(r);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let r in n)if(!t.includes(r))throw new Error(`Invalid service config choice: unexpected field ${r}`);return e}function bU(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let r=wU(t);if(!(typeof r.percentage=="number"&&e>r.percentage)){if(Array.isArray(r.clientHostname)){let i=!1;for(let s of r.clientHostname)s===mU.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(r.clientLanguage)){let i=!1;for(let s of r.clientLanguage)s===vU&&(i=!0);if(!i)continue}return r.serviceConfig}}throw new Error("No matching service config found")}function CU(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let r=t.join("").substring(12),i=JSON.parse(r);return bU(i,e)}return null}pi.extractAndSelectServiceConfig=CU});var cn=A(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.ConnectivityState=void 0;var PI=function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n}(PI||(xd.ConnectivityState=PI={}))});var Kt=A(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.uriToString=gi.splitHostPort=gi.parseUri=void 0;var IU=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function DU(n){let e=IU.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}gi.parseUri=DU;var MI=/^\d+$/;function AU(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let r=n.substring(e+2);return MI.test(r)?{host:t,port:+r}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?MI.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}gi.splitHostPort=AU;function RU(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}gi.uriToString=RU});var nr=A(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.mapUriDefaultScheme=un.getDefaultAuthority=un.createResolver=un.registerDefaultScheme=un.registerResolver=void 0;var ky=Kt(),Mo={},Ny=null;function OU(n,e){Mo[n]=e}un.registerResolver=OU;function NU(n){Ny=n}un.registerDefaultScheme=NU;function kU(n,e,t){if(n.scheme!==void 0&&n.scheme in Mo)return new Mo[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,ky.uriToString)(n)}`)}un.createResolver=kU;function PU(n){if(n.scheme!==void 0&&n.scheme in Mo)return Mo[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,ky.uriToString)(n)}`)}un.getDefaultAuthority=PU;function MU(n){return n.scheme===void 0||!(n.scheme in Mo)?Ny!==null?{scheme:Ny,authority:void 0,path:(0,ky.uriToString)(n)}:null:n}un.mapUriDefaultScheme=MU});var yi=A(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.QueuePicker=mi.UnavailablePicker=mi.PickResultType=void 0;var xU=Ft(),LU=ve(),Ld=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n}(Ld||(mi.PickResultType=Ld={})),Py=class{constructor(e){this.status=Object.assign({code:LU.Status.UNAVAILABLE,details:"No connection established",metadata:new xU.Metadata},e)}pick(e){return{pickResultType:Ld.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};mi.UnavailablePicker=Py;var My=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:Ld.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};mi.QueuePicker=My});var Vc=A(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.BackoffTimeout=void 0;var FU=1e3,BU=1.6,UU=12e4,VU=.2;function qU(n,e){return Math.random()*(e-n)+n}var xy=class{constructor(e,t){this.callback=e,this.initialDelay=FU,this.multiplier=BU,this.maxDelay=UU,this.jitter=VU,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(r=(t=this.timerId).unref)===null||r===void 0||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+qU(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};Fd.BackoffTimeout=xy});var Ud=A(Bd=>{"use strict";Object.defineProperty(Bd,"__esModule",{value:!0});Bd.ChildLoadBalancerHandler=void 0;var zU=fi(),jU=cn(),$U="child_load_balancer_helper",Ly=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,r){return this.parent.channelControlHelper.createSubchannel(t,r)}updateState(t,r){var i;if(this.calledByPendingChild()){if(t===jU.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,r)}requestReresolution(){var t;let r=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===r&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,zU.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return $U}};Bd.ChildLoadBalancerHandler=Ly});var LI=A(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.ResolvingLoadBalancer=void 0;var GU=fi(),HU=Oy(),Bt=cn(),WU=nr(),xo=yi(),KU=Vc(),Fy=ve(),QU=Ft(),YU=Be(),JU=ve(),XU=Kt(),ZU=Ud(),e3="resolving_load_balancer";function xI(n){YU.trace(JU.LogVerbosity.DEBUG,e3,n)}var t3=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function n3(n,e,t,r){for(let i of t.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===n&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===n&&i.method===e)return!0}return!1}function r3(n,e,t,r){for(let i of t)if(n3(n,e,i,r))return i;return null}function i3(n){return function(t,r){var i,s;let o=t.split("/").filter(u=>u.length>0),a=(i=o[0])!==null&&i!==void 0?i:"",c=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let u of t3){let l=r3(a,c,n.methodConfig,u);if(l)return{methodConfig:l,pickInformation:{},status:Fy.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:Fy.Status.OK,dynamicFilterFactories:[]}}}var By=class{constructor(e,t,r,i,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=Bt.ConnectivityState.IDLE,this.latestChildPicker=new xo.QueuePicker(this),this.currentState=Bt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,HU.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Bt.ConnectivityState.IDLE,new xo.QueuePicker(this)),this.childLoadBalancer=new ZU.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(xI("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,c)=>{this.latestChildState=a,this.latestChildPicker=c,this.updateState(a,c)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,WU.createResolver)(e,{onSuccessfulResolution:(a,c,u,l,d)=>{var h;this.backoffTimeout.stop(),this.backoffTimeout.reset();let p=null;c===null?u===null?(this.previousServiceConfig=null,p=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(u):p=this.previousServiceConfig:(p=c,this.previousServiceConfig=c);let S=(h=p?.loadBalancingConfig)!==null&&h!==void 0?h:[],b=(0,GU.getFirstUsableConfig)(S,!0);if(b===null){this.handleResolutionFailure({code:Fy.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new QU.Metadata});return}this.childLoadBalancer.updateAddressList(a,b,d);let w=p??this.defaultServiceConfig;this.onSuccessfulResolution(w,l??i3(w))},onError:a=>{this.handleResolutionFailure(a)}},r);let o={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new KU.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Bt.ConnectivityState.IDLE&&this.updateState(Bt.ConnectivityState.CONNECTING,new xo.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){xI((0,XU.uriToString)(this.target)+" "+Bt.ConnectivityState[this.currentState]+" -> "+Bt.ConnectivityState[e]),e===Bt.ConnectivityState.IDLE&&(t=new xo.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===Bt.ConnectivityState.IDLE&&(this.updateState(Bt.ConnectivityState.TRANSIENT_FAILURE,new xo.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Bt.ConnectivityState.IDLE||this.currentState===Bt.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=Bt.ConnectivityState.IDLE,this.latestChildPicker=new xo.QueuePicker(this),this.currentState=Bt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Vd.ResolvingLoadBalancer=By});var FI=A(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.channelOptionsEqual=Lo.recognizedOptions=void 0;Lo.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function s3(n,e){let t=Object.keys(n).sort(),r=Object.keys(e).sort();if(t.length!==r.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==r[i]||n[t[i]]!==e[r[i]])return!1;return!0}Lo.channelOptionsEqual=s3});var ir=A(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.stringToSubchannelAddress=rr.subchannelAddressToString=rr.subchannelAddressEqual=rr.isTcpSubchannelAddress=void 0;var o3=_e("net");function qc(n){return"port"in n}rr.isTcpSubchannelAddress=qc;function a3(n,e){return!n&&!e?!0:!n||!e?!1:qc(n)?qc(e)&&n.host===e.host&&n.port===e.port:!qc(e)&&n.path===e.path}rr.subchannelAddressEqual=a3;function c3(n){return qc(n)?n.host+":"+n.port:n.path}rr.subchannelAddressToString=c3;var u3=443;function l3(n,e){return(0,o3.isIP)(n)?{host:n,port:e??u3}:{path:n}}rr.stringToSubchannelAddress=l3});var qd=A(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.addAdminServicesToServer=Fo.registerAdminService=void 0;var BI=[];function d3(n,e){BI.push({getServiceDefinition:n,getHandlers:e})}Fo.registerAdminService=d3;function h3(n){for(let{getServiceDefinition:e,getHandlers:t}of BI)n.addService(e(),t())}Fo.addAdminServicesToServer=h3});var UI=A(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.ClientDuplexStreamImpl=ln.ClientWritableStreamImpl=ln.ClientReadableStreamImpl=ln.ClientUnaryCallImpl=ln.callErrorFromStatus=void 0;var f3=_e("events"),jy=_e("stream"),zc=ve();function p3(n,e){let t=`${n.code} ${zc.Status[n.code]}: ${n.details}`,i=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:i})}ln.callErrorFromStatus=p3;var Uy=class extends f3.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(zc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};ln.ClientUnaryCallImpl=Uy;var Vy=class extends jy.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(zc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};ln.ClientReadableStreamImpl=Vy;var qy=class extends jy.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(zc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};ln.ClientWritableStreamImpl=qy;var zy=class extends jy.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(zc.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};ln.ClientDuplexStreamImpl=zy});var VI=A(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.InterceptingListenerImpl=Bo.isInterceptingListener=void 0;function g3(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}Bo.isInterceptingListener=g3;var $y=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};Bo.InterceptingListenerImpl=$y});var Jy=A(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.getInterceptingCall=dn.InterceptingCall=dn.RequesterBuilder=dn.ListenerBuilder=dn.InterceptorConfigurationError=void 0;var m3=Ft(),qI=VI(),zI=ve(),jI=Id(),$c=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};dn.InterceptorConfigurationError=$c;var Hy=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};dn.ListenerBuilder=Hy;var Wy=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};dn.RequesterBuilder=Wy;var Gy={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},jc={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},Ky=class{constructor(e,t){var r,i,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(r=t.start)!==null&&r!==void 0?r:jc.start,sendMessage:(i=t.sendMessage)!==null&&i!==void 0?i:jc.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:jc.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:jc.cancel}:this.requester=jc}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,i,s,o,a,c;let u={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:l=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:l=>{},onReceiveStatus:(c=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&c!==void 0?c:l=>{}};this.processingMetadata=!0,this.requester.start(e,u,(l,d)=>{var h,p,S;this.processingMetadata=!1;let b;if((0,qI.isInterceptingListener)(d))b=d;else{let w={onReceiveMetadata:(h=d.onReceiveMetadata)!==null&&h!==void 0?h:Gy.onReceiveMetadata,onReceiveMessage:(p=d.onReceiveMessage)!==null&&p!==void 0?p:Gy.onReceiveMessage,onReceiveStatus:(S=d.onReceiveStatus)!==null&&S!==void 0?S:Gy.onReceiveStatus};b=new qI.InterceptingListenerImpl(w,u)}this.nextCall.start(l,b),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};dn.InterceptingCall=Ky;function y3(n,e,t){var r,i;let s=(r=t.deadline)!==null&&r!==void 0?r:1/0,o=t.host,a=(i=t.parent)!==null&&i!==void 0?i:null,c=t.propagate_flags,u=t.credentials,l=n.createCall(e,s,o,a,c);return u&&l.setCredentials(u),l}var zd=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(i){this.call.cancelWithStatus(zI.Status.INTERNAL,`Request message serialization failure: ${(0,jI.getErrorMessage)(i)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,i)},onReceiveMessage:i=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(i)}catch(a){r={code:zI.Status.INTERNAL,details:`Response message parsing error: ${(0,jI.getErrorMessage)(a)}`,metadata:new m3.Metadata},this.call.cancelWithStatus(r.code,r.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:i=>{var s,o;r?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,r):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Qy=class extends zd{constructor(e,t){super(e,t)}start(e,t){var r,i;let s=!1,o={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:a=>{},onReceiveMessage:a=>{var c;s=!0,(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,a)},onReceiveStatus:a=>{var c,u;s||(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,null),(u=t?.onReceiveStatus)===null||u===void 0||u.call(t,a)}};super.start(e,o),this.call.startRead()}},Yy=class extends zd{};function v3(n,e,t){let r=y3(n,t.path,e);return t.responseStream?new Yy(r,t):new Qy(r,t)}function E3(n,e,t,r){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new $c("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new $c("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?i=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):i=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return i.reduceRight((a,c)=>u=>c(u,a),a=>v3(r,a,e))(s)}dn.getInterceptingCall=E3});var ev=A($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});$d.Client=void 0;var sr=UI(),_3=tv(),T3=cn(),vi=ve(),Uo=Ft(),jd=Jy(),Nn=Symbol(),Vo=Symbol(),qo=Symbol(),Nr=Symbol();function Xy(n){return typeof n=="function"}function zo(n){return n.stack.split(`
`).slice(1).join(`
`)}var Zy=class{constructor(e,t,r={}){var i,s;if(r=Object.assign({},r),this[Vo]=(i=r.interceptors)!==null&&i!==void 0?i:[],delete r.interceptors,this[qo]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[],delete r.interceptor_providers,this[Vo].length>0&&this[qo].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Nr]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[Nn]=r.channelOverride;else if(r.channelFactoryOverride){let o=r.channelFactoryOverride;delete r.channelFactoryOverride,this[Nn]=o(e,t,r)}else this[Nn]=new _3.ChannelImplementation(e,t,r)}close(){this[Nn].close()}getChannel(){return this[Nn]}waitForReady(e,t){let r=i=>{if(i){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Nn].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===T3.ConnectivityState.READY)t();else try{this[Nn].watchConnectivityState(s,e,r)}catch{t(new Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(Xy(e))return{metadata:new Uo.Metadata,options:{},callback:e};if(Xy(t))return e instanceof Uo.Metadata?{metadata:e,options:{},callback:t}:{metadata:new Uo.Metadata,options:e,callback:t};if(!(e instanceof Uo.Metadata&&t instanceof Object&&Xy(r)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,i,s,o,a){var c,u;let l=this.checkOptionalUnaryResponseArguments(s,o,a),d={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},h={argument:i,metadata:l.metadata,call:new sr.ClientUnaryCallImpl,channel:this[Nn],methodDefinition:d,callOptions:l.options,callback:l.callback};this[Nr]&&(h=this[Nr](h));let p=h.call,S={clientInterceptors:this[Vo],clientInterceptorProviders:this[qo],callInterceptors:(c=h.callOptions.interceptors)!==null&&c!==void 0?c:[],callInterceptorProviders:(u=h.callOptions.interceptor_providers)!==null&&u!==void 0?u:[]},b=(0,jd.getInterceptingCall)(S,h.methodDefinition,h.callOptions,h.channel);p.call=b;let w=null,D=!1,x=new Error;return b.start(h.metadata,{onReceiveMetadata:k=>{p.emit("metadata",k)},onReceiveMessage(k){w!==null&&b.cancelWithStatus(vi.Status.INTERNAL,"Too many responses received"),w=k},onReceiveStatus(k){if(!D){if(D=!0,k.code===vi.Status.OK)if(w===null){let I=zo(x);h.callback((0,sr.callErrorFromStatus)({code:vi.Status.INTERNAL,details:"No message received",metadata:k.metadata},I))}else h.callback(null,w);else{let I=zo(x);h.callback((0,sr.callErrorFromStatus)(k,I))}x=null,p.emit("status",k)}}}),b.sendMessage(i),b.halfClose(),p}makeClientStreamRequest(e,t,r,i,s,o){var a,c;let u=this.checkOptionalUnaryResponseArguments(i,s,o),l={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},d={metadata:u.metadata,call:new sr.ClientWritableStreamImpl(t),channel:this[Nn],methodDefinition:l,callOptions:u.options,callback:u.callback};this[Nr]&&(d=this[Nr](d));let h=d.call,p={clientInterceptors:this[Vo],clientInterceptorProviders:this[qo],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=d.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},S=(0,jd.getInterceptingCall)(p,d.methodDefinition,d.callOptions,d.channel);h.call=S;let b=null,w=!1,D=new Error;return S.start(d.metadata,{onReceiveMetadata:x=>{h.emit("metadata",x)},onReceiveMessage(x){b!==null&&S.cancelWithStatus(vi.Status.INTERNAL,"Too many responses received"),b=x},onReceiveStatus(x){if(!w){if(w=!0,x.code===vi.Status.OK)if(b===null){let k=zo(D);d.callback((0,sr.callErrorFromStatus)({code:vi.Status.INTERNAL,details:"No message received",metadata:x.metadata},k))}else d.callback(null,b);else{let k=zo(D);d.callback((0,sr.callErrorFromStatus)(x,k))}D=null,h.emit("status",x)}}}),h}checkMetadataAndOptions(e,t){let r,i;return e instanceof Uo.Metadata?(r=e,t?i=t:i={}):(e?i=e:i={},r=new Uo.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,t,r,i,s,o){var a,c;let u=this.checkMetadataAndOptions(s,o),l={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},d={argument:i,metadata:u.metadata,call:new sr.ClientReadableStreamImpl(r),channel:this[Nn],methodDefinition:l,callOptions:u.options};this[Nr]&&(d=this[Nr](d));let h=d.call,p={clientInterceptors:this[Vo],clientInterceptorProviders:this[qo],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=d.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},S=(0,jd.getInterceptingCall)(p,d.methodDefinition,d.callOptions,d.channel);h.call=S;let b=!1,w=new Error;return S.start(d.metadata,{onReceiveMetadata(D){h.emit("metadata",D)},onReceiveMessage(D){h.push(D)},onReceiveStatus(D){if(!b){if(b=!0,h.push(null),D.code!==vi.Status.OK){let x=zo(w);h.emit("error",(0,sr.callErrorFromStatus)(D,x))}w=null,h.emit("status",D)}}}),S.sendMessage(i),S.halfClose(),h}makeBidiStreamRequest(e,t,r,i,s){var o,a;let c=this.checkMetadataAndOptions(i,s),u={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},l={metadata:c.metadata,call:new sr.ClientDuplexStreamImpl(t,r),channel:this[Nn],methodDefinition:u,callOptions:c.options};this[Nr]&&(l=this[Nr](l));let d=l.call,h={clientInterceptors:this[Vo],clientInterceptorProviders:this[qo],callInterceptors:(o=l.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=l.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},p=(0,jd.getInterceptingCall)(h,l.methodDefinition,l.callOptions,l.channel);d.call=p;let S=!1,b=new Error;return p.start(l.metadata,{onReceiveMetadata(w){d.emit("metadata",w)},onReceiveMessage(w){d.push(w)},onReceiveStatus(w){if(!S){if(S=!0,d.push(null),w.code!==vi.Status.OK){let D=zo(b);d.emit("error",(0,sr.callErrorFromStatus)(w,D))}b=null,d.emit("status",w)}}}),d}};$d.Client=Zy});var rv=A(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.loadPackageDefinition=jo.makeClientConstructor=void 0;var Gc=ev(),S3={unary:Gc.Client.prototype.makeUnaryRequest,server_stream:Gc.Client.prototype.makeServerStreamRequest,client_stream:Gc.Client.prototype.makeClientStreamRequest,bidi:Gc.Client.prototype.makeBidiStreamRequest};function nv(n){return["__proto__","prototype","constructor"].includes(n)}function $I(n,e,t){t||(t={});class r extends Gc.Client{}return Object.keys(n).forEach(i=>{if(nv(i))return;let s=n[i],o;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,c=s.responseDeserialize,u=w3(S3[o],s.path,a,c);r.prototype[i]=u,Object.assign(r.prototype[i],s),s.originalName&&!nv(s.originalName)&&(r.prototype[s.originalName]=r.prototype[i])}),r.service=n,r.serviceName=e,r}jo.makeClientConstructor=$I;function w3(n,e,t,r){return function(...i){return n.call(this,e,t,r,...i)}}function b3(n){return"format"in n}function C3(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],i=t.split(".");if(i.some(a=>nv(a)))continue;let s=i[i.length-1],o=e;for(let a of i.slice(0,-1))o[a]||(o[a]={}),o=o[a];b3(r)?o[s]=r:o[s]=$I(r,s,{})}return e}jo.loadPackageDefinition=C3});var gD=A((UX,pD)=>{"use strict";var I3=1/0,D3="[object Symbol]",A3=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,R3=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hd="\\ud800-\\udfff",XI="\\u0300-\\u036f\\ufe20-\\ufe23",ZI="\\u20d0-\\u20f0",eD="\\u2700-\\u27bf",tD="a-z\\xdf-\\xf6\\xf8-\\xff",O3="\\xac\\xb1\\xd7\\xf7",N3="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",k3="\\u2000-\\u206f",P3=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nD="A-Z\\xc0-\\xd6\\xd8-\\xde",rD="\\ufe0e\\ufe0f",iD=O3+N3+k3+P3,sv="['\u2019]",M3="["+Hd+"]",GI="["+iD+"]",Gd="["+XI+ZI+"]",sD="\\d+",x3="["+eD+"]",oD="["+tD+"]",aD="[^"+Hd+iD+sD+eD+tD+nD+"]",iv="\\ud83c[\\udffb-\\udfff]",L3="(?:"+Gd+"|"+iv+")",cD="[^"+Hd+"]",ov="(?:\\ud83c[\\udde6-\\uddff]){2}",av="[\\ud800-\\udbff][\\udc00-\\udfff]",$o="["+nD+"]",uD="\\u200d",HI="(?:"+oD+"|"+aD+")",F3="(?:"+$o+"|"+aD+")",WI="(?:"+sv+"(?:d|ll|m|re|s|t|ve))?",KI="(?:"+sv+"(?:D|LL|M|RE|S|T|VE))?",lD=L3+"?",dD="["+rD+"]?",B3="(?:"+uD+"(?:"+[cD,ov,av].join("|")+")"+dD+lD+")*",hD=dD+lD+B3,U3="(?:"+[x3,ov,av].join("|")+")"+hD,V3="(?:"+[cD+Gd+"?",Gd,ov,av,M3].join("|")+")",q3=RegExp(sv,"g"),z3=RegExp(Gd,"g"),j3=RegExp(iv+"(?="+iv+")|"+V3+hD,"g"),$3=RegExp([$o+"?"+oD+"+"+WI+"(?="+[GI,$o,"$"].join("|")+")",F3+"+"+KI+"(?="+[GI,$o+HI,"$"].join("|")+")",$o+"?"+HI+"+"+WI,$o+"+"+KI,sD,U3].join("|"),"g"),G3=RegExp("["+uD+Hd+XI+ZI+rD+"]"),H3=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,W3={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},K3=typeof global=="object"&&global&&global.Object===Object&&global,Q3=typeof self=="object"&&self&&self.Object===Object&&self,Y3=K3||Q3||Function("return this")();function J3(n,e,t,r){var i=-1,s=n?n.length:0;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function X3(n){return n.split("")}function Z3(n){return n.match(A3)||[]}function eV(n){return function(e){return n?.[e]}}var tV=eV(W3);function fD(n){return G3.test(n)}function nV(n){return H3.test(n)}function rV(n){return fD(n)?iV(n):X3(n)}function iV(n){return n.match(j3)||[]}function sV(n){return n.match($3)||[]}var oV=Object.prototype,aV=oV.toString,QI=Y3.Symbol,YI=QI?QI.prototype:void 0,JI=YI?YI.toString:void 0;function cV(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function uV(n){if(typeof n=="string")return n;if(pV(n))return JI?JI.call(n):"";var e=n+"";return e=="0"&&1/n==-I3?"-0":e}function lV(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:cV(n,e,t)}function dV(n){return function(e){e=Wd(e);var t=fD(e)?rV(e):void 0,r=t?t[0]:e.charAt(0),i=t?lV(t,1).join(""):e.slice(1);return r[n]()+i}}function hV(n){return function(e){return J3(EV(yV(e).replace(q3,"")),n,"")}}function fV(n){return!!n&&typeof n=="object"}function pV(n){return typeof n=="symbol"||fV(n)&&aV.call(n)==D3}function Wd(n){return n==null?"":uV(n)}var gV=hV(function(n,e,t){return e=e.toLowerCase(),n+(t?mV(e):e)});function mV(n){return vV(Wd(n).toLowerCase())}function yV(n){return n=Wd(n),n&&n.replace(R3,tV).replace(z3,"")}var vV=dV("toUpperCase");function EV(n,e,t){return n=Wd(n),e=t?void 0:e,e===void 0?nV(n)?sV(n):Z3(n):n.match(e)||[]}pD.exports=gV});var cv=A((VX,mD)=>{"use strict";mD.exports=_V;function _V(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(a,c){t[r]=function(l){if(s)if(s=!1,l)c(l);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{n.apply(e||null,t)}catch(u){s&&(s=!1,c(u))}})}});var _D=A(ED=>{"use strict";var Kd=ED;Kd.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var Go=new Array(64),vD=new Array(123);for(kn=0;kn<64;)vD[Go[kn]=kn<26?kn+65:kn<52?kn+71:kn<62?kn-4:kn-59|43]=kn++;var kn;Kd.encode=function(e,t,r){for(var i=null,s=[],o=0,a=0,c;t<r;){var u=e[t++];switch(a){case 0:s[o++]=Go[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Go[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Go[c|u>>6],s[o++]=Go[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Go[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var yD="invalid encoding";Kd.decode=function(e,t,r){for(var i=r,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=vD[c])===void 0)throw Error(yD);switch(s){case 0:o=c,s=1;break;case 1:t[r++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[r++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[r++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(yD);return r-i};Kd.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var SD=A((zX,TD)=>{"use strict";TD.exports=Qd;function Qd(){this._listeners={}}Qd.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};Qd.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};Qd.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var RD=A((jX,AD)=>{"use strict";AD.exports=wD(wD);function wD(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function s(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}n.readFloatLE=r?o:a,n.readFloatBE=r?a:o}():function(){function e(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;r((a<<31|c+127<<23|u)>>>0,s,o)}}n.writeFloatLE=e.bind(null,bD),n.writeFloatBE=e.bind(null,CD);function t(r,i,s){var o=r(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}n.readFloatLE=t.bind(null,ID),n.readFloatBE=t.bind(null,DD)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function s(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}n.readDoubleLE=r?o:a,n.readDoubleBE=r?a:o}():function(){function e(r,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)r(0,a,c+i),r(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))r(0,a,c+i),r(2146959360,a,c+s);else if(o>17976931348623157e292)r(0,a,c+i),r((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,r(l>>>0,a,c+i),r((u<<31|l/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),l=o*Math.pow(2,-d),r(l*4503599627370496>>>0,a,c+i),r((u<<31|d+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}n.writeDoubleLE=e.bind(null,bD,0,4),n.writeDoubleBE=e.bind(null,CD,4,0);function t(r,i,s,o,a){var c=r(o,a+i),u=r(o,a+s),l=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:l*(1/0):d===0?l*5e-324*h:l*Math.pow(2,d-1075)*(h+4503599627370496)}n.readDoubleLE=t.bind(null,ID,0,4),n.readDoubleBE=t.bind(null,DD,4,0)}(),n}function bD(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function CD(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function ID(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function DD(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var uv=A((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var ND=A(OD=>{"use strict";var lv=OD;lv.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};lv.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var s=null,o=[],a=0,c;t<r;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};lv.write=function(e,t,r){for(var i=r,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-i}});var PD=A((GX,kD)=>{"use strict";kD.exports=TV;function TV(n,e,t){var r=t||8192,i=r>>>1,s=null,o=r;return function(c){if(c<1||c>i)return n(c);o+c>r&&(s=n(r),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var xD=A((HX,MD)=>{"use strict";MD.exports=ot;var Hc=or();function ot(n,e){this.lo=n>>>0,this.hi=e>>>0}var Ss=ot.zero=new ot(0,0);Ss.toNumber=function(){return 0};Ss.zzEncode=Ss.zzDecode=function(){return this};Ss.length=function(){return 1};var SV=ot.zeroHash="\0\0\0\0\0\0\0\0";ot.fromNumber=function(e){if(e===0)return Ss;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new ot(r,i)};ot.from=function(e){if(typeof e=="number")return ot.fromNumber(e);if(Hc.isString(e))if(Hc.Long)e=Hc.Long.fromString(e);else return ot.fromNumber(parseInt(e,10));return e.low||e.high?new ot(e.low>>>0,e.high>>>0):Ss};ot.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};ot.prototype.toLong=function(e){return Hc.Long?new Hc.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ei=String.prototype.charCodeAt;ot.fromHash=function(e){return e===SV?Ss:new ot((Ei.call(e,0)|Ei.call(e,1)<<8|Ei.call(e,2)<<16|Ei.call(e,3)<<24)>>>0,(Ei.call(e,4)|Ei.call(e,5)<<8|Ei.call(e,6)<<16|Ei.call(e,7)<<24)>>>0)};ot.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ot.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ot.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ot.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var or=A(dv=>{"use strict";var H=dv;H.asPromise=cv();H.base64=_D();H.EventEmitter=SD();H.float=RD();H.inquire=uv();H.utf8=ND();H.pool=PD();H.LongBits=xD();H.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);H.global=H.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||dv;H.emptyArray=Object.freeze?Object.freeze([]):[];H.emptyObject=Object.freeze?Object.freeze({}):{};H.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};H.isString=function(e){return typeof e=="string"||e instanceof String};H.isObject=function(e){return e&&typeof e=="object"};H.isset=H.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};H.Buffer=function(){try{var n=H.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();H._Buffer_from=null;H._Buffer_allocUnsafe=null;H.newBuffer=function(e){return typeof e=="number"?H.Buffer?H._Buffer_allocUnsafe(e):new H.Array(e):H.Buffer?H._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};H.Array=typeof Uint8Array<"u"?Uint8Array:Array;H.Long=H.global.dcodeIO&&H.global.dcodeIO.Long||H.global.Long||H.inquire("long");H.key2Re=/^true|false|0|1$/;H.key32Re=/^-?(?:0|[1-9][0-9]*)$/;H.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;H.longToHash=function(e){return e?H.LongBits.from(e).toHash():H.LongBits.zeroHash};H.longFromHash=function(e,t){var r=H.LongBits.fromHash(e);return H.Long?H.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)};function LD(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}H.merge=LD;H.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function FD(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&LD(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}H.newError=FD;H.ProtocolError=FD("ProtocolError");H.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};H.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};H.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};H._configure=function(){var n=H.Buffer;if(!n){H._Buffer_from=H._Buffer_allocUnsafe=null;return}H._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},H._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var Jd=A((KX,qD)=>{"use strict";qD.exports=ge;var hn=or(),hv,Yd=hn.LongBits,BD=hn.base64,UD=hn.utf8;function Wc(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function pv(){}function wV(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function ge(){this.len=0,this.head=new Wc(pv,0,0),this.tail=this.head,this.states=null}var VD=function(){return hn.Buffer?function(){return(ge.create=function(){return new hv})()}:function(){return new ge}};ge.create=VD();ge.alloc=function(e){return new hn.Array(e)};hn.Array!==Array&&(ge.alloc=hn.pool(ge.alloc,hn.Array.prototype.subarray));ge.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Wc(e,t,r),this.len+=t,this};function gv(n,e,t){e[t]=n&255}function bV(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function mv(n,e){this.len=n,this.next=void 0,this.val=e}mv.prototype=Object.create(Wc.prototype);mv.prototype.fn=bV;ge.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new mv((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ge.prototype.int32=function(e){return e<0?this._push(yv,10,Yd.fromNumber(e)):this.uint32(e)};ge.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function yv(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}ge.prototype.uint64=function(e){var t=Yd.from(e);return this._push(yv,t.length(),t)};ge.prototype.int64=ge.prototype.uint64;ge.prototype.sint64=function(e){var t=Yd.from(e).zzEncode();return this._push(yv,t.length(),t)};ge.prototype.bool=function(e){return this._push(gv,1,e?1:0)};function fv(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}ge.prototype.fixed32=function(e){return this._push(fv,4,e>>>0)};ge.prototype.sfixed32=ge.prototype.fixed32;ge.prototype.fixed64=function(e){var t=Yd.from(e);return this._push(fv,4,t.lo)._push(fv,4,t.hi)};ge.prototype.sfixed64=ge.prototype.fixed64;ge.prototype.float=function(e){return this._push(hn.float.writeFloatLE,4,e)};ge.prototype.double=function(e){return this._push(hn.float.writeDoubleLE,8,e)};var CV=hn.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};ge.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(gv,1,0);if(hn.isString(e)){var r=ge.alloc(t=BD.length(e));BD.decode(e,r,0),e=r}return this.uint32(t)._push(CV,t,e)};ge.prototype.string=function(e){var t=UD.length(e);return t?this.uint32(t)._push(UD.write,t,e):this._push(gv,1,0)};ge.prototype.fork=function(){return this.states=new wV(this),this.head=this.tail=new Wc(pv,0,0),this.len=0,this};ge.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Wc(pv,0,0),this.len=0),this};ge.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};ge.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};ge._configure=function(n){hv=n,ge.create=VD(),hv._configure()}});var $D=A((QX,jD)=>{"use strict";jD.exports=ar;var zD=Jd();(ar.prototype=Object.create(zD.prototype)).constructor=ar;var _i=or();function ar(){zD.call(this)}ar._configure=function(){ar.alloc=_i._Buffer_allocUnsafe,ar.writeBytesBuffer=_i.Buffer&&_i.Buffer.prototype instanceof Uint8Array&&_i.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};ar.prototype.bytes=function(e){_i.isString(e)&&(e=_i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(ar.writeBytesBuffer,t,e),this};function IV(n,e,t){n.length<40?_i.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}ar.prototype.string=function(e){var t=_i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(IV,t,e),this};ar._configure()});var Zd=A((YX,QD)=>{"use strict";QD.exports=Ge;var Pn=or(),Ev,WD=Pn.LongBits,DV=Pn.utf8;function Mn(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Ge(n){this.buf=n,this.pos=0,this.len=n.length}var GD=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ge(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ge(e);throw Error("illegal buffer")},KD=function(){return Pn.Buffer?function(t){return(Ge.create=function(i){return Pn.Buffer.isBuffer(i)?new Ev(i):GD(i)})(t)}:GD};Ge.create=KD();Ge.prototype._slice=Pn.Array.prototype.subarray||Pn.Array.prototype.slice;Ge.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Mn(this,10);return e}}();Ge.prototype.int32=function(){return this.uint32()|0};Ge.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function vv(){var n=new WD(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Mn(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw Mn(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Ge.prototype.bool=function(){return this.uint32()!==0};function Xd(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Ge.prototype.fixed32=function(){if(this.pos+4>this.len)throw Mn(this,4);return Xd(this.buf,this.pos+=4)};Ge.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Mn(this,4);return Xd(this.buf,this.pos+=4)|0};function HD(){if(this.pos+8>this.len)throw Mn(this,8);return new WD(Xd(this.buf,this.pos+=4),Xd(this.buf,this.pos+=4))}Ge.prototype.float=function(){if(this.pos+4>this.len)throw Mn(this,4);var e=Pn.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ge.prototype.double=function(){if(this.pos+8>this.len)throw Mn(this,4);var e=Pn.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ge.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw Mn(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=Pn.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)};Ge.prototype.string=function(){var e=this.bytes();return DV.read(e,0,e.length)};Ge.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Mn(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Mn(this);while(this.buf[this.pos++]&128);return this};Ge.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Ge._configure=function(n){Ev=n,Ge.create=KD(),Ev._configure();var e=Pn.Long?"toLong":"toNumber";Pn.merge(Ge.prototype,{int64:function(){return vv.call(this)[e](!1)},uint64:function(){return vv.call(this)[e](!0)},sint64:function(){return vv.call(this).zzDecode()[e](!1)},fixed64:function(){return HD.call(this)[e](!0)},sfixed64:function(){return HD.call(this)[e](!1)}})}});var ZD=A((JX,XD)=>{"use strict";XD.exports=ws;var JD=Zd();(ws.prototype=Object.create(JD.prototype)).constructor=ws;var YD=or();function ws(n){JD.call(this,n)}ws._configure=function(){YD.Buffer&&(ws.prototype._slice=YD.Buffer.prototype.slice)};ws.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ws._configure()});var tA=A((XX,eA)=>{"use strict";eA.exports=Kc;var _v=or();(Kc.prototype=Object.create(_v.EventEmitter.prototype)).constructor=Kc;function Kc(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");_v.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}Kc.prototype.rpcCall=function n(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return _v.asPromise(n,o,e,t,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof r))try{u=r[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Kc.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Tv=A(nA=>{"use strict";var AV=nA;AV.Service=tA()});var Sv=A((eZ,rA)=>{"use strict";rA.exports={}});var oA=A(sA=>{"use strict";var Ut=sA;Ut.build="minimal";Ut.Writer=Jd();Ut.BufferWriter=$D();Ut.Reader=Zd();Ut.BufferReader=ZD();Ut.util=or();Ut.rpc=Tv();Ut.roots=Sv();Ut.configure=iA;function iA(){Ut.util._configure(),Ut.Writer._configure(Ut.BufferWriter),Ut.Reader._configure(Ut.BufferReader)}iA()});var cA=A((nZ,aA)=>{"use strict";aA.exports=wv;function wv(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function r(s){if(typeof s!="string"){var o=i();if(wv.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),u=new Array(a.length),l=0;l<a.length;)c[l]=a[l],u[l]=s[a[l++]];return c[l]=o,Function.apply(null,c).apply(null,u)}return Function(o)()}for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h]=arguments[++h];if(h=0,s=s.replace(/%([%dfijs])/g,function(S,b){var w=d[h++];switch(b){case"d":case"f":return String(Number(w));case"i":return String(Math.floor(w));case"j":return JSON.stringify(w);case"s":return String(w)}return"%"}),h!==d.length)throw Error("parameter count mismatch");return t.push(s),r}function i(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=i,r}wv.verbose=!1});var lA=A((rZ,uA)=>{"use strict";uA.exports=Qc;var RV=cv(),OV=uv(),bv=OV("fs");function Qc(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&bv&&bv.readFile?bv.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?Qc.xhr(n,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):Qc.xhr(n,e,t):RV(Qc,this,n,e)}Qc.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(t.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var fA=A(hA=>{"use strict";var Iv=hA,dA=Iv.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},Cv=Iv.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=dA(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};Iv.resolve=function(e,t,r){return r||(t=Cv(t)),dA(t)?t:(r||(e=Cv(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?Cv(e+"/"+t):t)}});var Wo=A((sZ,mA)=>{"use strict";mA.exports=fe;var eh=Si();((fe.prototype=Object.create(eh.prototype)).constructor=fe).className="Namespace";var Dv=Ti(),th=at(),NV=Is(),bs,Ho,Cs;fe.fromJSON=function(e,t){return new fe(e,t.options).addJSON(t.nested)};function pA(n,e){if(n&&n.length){for(var t={},r=0;r<n.length;++r)t[n[r].name]=n[r].toJSON(e);return t}}fe.arrayToJSON=pA;fe.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};fe.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function fe(n,e){eh.call(this,n,e),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function gA(n){n._nestedArray=null,n._lookupCache={};for(var e=n;e=e.parent;)e._lookupCache={};return n}Object.defineProperty(fe.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=th.toArray(this.nested))}});fe.prototype.toJSON=function(e){return th.toObject(["options",this.options,"nested",pA(this.nestedArray,e)])};fe.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],t.add((s.fields!==void 0?bs.fromJSON:s.values!==void 0?Cs.fromJSON:s.methods!==void 0?Ho.fromJSON:s.id!==void 0?Dv.fromJSON:fe.fromJSON)(r[i],s));return this};fe.prototype.get=function(e){return this.nested&&this.nested[e]||null};fe.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Cs)return this.nested[e].values;throw Error("no such enum: "+e)};fe.prototype.add=function(e){if(!(e instanceof Dv&&e.extend!==void 0||e instanceof bs||e instanceof NV||e instanceof Cs||e instanceof Ho||e instanceof fe))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof fe&&e instanceof fe&&!(t instanceof bs||t instanceof Ho)){for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}this.nested[e.name]=e,this instanceof bs||this instanceof Ho||this instanceof Cs||this instanceof Dv||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var s=this;s=s.parent;)s._needsRecursiveFeatureResolution=!0,s._needsRecursiveResolve=!0;return e.onAdd(this),gA(this)};fe.prototype.remove=function(e){if(!(e instanceof eh))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),gA(this)};fe.prototype.define=function(e,t){if(th.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof fe))throw Error("path conflicts with non-namespace objects")}else r.add(r=new fe(i))}return t&&r.addJSON(t),r};fe.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof fe?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this};fe.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,eh.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};fe.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),th.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;var i=e.join(".");if(e[0]==="")return this.root.lookup(e.slice(1),t);var s=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+i];if(s&&(!t||t.indexOf(s.constructor)>-1)||(s=this._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1)))return s;if(r)return null;for(var o=this;o.parent;){if(s=o.parent._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1))return s;o=o.parent}return null};fe.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var r=this.get(e[0]),i=null;if(r)e.length===1?i=r:r instanceof fe&&(e=e.slice(1),i=r._lookupImpl(e,e.join(".")));else for(var s=0;s<this.nestedArray.length;++s)this._nestedArray[s]instanceof fe&&(r=this._nestedArray[s]._lookupImpl(e,t))&&(i=r);return this._lookupCache[t]=i,i};fe.prototype.lookupType=function(e){var t=this.lookup(e,[bs]);if(!t)throw Error("no such type: "+e);return t};fe.prototype.lookupEnum=function(e){var t=this.lookup(e,[Cs]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};fe.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[bs,Cs]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};fe.prototype.lookupService=function(e){var t=this.lookup(e,[Ho]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};fe._configure=function(n,e,t){bs=n,Ho=e,Cs=t}});var nh=A((oZ,yA)=>{"use strict";yA.exports=kr;var Av=Ti();((kr.prototype=Object.create(Av.prototype)).constructor=kr).className="MapField";var kV=Ds(),Yc=at();function kr(n,e,t,r,i,s){if(Av.call(this,n,e,r,void 0,void 0,i,s),!Yc.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}kr.fromJSON=function(e,t){return new kr(e,t.id,t.keyType,t.type,t.options,t.comment)};kr.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Yc.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};kr.prototype.resolve=function(){if(this.resolved)return this;if(kV.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Av.prototype.resolve.call(this)};kr.d=function(e,t,r){return typeof r=="function"?r=Yc.decorateType(r).name:r&&typeof r=="object"&&(r=Yc.decorateEnum(r).name),function(s,o){Yc.decorateType(s.constructor).add(new kr(o,e,t,r))}}});var rh=A((aZ,vA)=>{"use strict";vA.exports=As;var Rv=Si();((As.prototype=Object.create(Rv.prototype)).constructor=As).className="Method";var Ko=at();function As(n,e,t,r,i,s,o,a,c){if(Ko.isObject(i)?(o=i,i=s=void 0):Ko.isObject(s)&&(o=s,s=void 0),!(e===void 0||Ko.isString(e)))throw TypeError("type must be a string");if(!Ko.isString(t))throw TypeError("requestType must be a string");if(!Ko.isString(r))throw TypeError("responseType must be a string");Rv.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}As.fromJSON=function(e,t){return new As(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};As.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Ko.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};As.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Rv.prototype.resolve.call(this))}});var ih=A((cZ,_A)=>{"use strict";_A.exports=Qt;var Pr=Wo();((Qt.prototype=Object.create(Pr.prototype)).constructor=Qt).className="Service";var Ov=rh(),Jc=at(),PV=Tv();function Qt(n,e){Pr.call(this,n,e),this.methods={},this._methodsArray=null}Qt.fromJSON=function(e,t){var r=new Qt(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(Ov.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),t.edition&&(r._edition=t.edition),r.comment=t.comment,r._defaultEdition="proto3",r};Qt.prototype.toJSON=function(e){var t=Pr.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return Jc.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",Pr.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(Qt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Jc.toArray(this.methods))}});function EA(n){return n._methodsArray=null,n}Qt.prototype.get=function(e){return this.methods[e]||Pr.prototype.get.call(this,e)};Qt.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;Pr.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this};Qt.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,Pr.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};Qt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Ov?(this.methods[e.name]=e,e.parent=this,EA(this)):Pr.prototype.add.call(this,e)};Qt.prototype.remove=function(e){if(e instanceof Ov){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,EA(this)}return Pr.prototype.remove.call(this,e)};Qt.prototype.create=function(e,t,r){for(var i=new PV.Service(e,t,r),s=0,o;s<this.methodsArray.length;++s){var a=Jc.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Jc.codegen(["r","c"],Jc.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var sh=A((uZ,TA)=>{"use strict";TA.exports=cr;var MV=or();function cr(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}cr.create=function(e){return this.$type.create(e)};cr.encode=function(e,t){return this.$type.encode(e,t)};cr.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};cr.decode=function(e){return this.$type.decode(e)};cr.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};cr.verify=function(e){return this.$type.verify(e)};cr.fromObject=function(e){return this.$type.fromObject(e)};cr.toObject=function(e,t){return this.$type.toObject(e,t)};cr.prototype.toJSON=function(){return this.$type.toObject(this,MV.toJSONOptions)}});var Nv=A((lZ,wA)=>{"use strict";wA.exports=FV;var xV=xn(),Mr=Ds(),SA=at();function LV(n){return"missing required '"+n.name+"'"}function FV(n){for(var e=SA.codegen(["r","l","e"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),t=0;t<n.fieldsArray.length;++t){var r=n._fieldsArray[t].resolve(),i=r.resolvedType instanceof xV?"int32":r.type,s="m"+SA.safeProp(r.name);e("case %i: {",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Mr.defaults[r.keyType]!==void 0?e("k=%j",Mr.defaults[r.keyType]):e("k=null"),Mr.defaults[i]!==void 0?e("value=%j",Mr.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Mr.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Mr.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Mr.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),Mr.basic[i]===void 0?e(r.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):Mr.basic[i]===void 0?e(r.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",LV(o))}return e("return m")}});var Mv=A((dZ,bA)=>{"use strict";bA.exports=VV;var BV=xn(),kv=at();function fn(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function Pv(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof BV){n("switch(%s){",r)("default:")("return%j",fn(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)n("case %i:",e.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",fn(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",fn(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",fn(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",fn(e,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",fn(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",fn(e,"buffer"));break}return n}function UV(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",fn(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",fn(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",fn(e,"boolean key"));break}return n}function VV(n){var e=kv.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,r={};t.length&&e("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),o="m"+kv.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",fn(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),UV(e,s,"k[i]"),Pv(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",fn(s,"array"))("for(var i=0;i<%s.length;++i){",o),Pv(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=kv.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",a)}Pv(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var Fv=A(IA=>{"use strict";var CA=IA,Xc=xn(),ur=at();function xv(n,e,t,r){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof Xc){n("switch(d%s){",r);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!i&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),e.repeated||n("break"),i=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",r,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var c=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}CA.fromObject=function(e){var t=e.fieldsArray,r=ur.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),o=ur.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),xv(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),xv(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Xc||r("if(d%s!=null){",o),xv(r,s,i,o),s.resolvedType instanceof Xc||r("}"))}return r("return m")};function Lv(n,e,t,r){if(e.resolvedType)e.resolvedType instanceof Xc?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,t,r,r,t,r,r):n("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var i=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}CA.toObject=function(e){var t=e.fieldsArray.slice().sort(ur.compareFieldsById);if(!t.length)return ur.codegen()("return {}");for(var r=ur.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?i:t[a].map?s:o).push(t[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",ur.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",ur.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],u=ur.safeProp(c.name);if(c.resolvedType instanceof Xc)r("d%s=o.enums===String?%j:%j",u,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var l="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",u,l)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else r("d%s=%j",u,c.typeDefault)}r("}")}var d=!1;for(a=0;a<t.length;++a){var c=t[a],h=e._fieldsArray.indexOf(c),u=ur.safeProp(c.name);c.map?(d||(d=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){"),Lv(r,c,h,u+"[ks2[j]]")("}")):c.repeated?(r("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u),Lv(r,c,h,u+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",u,c.name),Lv(r,c,h,u),c.partOf&&r("if(o.oneofs)")("d%s=%j",ur.safeProp(c.partOf.name),c.name)),r("}")}return r("return d")}});var Bv=A(DA=>{"use strict";var qV=DA,zV=sh();qV[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",r="",i="";if(e&&e.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof zV){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return r===""&&(r=t),i=r+a,o["@type"]=i,o}return this.toObject(n,e)}}});var ch=A((pZ,RA)=>{"use strict";RA.exports=be;var pn=Wo();((be.prototype=Object.create(pn.prototype)).constructor=be).className="Type";var jV=xn(),qv=Is(),oh=Ti(),$V=nh(),GV=ih(),Uv=sh(),Vv=Zd(),HV=Jd(),Tt=at(),WV=zv(),KV=Nv(),QV=Mv(),AA=Fv(),YV=Bv();function be(n,e){pn.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(be.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Tt.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Tt.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=be.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof Uv||((n.prototype=new Uv).constructor=n,Tt.merge(n.prototype,e)),n.$type=n.prototype.$type=this,Tt.merge(n,Uv,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:Tt.oneOfGetter(this._oneofsArray[t].oneof),set:Tt.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,r)}}});be.generateConstructor=function(e){for(var t=Tt.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?t("this%s={}",Tt.safeProp(i.name)):i.repeated&&t("this%s=[]",Tt.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function ah(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}be.fromJSON=function(e,t){var r=new be(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)r.add((typeof t.fields[i[s]].keyType<"u"?$V.fromJSON:oh.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)r.add(qv.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var o=t.nested[i[s]];r.add((o.id!==void 0?oh.fromJSON:o.fields!==void 0?be.fromJSON:o.values!==void 0?jV.fromJSON:o.methods!==void 0?GV.fromJSON:pn.fromJSON)(i[s],o))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};be.prototype.toJSON=function(e){var t=pn.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return Tt.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",pn.arrayToJSON(this.oneofsArray,e),"fields",pn.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};be.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;pn.prototype.resolveAll.call(this);var e=this.oneofsArray;for(r=0;r<e.length;)e[r++].resolve();for(var t=this.fieldsArray,r=0;r<t.length;)t[r++].resolve();return this};be.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,pn.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach(t=>{t._resolveFeatures(e)}),this.fieldsArray.forEach(t=>{t._resolveFeatures(e)}),this):this};be.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};be.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof oh&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),ah(this)}return e instanceof qv?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),ah(this)):pn.prototype.add.call(this,e)};be.prototype.remove=function(e){if(e instanceof oh&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),ah(this)}if(e instanceof qv){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),ah(this)}return pn.prototype.remove.call(this,e)};be.prototype.isReservedId=function(e){return pn.isReservedId(this.reserved,e)};be.prototype.isReservedName=function(e){return pn.isReservedName(this.reserved,e)};be.prototype.create=function(e){return new this.ctor(e)};be.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=WV(this)({Writer:HV,types:t,util:Tt}),this.decode=KV(this)({Reader:Vv,types:t,util:Tt}),this.verify=QV(this)({types:t,util:Tt}),this.fromObject=AA.fromObject(this)({types:t,util:Tt}),this.toObject=AA.toObject(this)({types:t,util:Tt});var i=YV[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};be.prototype.encode=function(e,t){return this.setup().encode(e,t)};be.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};be.prototype.decode=function(e,t){return this.setup().decode(e,t)};be.prototype.decodeDelimited=function(e){return e instanceof Vv||(e=Vv.create(e)),this.decode(e,e.uint32())};be.prototype.verify=function(e){return this.setup().verify(e)};be.prototype.fromObject=function(e){return this.setup().fromObject(e)};be.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};be.d=function(e){return function(r){Tt.decorateType(r,e)}}});var hh=A((gZ,kA)=>{"use strict";kA.exports=Yt;var dh=Wo();((Yt.prototype=Object.create(dh.prototype)).constructor=Yt).className="Root";var uh=Ti(),jv=xn(),JV=Is(),wi=at(),$v,Gv,Zc;function Yt(n){dh.call(this,"",n),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}Yt.fromJSON=function(e,t){return t||(t=new Yt),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()};Yt.prototype.resolvePath=wi.path.resolve;Yt.prototype.fetch=wi.fetch;function NA(){}Yt.prototype.load=function n(e,t,r){typeof t=="function"&&(r=t,t=void 0);var i=this;if(!r)return wi.asPromise(n,i,e,t);var s=r===NA;function o(p,S){if(r){if(s)throw p;S&&S.resolveAll();var b=r;r=null,b(p,S)}}function a(p){var S=p.lastIndexOf("google/protobuf/");if(S>-1){var b=p.substring(S);if(b in Zc)return b}return null}function c(p,S){try{if(wi.isString(S)&&S.charAt(0)==="{"&&(S=JSON.parse(S)),!wi.isString(S))i.setOptions(S.options).addJSON(S.nested);else{Gv.filename=p;var b=Gv(S,i,t),w,D=0;if(b.imports)for(;D<b.imports.length;++D)(w=a(b.imports[D])||i.resolvePath(p,b.imports[D]))&&u(w);if(b.weakImports)for(D=0;D<b.weakImports.length;++D)(w=a(b.weakImports[D])||i.resolvePath(p,b.weakImports[D]))&&u(w,!0)}}catch(x){o(x)}!s&&!l&&o(null,i)}function u(p,S){if(p=a(p)||p,!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in Zc){s?c(p,Zc[p]):(++l,setTimeout(function(){--l,c(p,Zc[p])}));return}if(s){var b;try{b=wi.fs.readFileSync(p).toString("utf8")}catch(w){S||o(w);return}c(p,b)}else++l,i.fetch(p,function(w,D){if(--l,!!r){if(w){S?l||o(null,i):o(w);return}c(p,D)}})}}var l=0;wi.isString(e)&&(e=[e]);for(var d=0,h;d<e.length;++d)(h=i.resolvePath("",e[d]))&&u(h);return s?(i.resolveAll(),i):(l||o(null,i),i)};Yt.prototype.loadSync=function(e,t){if(!wi.isNode)throw Error("not supported");return this.load(e,t,NA)};Yt.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return dh.prototype.resolveAll.call(this)};var lh=/^[A-Z]/;function OA(n,e){var t=e.parent.lookup(e.extend);if(t){var r=new uh(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(r.name)||(r.declaringField=e,e.extensionField=r,t.add(r)),!0}return!1}Yt.prototype._handleAdd=function(e){if(e instanceof uh)e.extend!==void 0&&!e.extensionField&&(OA(this,e)||this.deferred.push(e));else if(e instanceof jv)lh.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof JV)){if(e instanceof $v)for(var t=0;t<this.deferred.length;)OA(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);lh.test(e.name)&&(e.parent[e.name]=e)}(e instanceof $v||e instanceof jv||e instanceof uh)&&(this._fullyQualifiedObjects[e.fullName]=e)};Yt.prototype._handleRemove=function(e){if(e instanceof uh){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof jv)lh.test(e.name)&&delete e.parent[e.name];else if(e instanceof dh){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);lh.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]};Yt._configure=function(n,e,t){$v=n,Gv=e,Zc=t}});var at=A((mZ,MA)=>{"use strict";var He=MA.exports=or(),PA=Sv(),Hv,Wv;He.codegen=cA();He.fetch=lA();He.path=fA();He.fs=He.inquire("fs");He.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]};He.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(t[i]=s)}return t};var XV=/\\/g,ZV=/"/g;He.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};He.safeProp=function(e){return!/^[$\w_]+$/.test(e)||He.isReserved(e)?'["'+e.replace(XV,"\\\\").replace(ZV,'\\"')+'"]':"."+e};He.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var e4=/_([a-z])/g;He.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(e4,function(t,r){return r.toUpperCase()})};He.compareFieldsById=function(e,t){return e.id-t.id};He.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(He.decorateRoot.remove(e.$type),e.$type.name=t,He.decorateRoot.add(e.$type)),e.$type;Hv||(Hv=ch());var r=new Hv(t||e.name);return He.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var t4=0;He.decorateEnum=function(e){if(e.$type)return e.$type;Wv||(Wv=xn());var t=new Wv("Enum"+t4++,e);return He.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};He.setProperty=function(e,t,r,i){function s(o,a,c){var u=a.shift();if(u==="__proto__"||u==="prototype")return o;if(a.length>0)o[u]=s(o[u]||{},a,c);else{var l=o[u];if(l&&i)return o;l&&(c=[].concat(l).concat(c)),o[u]=c}return o}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),s(e,t,r)};Object.defineProperty(He,"decorateRoot",{get:function(){return PA.decorated||(PA.decorated=new(hh()))}})});var Ds=A(xA=>{"use strict";var eu=xA,n4=at(),r4=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function tu(n,e){var t=0,r={};for(e|=0;t<n.length;)r[r4[t+e]]=n[t++];return r}eu.basic=tu([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);eu.defaults=tu([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",n4.emptyArray,null]);eu.long=tu([0,0,0,1,1],7);eu.mapKey=tu([0,0,0,5,5,0,0,0,1,1,0,2],2);eu.packed=tu([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Ti=A((vZ,FA)=>{"use strict";FA.exports=ct;var ru=Si();((ct.prototype=Object.create(ru.prototype)).constructor=ct).className="Field";var LA=xn(),Kv=Ds(),Ye=at(),nu,i4=/^required|optional|repeated$/;ct.fromJSON=function(e,t){var r=new ct(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};function ct(n,e,t,r,i,s,o){if(Ye.isObject(r)?(o=i,s=r,r=i=void 0):Ye.isObject(i)&&(o=s,s=i,i=void 0),ru.call(this,n,s),!Ye.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Ye.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!i4.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!Ye.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Ye.Long?Kv.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=o}Object.defineProperty(ct.prototype,"required",{get:function(){return this._features.field_presence==="LEGACY_REQUIRED"}});Object.defineProperty(ct.prototype,"optional",{get:function(){return!this.required}});Object.defineProperty(ct.prototype,"delimited",{get:function(){return this.resolvedType instanceof nu&&this._features.message_encoding==="DELIMITED"}});Object.defineProperty(ct.prototype,"packed",{get:function(){return this._features.repeated_field_encoding==="PACKED"}});Object.defineProperty(ct.prototype,"hasPresence",{get:function(){return this.repeated||this.map?!1:this.partOf||this.declaringField||this.extensionField||this._features.field_presence!=="IMPLICIT"}});ct.prototype.setOption=function(e,t,r){return ru.prototype.setOption.call(this,e,t,r)};ct.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Ye.toObject(["edition",this._editionToJSON(),"rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};ct.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Kv.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof nu?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof LA&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof LA)&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Ye.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Ye.base64.test(this.typeDefault)?Ye.base64.decode(this.typeDefault,e=Ye.newBuffer(Ye.base64.length(this.typeDefault)),0):Ye.utf8.write(this.typeDefault,e=Ye.newBuffer(Ye.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Ye.emptyObject:this.repeated?this.defaultValue=Ye.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof nu&&(this.parent.ctor.prototype[this.name]=this.defaultValue),ru.prototype.resolve.call(this)};ct.prototype._inferLegacyProtoFeatures=function(e){if(e!=="proto2"&&e!=="proto3")return{};var t={};if(this.rule==="required"&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&Kv.defaults[this.type]===void 0){var r=this.parent.get(this.type.split(".").pop());r&&r instanceof nu&&r.group&&(t.message_encoding="DELIMITED")}return this.getOption("packed")===!0?t.repeated_field_encoding="PACKED":this.getOption("packed")===!1&&(t.repeated_field_encoding="EXPANDED"),t};ct.prototype._resolveFeatures=function(e){return ru.prototype._resolveFeatures.call(this,this._edition||e)};ct.d=function(e,t,r,i){return typeof t=="function"?t=Ye.decorateType(t).name:t&&typeof t=="object"&&(t=Ye.decorateEnum(t).name),function(o,a){Ye.decorateType(o.constructor).add(new ct(a,e,t,r,{default:i}))}};ct._configure=function(e){nu=e}});var Is=A((EZ,VA)=>{"use strict";VA.exports=Jt;var ph=Si();((Jt.prototype=Object.create(ph.prototype)).constructor=Jt).className="OneOf";var BA=Ti(),fh=at();function Jt(n,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),ph.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}Jt.fromJSON=function(e,t){return new Jt(e,t.oneof,t.options,t.comment)};Jt.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return fh.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function UA(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}Jt.prototype.add=function(e){if(!(e instanceof BA))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,UA(this),this};Jt.prototype.remove=function(e){if(!(e instanceof BA))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Jt.prototype.onAdd=function(e){ph.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}UA(this)};Jt.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);ph.prototype.onRemove.call(this,e)};Object.defineProperty(Jt.prototype,"isProto3Optional",{get:function(){if(this.fieldsArray==null||this.fieldsArray.length!==1)return!1;var n=this.fieldsArray[0];return n.options!=null&&n.options.proto3_optional===!0}});Jt.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){fh.decorateType(i.constructor).add(new Jt(s,e)),Object.defineProperty(i,s,{get:fh.oneOfGetter(e),set:fh.oneOfSetter(e)})}}});var Si=A((_Z,qA)=>{"use strict";qA.exports=pt;pt.className="ReflectionObject";var s4=Is(),iu=at(),gh,o4={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},a4={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},c4={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function pt(n,e){if(!iu.isString(n))throw TypeError("name must be a string");if(e&&!iu.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(pt.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});pt.prototype.toJSON=function(){throw Error()};pt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof gh&&t._handleAdd(this)};pt.prototype.onRemove=function(e){var t=e.root;t instanceof gh&&t._handleRemove(this),this.parent=null,this.resolved=!1};pt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof gh&&(this.resolved=!0),this)};pt.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)};pt.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw new Error("Unknown edition for "+this.fullName);var r=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if(e==="proto2")t=Object.assign({},a4);else if(e==="proto3")t=Object.assign({},c4);else if(e==="2023")t=Object.assign({},o4);else throw new Error("Unknown edition: "+e);this._features=Object.assign(t,r||{}),this._featuresResolved=!0;return}if(this.partOf instanceof s4){var i=Object.assign({},this.partOf._features);this._features=Object.assign(i,r||{})}else if(!this.declaringField)if(this.parent){var s=Object.assign({},this.parent._features);this._features=Object.assign(s,r||{})}else throw new Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}};pt.prototype._inferLegacyProtoFeatures=function(){return{}};pt.prototype.getOption=function(e){if(this.options)return this.options[e]};pt.prototype.setOption=function(e,t,r){return this.options||(this.options={}),/^features\./.test(e)?iu.setProperty(this.options,e,t,r):(!r||this.options[e]===void 0)&&(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this};pt.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];iu.setProperty(o,r,t)}else s={},s[e]=iu.setProperty({},r,t),i.push(s)}else{var a={};a[e]=t,i.push(a)}return this};pt.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this};pt.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};pt.prototype._editionToJSON=function(){if(!(!this._edition||this._edition==="proto3"))return this._edition};pt._configure=function(n){gh=n}});var xn=A((TZ,jA)=>{"use strict";jA.exports=Ln;var Qv=Si();((Ln.prototype=Object.create(Qv.prototype)).constructor=Ln).className="Enum";var zA=Wo(),mh=at();function Ln(n,e,t,r,i,s){if(Qv.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this._valuesFeatures={},this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Ln.prototype._resolveFeatures=function(e){return e=this._edition||e,Qv.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach(t=>{var r=Object.assign({},this._features);this._valuesFeatures[t]=Object.assign(r,this.valuesOptions&&this.valuesOptions[t]&&this.valuesOptions[t].features)}),this};Ln.fromJSON=function(e,t){var r=new Ln(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};Ln.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return mh.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Ln.prototype.add=function(e,t,r,i){if(!mh.isString(e))throw TypeError("name must be a string");if(!mh.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this};Ln.prototype.remove=function(e){if(!mh.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Ln.prototype.isReservedId=function(e){return zA.isReservedId(this.reserved,e)};Ln.prototype.isReservedName=function(e){return zA.isReservedName(this.reserved,e)}});var zv=A((SZ,GA)=>{"use strict";GA.exports=l4;var u4=xn(),Yv=Ds(),Jv=at();function $A(n,e,t,r){return e.delimited?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function l4(n){for(var e=Jv.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,i=n.fieldsArray.slice().sort(Jv.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof u4?"int32":s.type,c=Yv.basic[a];r="m"+Jv.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Yv.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&Yv.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),c===void 0?$A(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),c===void 0?$A(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,r))}return e("return w")}});var WA=A((wZ,HA)=>{"use strict";var pe=HA.exports=oA();pe.build="light";function d4(n,e,t){return typeof e=="function"?(t=e,e=new pe.Root):e||(e=new pe.Root),e.load(n,t)}pe.load=d4;function h4(n,e){return e||(e=new pe.Root),e.loadSync(n)}pe.loadSync=h4;pe.encoder=zv();pe.decoder=Nv();pe.verifier=Mv();pe.converter=Fv();pe.ReflectionObject=Si();pe.Namespace=Wo();pe.Root=hh();pe.Enum=xn();pe.Type=ch();pe.Field=Ti();pe.OneOf=Is();pe.MapField=nh();pe.Service=ih();pe.Method=rh();pe.Message=sh();pe.wrappers=Bv();pe.types=Ds();pe.util=at();pe.ReflectionObject._configure(pe.Root);pe.Namespace._configure(pe.Type,pe.Service,pe.Enum);pe.Root._configure(pe.Type);pe.Field._configure(pe.Type)});var Zv=A((bZ,YA)=>{"use strict";YA.exports=QA;var Xv=/[\s{}=;:[\],'"()<>]/g,f4=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,p4=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,g4=/^ *[*/]+ */,m4=/^\s*\*?\/*/,y4=/\n/g,v4=/\s/,E4=/\\(.?)/g,_4={0:"\0",r:"\r",n:`
`,t:"	"};function KA(n){return n.replace(E4,function(e,t){switch(t){case"\\":case"":return t;default:return _4[t]||""}})}QA.unescape=KA;function QA(n,e){n=n.toString();var t=0,r=n.length,i=1,s=0,o={},a=[],c=null;function u(I){return Error("illegal "+I+" (line "+i+")")}function l(){var I=c==="'"?p4:f4;I.lastIndex=t-1;var G=I.exec(n);if(!G)throw u("string");return t=I.lastIndex,w(c),c=null,KA(G[1])}function d(I){return n.charAt(I)}function h(I,G,V){var T={type:n.charAt(I++),lineEmpty:!1,leading:V},y;e?y=2:y=3;var v=I-y,_;do if(--v<0||(_=n.charAt(v))===`
`){T.lineEmpty=!0;break}while(_===" "||_==="	");for(var g=n.substring(I,G).split(y4),C=0;C<g.length;++C)g[C]=g[C].replace(e?m4:g4,"").trim();T.text=g.join(`
`).trim(),o[i]=T,s=i}function p(I){var G=S(I),V=n.substring(I,G),T=/^\s*\/\//.test(V);return T}function S(I){for(var G=I;G<r&&d(G)!==`
`;)G++;return G}function b(){if(a.length>0)return a.shift();if(c)return l();var I,G,V,T,y,v=t===0;do{if(t===r)return null;for(I=!1;v4.test(V=d(t));)if(V===`
`&&(v=!0,++i),++t===r)return null;if(d(t)==="/"){if(++t===r)throw u("comment");if(d(t)==="/")if(e){if(T=t,y=!1,p(t-1)){y=!0;do if(t=S(t),t===r||(t++,!v))break;while(p(t))}else t=Math.min(r,S(t)+1);y&&(h(T,t,v),v=!0),i++,I=!0}else{for(y=d(T=t+1)==="/";d(++t)!==`
`;)if(t===r)return null;++t,y&&(h(T,t-1,v),v=!0),++i,I=!0}else if((V=d(t))==="*"){T=t+1,y=e||d(T)==="*";do{if(V===`
`&&++i,++t===r)throw u("comment");G=V,V=d(t)}while(G!=="*"||V!=="/");++t,y&&(h(T,t-2,v),v=!0),I=!0}else return"/"}}while(I);var _=t;Xv.lastIndex=0;var g=Xv.test(d(_++));if(!g)for(;_<r&&!Xv.test(d(_));)++_;var C=n.substring(t,t=_);return(C==='"'||C==="'")&&(c=C),C}function w(I){a.push(I)}function D(){if(!a.length){var I=b();if(I===null)return null;w(I)}return a[0]}function x(I,G){var V=D(),T=V===I;if(T)return b(),!0;if(!G)throw u("token '"+V+"', '"+I+"' expected");return!1}function k(I){var G=null,V;return I===void 0?(V=o[i-1],delete o[i-1],V&&(e||V.type==="*"||V.lineEmpty)&&(G=V.leading?V.text:null)):(s<I&&D(),V=o[I],delete o[I],V&&!V.lineEmpty&&(e||V.type==="/")&&(G=V.leading?null:V.text)),G}return Object.defineProperty({next:b,peek:D,push:w,skip:x,cmnt:k},"line",{get:function(){return i}})}});var nR=A((CZ,tR)=>{"use strict";tR.exports=xr;xr.filename=null;xr.defaults={keepCase:!1};var T4=Zv(),JA=hh(),XA=ch(),ZA=Ti(),S4=nh(),eR=Is(),w4=xn(),b4=ih(),C4=rh(),I4=Si(),D4=Ds(),eE=at(),A4=/^[1-9][0-9]*$/,R4=/^-?[1-9][0-9]*$/,O4=/^0[x][0-9a-fA-F]+$/,N4=/^-?0[x][0-9a-fA-F]+$/,k4=/^0[0-7]+$/,P4=/^-?0[0-7]+$/,M4=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,lr=/^[a-zA-Z_][a-zA-Z_0-9]*$/,dr=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function xr(n,e,t){e instanceof JA||(t=e,e=new JA),t||(t=xr.defaults);var r=t.preferTrailingComment||!1,i=T4(n,t.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,c=i.skip,u=i.cmnt,l=!0,d,h,p,S="proto2",b=e,w=[],D={},x=t.keepCase?function(N){return N}:eE.camelCase;function k(){w.forEach(N=>{N._edition=S,Object.keys(D).forEach(R=>{N.getOption(R)===void 0&&N.setOption(R,D[R],!0)})})}function I(N,R,M){var j=xr.filename;return M||(xr.filename=null),Error("illegal "+(R||"token")+" '"+N+"' ("+(j?j+", ":"")+"line "+i.line+")")}function G(){var N=[],R;do{if((R=s())!=='"'&&R!=="'")throw I(R);N.push(s()),c(R),R=a()}while(R==='"'||R==="'");return N.join("")}function V(N){var R=s();switch(R){case"'":case'"':return o(R),G();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return y(R,!0)}catch{if(N&&dr.test(R))return R;throw I(R,"value")}}function T(N,R){var M,j;do if(R&&((M=a())==='"'||M==="'")){var q=G();if(N.push(q),S>=2023)throw I(q,"id")}else try{N.push([j=v(s()),c("to",!0)?v(s()):j])}catch(Oe){if(R&&dr.test(M)&&S>=2023)N.push(M);else throw Oe}while(c(",",!0));var ne={options:void 0};ne.setOption=function(Oe,mt){this.options===void 0&&(this.options={}),this.options[Oe]=mt},L(ne,function(mt){if(mt==="option")me(ne,mt),c(";");else throw I(mt)},function(){Tr(ne)})}function y(N,R){var M=1;switch(N.charAt(0)==="-"&&(M=-1,N=N.substring(1)),N){case"inf":case"INF":case"Inf":return M*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(A4.test(N))return M*parseInt(N,10);if(O4.test(N))return M*parseInt(N,16);if(k4.test(N))return M*parseInt(N,8);if(M4.test(N))return M*parseFloat(N);throw I(N,"number",R)}function v(N,R){switch(N){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!R&&N.charAt(0)==="-")throw I(N,"id");if(R4.test(N))return parseInt(N,10);if(N4.test(N))return parseInt(N,16);if(P4.test(N))return parseInt(N,8);throw I(N,"id")}function _(){if(d!==void 0)throw I("package");if(d=s(),!dr.test(d))throw I(d,"name");b=b.define(d),c(";")}function g(){var N=a(),R;switch(N){case"weak":R=p||(p=[]),s();break;case"public":s();default:R=h||(h=[]);break}N=G(),c(";"),R.push(N)}function C(){if(c("="),S=G(),S<2023)throw I(S,"syntax");c(";")}function f(){if(c("="),S=G(),!["2023"].includes(S))throw I(S,"edition");c(";")}function m(N,R){switch(R){case"option":return me(N,R),c(";"),!0;case"message":return ue(N,R),!0;case"enum":return Ct(N,R),!0;case"service":return R1(N,R),!0;case"extend":return N1(N,R),!0}return!1}function L(N,R,M){var j=i.line;if(N&&(typeof N.comment!="string"&&(N.comment=u()),N.filename=xr.filename),c("{",!0)){for(var q;(q=s())!=="}";)R(q);c(";",!0)}else M&&M(),c(";"),N&&(typeof N.comment!="string"||r)&&(N.comment=u(j)||N.comment)}function ue(N,R){if(!lr.test(R=s()))throw I(R,"type name");var M=new XA(R);L(M,function(q){if(!m(M,q))switch(q){case"map":qe(M,q);break;case"required":if(S!=="proto2")throw I(q);case"repeated":ae(M,q);break;case"optional":if(S==="proto3")ae(M,"proto3_optional");else{if(S!=="proto2")throw I(q);ae(M,"optional")}break;case"oneof":gt(M,q);break;case"extensions":T(M.extensions||(M.extensions=[]));break;case"reserved":T(M.reserved||(M.reserved=[]),!0);break;default:if(S==="proto2"||!dr.test(q))throw I(q);o(q),ae(M,"optional");break}}),N.add(M),N===b&&w.push(M)}function ae(N,R,M){var j=s();if(j==="group"){we(N,R);return}for(;j.endsWith(".")||a().startsWith(".");)j+=s();if(!dr.test(j))throw I(j,"type");var q=s();if(!lr.test(q))throw I(q,"name");q=x(q),c("=");var ne=new ZA(q,v(s()),j,R,M);if(L(ne,function(At){if(At==="option")me(ne,At),c(";");else throw I(At)},function(){Tr(ne)}),R==="proto3_optional"){var Oe=new eR("_"+q);ne.setOption("proto3_optional",!0),Oe.add(ne),N.add(Oe)}else N.add(ne);N===b&&w.push(ne)}function we(N,R){if(S>=2023)throw I("group");var M=s();if(!lr.test(M))throw I(M,"name");var j=eE.lcFirst(M);M===j&&(M=eE.ucFirst(M)),c("=");var q=v(s()),ne=new XA(M);ne.group=!0;var Oe=new ZA(j,q,M,R);Oe.filename=xr.filename,L(ne,function(At){switch(At){case"option":me(ne,At),c(";");break;case"required":case"repeated":ae(ne,At);break;case"optional":S==="proto3"?ae(ne,"proto3_optional"):ae(ne,"optional");break;case"message":ue(ne,At);break;case"enum":Ct(ne,At);break;case"reserved":T(ne.reserved||(ne.reserved=[]),!0);break;default:throw I(At)}}),N.add(ne).add(Oe)}function qe(N){c("<");var R=s();if(D4.mapKey[R]===void 0)throw I(R,"type");c(",");var M=s();if(!dr.test(M))throw I(M,"type");c(">");var j=s();if(!lr.test(j))throw I(j,"name");c("=");var q=new S4(x(j),v(s()),R,M);L(q,function(Oe){if(Oe==="option")me(q,Oe),c(";");else throw I(Oe)},function(){Tr(q)}),N.add(q)}function gt(N,R){if(!lr.test(R=s()))throw I(R,"name");var M=new eR(x(R));L(M,function(q){q==="option"?(me(M,q),c(";")):(o(q),ae(M,"optional"))}),N.add(M)}function Ct(N,R){if(!lr.test(R=s()))throw I(R,"name");var M=new w4(R);L(M,function(q){switch(q){case"option":me(M,q),c(";");break;case"reserved":T(M.reserved||(M.reserved=[]),!0),M.reserved===void 0&&(M.reserved=[]);break;default:rt(M,q)}}),N.add(M),N===b&&w.push(M)}function rt(N,R){if(!lr.test(R))throw I(R,"name");c("=");var M=v(s(),!0),j={options:void 0};j.getOption=function(q){return this.options[q]},j.setOption=function(q,ne){I4.prototype.setOption.call(j,q,ne)},j.setParsedOption=function(){},L(j,function(ne){if(ne==="option")me(j,ne),c(";");else throw I(ne)},function(){Tr(j)}),N.add(R,M,j.comment,j.parsedOptions||j.options)}function me(N,R){var M,j,q=!0;for(R==="option"&&(R=s());R!=="=";){if(R==="("){var ne=s();c(")"),R="("+ne+")"}if(q){if(q=!1,R.includes(".")&&!R.includes("(")){var Oe=R.split(".");M=Oe[0]+".",R=Oe[1];continue}M=R}else j=j?j+=R:R;R=s()}var mt=j?M.concat(j):M,At=It(N,mt);j=j&&j[0]==="."?j.slice(1):j,M=M&&M[M.length-1]==="."?M.slice(0,-1):M,Dt(N,M,At,j)}function It(N,R){if(c("{",!0)){for(var M={};!c("}",!0);){if(!lr.test(ft=s()))throw I(ft,"name");if(ft===null)throw I(ft,"end of input");var j,q=ft;if(c(":",!0),a()==="{")j=It(N,R+"."+ft);else if(a()==="["){j=[];var ne;if(c("[",!0)){do ne=V(!0),j.push(ne);while(c(",",!0));c("]"),typeof ne<"u"&&xe(N,R+"."+ft,ne)}}else j=V(!0),xe(N,R+"."+ft,j);var Oe=M[q];Oe&&(j=[].concat(Oe).concat(j)),M[q]=j,c(",",!0),c(";",!0)}return M}var mt=V(!0);return xe(N,R,mt),mt}function xe(N,R,M){if(b===N&&/^features\./.test(R)){D[R]=M;return}N.setOption&&N.setOption(R,M)}function Dt(N,R,M,j){N.setParsedOption&&N.setParsedOption(R,M,j)}function Tr(N){if(c("[",!0)){do me(N,"option");while(c(",",!0));c("]")}return N}function R1(N,R){if(!lr.test(R=s()))throw I(R,"service name");var M=new b4(R);L(M,function(q){if(!m(M,q))if(q==="rpc")O1(M,q);else throw I(q)}),N.add(M),N===b&&w.push(M)}function O1(N,R){var M=u(),j=R;if(!lr.test(R=s()))throw I(R,"name");var q=R,ne,Oe,mt,At;if(c("("),c("stream",!0)&&(Oe=!0),!dr.test(R=s())||(ne=R,c(")"),c("returns"),c("("),c("stream",!0)&&(At=!0),!dr.test(R=s())))throw I(R);mt=R,c(")");var Ku=new C4(q,j,ne,mt,Oe,At);Ku.comment=M,L(Ku,function(wp){if(wp==="option")me(Ku,wp),c(";");else throw I(wp)}),N.add(Ku)}function N1(N,R){if(!dr.test(R=s()))throw I(R,"reference");var M=R;L(null,function(q){switch(q){case"required":case"repeated":ae(N,q,M);break;case"optional":S==="proto3"?ae(N,"proto3_optional",M):ae(N,"optional",M);break;default:if(S==="proto2"||!dr.test(q))throw I(q);o(q),ae(N,"optional",M);break}})}for(var ft;(ft=s())!==null;)switch(ft){case"package":if(!l)throw I(ft);_();break;case"import":if(!l)throw I(ft);g();break;case"syntax":if(!l)throw I(ft);C();break;case"edition":if(!l)throw I(ft);f();break;case"option":me(b,ft),c(";",!0);break;default:if(m(b,ft)){l=!1;continue}throw I(ft)}return k(),xr.filename=null,{package:d,imports:h,weakImports:p,root:e}}});var sR=A((IZ,iR)=>{"use strict";iR.exports=Fn;var x4=/\/|\./;function Fn(n,e){x4.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Fn[n]=e}Fn("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var rR;Fn("duration",{Duration:rR={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Fn("timestamp",{Timestamp:rR});Fn("empty",{Empty:{fields:{}}});Fn("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Fn("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Fn("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Fn.get=function(e){return Fn[e]||null}});var aR=A((DZ,oR)=>{"use strict";var bi=oR.exports=WA();bi.build="full";bi.tokenize=Zv();bi.parse=nR();bi.common=sR();bi.Root._configure(bi.Type,bi.parse,bi.common)});var yh=A((AZ,cR)=>{"use strict";cR.exports=aR()});var tE=A((RZ,L4)=>{L4.exports={nested:{google:{nested:{protobuf:{options:{go_package:"google.golang.org/protobuf/types/descriptorpb",java_package:"com.google.protobuf",java_outer_classname:"DescriptorProtos",csharp_namespace:"Google.Protobuf.Reflection",objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{FileDescriptorSet:{edition:"proto2",fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}},extensions:[[536e6,536e6]]},Edition:{edition:"proto2",values:{EDITION_UNKNOWN:0,EDITION_LEGACY:900,EDITION_PROTO2:998,EDITION_PROTO3:999,EDITION_2023:1e3,EDITION_2024:1001,EDITION_1_TEST_ONLY:1,EDITION_2_TEST_ONLY:2,EDITION_99997_TEST_ONLY:99997,EDITION_99998_TEST_ONLY:99998,EDITION_99999_TEST_ONLY:99999,EDITION_MAX:2147483647}},FileDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10},weakDependency:{rule:"repeated",type:"int32",id:11},optionDependency:{rule:"repeated",type:"string",id:15},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12},edition:{type:"Edition",id:14}}},DescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10},visibility:{type:"SymbolVisibility",id:11}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2},options:{type:"ExtensionRangeOptions",id:3}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},ExtensionRangeOptions:{edition:"proto2",fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999},declaration:{rule:"repeated",type:"Declaration",id:2,options:{retention:"RETENTION_SOURCE"}},features:{type:"FeatureSet",id:50},verification:{type:"VerificationState",id:3,options:{default:"UNVERIFIED",retention:"RETENTION_SOURCE"}}},extensions:[[1e3,536870911]],nested:{Declaration:{fields:{number:{type:"int32",id:1},fullName:{type:"string",id:2},type:{type:"string",id:3},reserved:{type:"bool",id:5},repeated:{type:"bool",id:6}},reserved:[[4,4]]},VerificationState:{values:{DECLARATION:0,UNVERIFIED:1}}}},FieldDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8},proto3Optional:{type:"bool",id:17}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REPEATED:3,LABEL_REQUIRED:2}}}},OneofDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3},reservedRange:{rule:"repeated",type:"EnumReservedRange",id:4},reservedName:{rule:"repeated",type:"string",id:5},visibility:{type:"SymbolVisibility",id:6}},nested:{EnumReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},EnumValueDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{edition:"proto2",fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31,options:{default:!0}},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},swiftPrefix:{type:"string",id:39},phpClassPrefix:{type:"string",id:40},phpNamespace:{type:"string",id:41},phpMetadataNamespace:{type:"string",id:44},rubyPackage:{type:"string",id:45},features:{type:"FeatureSet",id:50},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[42,42],"php_generic_services",[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{edition:"proto2",fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:11,options:{deprecated:!0}},features:{type:"FeatureSet",id:12},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[5,5],[6,6],[8,8],[9,9]]},FieldOptions:{edition:"proto2",fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},unverifiedLazy:{type:"bool",id:15},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10,options:{deprecated:!0}},debugRedact:{type:"bool",id:16},retention:{type:"OptionRetention",id:17},targets:{rule:"repeated",type:"OptionTargetType",id:19},editionDefaults:{rule:"repeated",type:"EditionDefault",id:20},features:{type:"FeatureSet",id:21},featureSupport:{type:"FeatureSupport",id:22},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[18,18]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}},OptionRetention:{values:{RETENTION_UNKNOWN:0,RETENTION_RUNTIME:1,RETENTION_SOURCE:2}},OptionTargetType:{values:{TARGET_TYPE_UNKNOWN:0,TARGET_TYPE_FILE:1,TARGET_TYPE_EXTENSION_RANGE:2,TARGET_TYPE_MESSAGE:3,TARGET_TYPE_FIELD:4,TARGET_TYPE_ONEOF:5,TARGET_TYPE_ENUM:6,TARGET_TYPE_ENUM_ENTRY:7,TARGET_TYPE_SERVICE:8,TARGET_TYPE_METHOD:9}},EditionDefault:{fields:{edition:{type:"Edition",id:3},value:{type:"string",id:2}}},FeatureSupport:{fields:{editionIntroduced:{type:"Edition",id:1},editionDeprecated:{type:"Edition",id:2},deprecationWarning:{type:"string",id:3},editionRemoved:{type:"Edition",id:4}}}}},OneofOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{edition:"proto2",fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:6,options:{deprecated:!0}},features:{type:"FeatureSet",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[5,5]]},EnumValueOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:1},features:{type:"FeatureSet",id:2},debugRedact:{type:"bool",id:3},featureSupport:{type:"FieldOptions.FeatureSupport",id:4},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:34},deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:33},idempotencyLevel:{type:"IdempotencyLevel",id:34,options:{default:"IDEMPOTENCY_UNKNOWN"}},features:{type:"FeatureSet",id:35},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],nested:{IdempotencyLevel:{values:{IDEMPOTENCY_UNKNOWN:0,NO_SIDE_EFFECTS:1,IDEMPOTENT:2}}}},UninterpretedOption:{edition:"proto2",fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},FeatureSet:{edition:"proto2",fields:{fieldPresence:{type:"FieldPresence",id:1,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},enumType:{type:"EnumType",id:2,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},repeatedFieldEncoding:{type:"RepeatedFieldEncoding",id:3,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},utf8Validation:{type:"Utf8Validation",id:4,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},messageEncoding:{type:"MessageEncoding",id:5,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},jsonFormat:{type:"JsonFormat",id:6,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},enforceNamingStyle:{type:"EnforceNamingStyle",id:7,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},defaultSymbolVisibility:{type:"VisibilityFeature.DefaultSymbolVisibility",id:8,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},extensions:[[1e3,9994],[9995,9999],[1e4,1e4]],reserved:[[999,999]],nested:{FieldPresence:{values:{FIELD_PRESENCE_UNKNOWN:0,EXPLICIT:1,IMPLICIT:2,LEGACY_REQUIRED:3}},EnumType:{values:{ENUM_TYPE_UNKNOWN:0,OPEN:1,CLOSED:2}},RepeatedFieldEncoding:{values:{REPEATED_FIELD_ENCODING_UNKNOWN:0,PACKED:1,EXPANDED:2}},Utf8Validation:{values:{UTF8_VALIDATION_UNKNOWN:0,VERIFY:2,NONE:3}},MessageEncoding:{values:{MESSAGE_ENCODING_UNKNOWN:0,LENGTH_PREFIXED:1,DELIMITED:2}},JsonFormat:{values:{JSON_FORMAT_UNKNOWN:0,ALLOW:1,LEGACY_BEST_EFFORT:2}},EnforceNamingStyle:{values:{ENFORCE_NAMING_STYLE_UNKNOWN:0,STYLE2024:1,STYLE_LEGACY:2}},VisibilityFeature:{fields:{},reserved:[[1,536870911]],nested:{DefaultSymbolVisibility:{values:{DEFAULT_SYMBOL_VISIBILITY_UNKNOWN:0,EXPORT_ALL:1,EXPORT_TOP_LEVEL:2,LOCAL_ALL:3,STRICT:4}}}}}},FeatureSetDefaults:{edition:"proto2",fields:{defaults:{rule:"repeated",type:"FeatureSetEditionDefault",id:1},minimumEdition:{type:"Edition",id:4},maximumEdition:{type:"Edition",id:5}},nested:{FeatureSetEditionDefault:{fields:{edition:{type:"Edition",id:3},overridableFeatures:{type:"FeatureSet",id:4},fixedFeatures:{type:"FeatureSet",id:5}},reserved:[[1,1],[2,2],"features"]}}},SourceCodeInfo:{edition:"proto2",fields:{location:{rule:"repeated",type:"Location",id:1}},extensions:[[536e6,536e6]],nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},span:{rule:"repeated",type:"int32",id:2,options:{packed:!0}},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{edition:"proto2",fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4},semantic:{type:"Semantic",id:5}},nested:{Semantic:{values:{NONE:0,SET:1,ALIAS:2}}}}}},SymbolVisibility:{edition:"proto2",values:{VISIBILITY_UNSET:0,VISIBILITY_LOCAL:1,VISIBILITY_EXPORT:2}}}}}}}}});var gR=A((ie,pR)=>{"use strict";var Xt=yh();pR.exports=ie=Xt.descriptor=Xt.Root.fromJSON(tE()).lookup(".google.protobuf");var uR=Xt.Namespace,su=Xt.Root,Lr=Xt.Enum,hr=Xt.Type,Ci=Xt.Field,F4=Xt.MapField,vh=Xt.OneOf,ou=Xt.Service,Eh=Xt.Method;su.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.FileDescriptorSet.decode(e));var t=new su;if(e.file)for(var r,i,s=0,o;s<e.file.length;++s){i=t,(r=e.file[s]).package&&r.package.length&&(i=t.define(r.package));var a=W4(r);if(r.name&&r.name.length&&t.files.push(i.filename=r.name),r.messageType)for(o=0;o<r.messageType.length;++o)i.add(hr.fromDescriptor(r.messageType[o],a));if(r.enumType)for(o=0;o<r.enumType.length;++o)i.add(Lr.fromDescriptor(r.enumType[o],a));if(r.extension)for(o=0;o<r.extension.length;++o)i.add(Ci.fromDescriptor(r.extension[o],a));if(r.service)for(o=0;o<r.service.length;++o)i.add(ou.fromDescriptor(r.service[o],a));var c=Qo(r.options,ie.FileOptions);if(c){var u=Object.keys(c);for(o=0;o<u.length;++o)i.setOption(u[o],c[u[o]])}}return t.resolveAll()};su.prototype.toDescriptor=function(e){var t=ie.FileDescriptorSet.create();return lR(this,t.file,e),t};function lR(n,e,t){var r=ie.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});K4(t,r),n instanceof su||(r.package=n.fullName.substring(1));for(var i=0,s;i<n.nestedArray.length;++i)(s=n._nestedArray[i])instanceof hr?r.messageType.push(s.toDescriptor(t)):s instanceof Lr?r.enumType.push(s.toDescriptor()):s instanceof Ci?r.extension.push(s.toDescriptor(t)):s instanceof ou?r.service.push(s.toDescriptor()):s instanceof uR&&lR(s,e,t);r.options=Yo(n.options,ie.FileOptions),r.messageType.length+r.enumType.length+r.extension.length+r.service.length&&e.push(r)}var B4=0;hr.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e));var i=new hr(e.name.length?e.name:"Type"+B4++,Qo(e.options,ie.MessageOptions)),s;if(r||(i._edition=t),e.oneofDecl)for(s=0;s<e.oneofDecl.length;++s)i.add(vh.fromDescriptor(e.oneofDecl[s]));if(e.field)for(s=0;s<e.field.length;++s){var o=Ci.fromDescriptor(e.field[s],t,!0);i.add(o),e.field[s].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[s].oneofIndex].add(o)}if(e.extension)for(s=0;s<e.extension.length;++s)i.add(Ci.fromDescriptor(e.extension[s],t,!0));if(e.nestedType)for(s=0;s<e.nestedType.length;++s)i.add(hr.fromDescriptor(e.nestedType[s],t,!0)),e.nestedType[s].options&&e.nestedType[s].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(s=0;s<e.enumType.length;++s)i.add(Lr.fromDescriptor(e.enumType[s],t,!0));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],s=0;s<e.extensionRange.length;++s)i.extensions.push([e.extensionRange[s].start,e.extensionRange[s].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(s=0;s<e.reservedRange.length;++s)i.reserved.push([e.reservedRange[s].start,e.reservedRange[s].end]);if(e.reservedName)for(s=0;s<e.reservedName.length;++s)i.reserved.push(e.reservedName[s])}return i};hr.prototype.toDescriptor=function(e){var t=ie.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;if(t.field.push(i=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof F4){var s=nE(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType,!1),o=nE(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType,!1),a=o===11||o===14?this._fieldsArray[r].resolvedType&&fR(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;t.nestedType.push(ie.DescriptorProto.create({name:i.typeName,field:[ie.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ie.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ie.MessageOptions.create({mapEntry:!0})}))}}for(r=0;r<this.oneofsArray.length;++r)t.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof Ci?t.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof hr?t.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof Lr&&t.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)t.extensionRange.push(ie.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)typeof this.reserved[r]=="string"?t.reservedName.push(this.reserved[r]):t.reservedRange.push(ie.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return t.options=Yo(this.options,ie.MessageOptions),t};var U4=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;Ci.fromDescriptor=function(e,t,r){if(typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=$4(e.type);var s;switch(e.label){case 1:s=void 0;break;case 2:s="required";break;case 3:s="repeated";break;default:throw Error("illegal label: "+e.label)}var o=e.extendee;e.extendee!==void 0&&(o=o.length?o:void 0);var a=new Ci(e.name.length?e.name:"field"+e.number,e.number,i,s,o);if(r||(a._edition=t),a.options=Qo(e.options,ie.FieldOptions),e.proto3_optional&&(a.options.proto3_optional=!0),e.defaultValue&&e.defaultValue.length){var c=e.defaultValue;switch(c){case"true":case"TRUE":c=!0;break;case"false":case"FALSE":c=!1;break;default:var u=U4.exec(c);u&&(c=parseInt(c));break}a.setOption("default",c)}return G4(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&a.setOption("packed",!1):(!t||t==="proto2")&&e.options&&e.options.packed&&a.setOption("packed",!0)),a};Ci.prototype.toDescriptor=function(e){var t=ie.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=Xt.util.ucFirst(this.name),t.label=3;else{switch(t.type=nE(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:t.typeName=this.resolvedType?fR(this.parent,this.resolvedType):this.type;break}this.rule==="repeated"?t.label=3:this.required&&e==="proto2"?t.label=2:t.label=1}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=Yo(this.options,ie.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default)),this.options.proto3_optional&&(t.proto3_optional=!0)),e==="proto3"?this.packed||((t.options||(t.options=ie.FieldOptions.create())).packed=!1):(!e||e==="proto2")&&this.packed&&((t.options||(t.options=ie.FieldOptions.create())).packed=!0),t};var V4=0;Lr.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.EnumDescriptorProto.decode(e));var i={};if(e.value)for(var s=0;s<e.value.length;++s){var o=e.value[s].name,a=e.value[s].number||0;i[o&&o.length?o:"NAME"+a]=a}var c=new Lr(e.name&&e.name.length?e.name:"Enum"+V4++,i,Qo(e.options,ie.EnumOptions));return r||(c._edition=t),c};Lr.prototype.toDescriptor=function(){for(var e=[],t=0,r=Object.keys(this.values);t<r.length;++t)e.push(ie.EnumValueDescriptorProto.create({name:r[t],number:this.values[r[t]]}));return ie.EnumDescriptorProto.create({name:this.name,value:e,options:Yo(this.options,ie.EnumOptions)})};var q4=0;vh.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.OneofDescriptorProto.decode(e)),new vh(e.name&&e.name.length?e.name:"oneof"+q4++)};vh.prototype.toDescriptor=function(){return ie.OneofDescriptorProto.create({name:this.name})};var z4=0;ou.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.ServiceDescriptorProto.decode(e));var i=new ou(e.name&&e.name.length?e.name:"Service"+z4++,Qo(e.options,ie.ServiceOptions));if(r||(i._edition=t),e.method)for(var s=0;s<e.method.length;++s)i.add(Eh.fromDescriptor(e.method[s]));return i};ou.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return ie.ServiceDescriptorProto.create({name:this.name,method:e,options:Yo(this.options,ie.ServiceOptions)})};var j4=0;Eh.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.MethodDescriptorProto.decode(e)),new Eh(e.name&&e.name.length?e.name:"Method"+j4++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Qo(e.options,ie.MethodOptions))};Eh.prototype.toDescriptor=function(){return ie.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Yo(this.options,ie.MethodOptions)})};function $4(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function G4(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function nE(n,e,t){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Lr)return 14;if(e instanceof hr)return t?10:11;throw Error("illegal type: "+n)}function dR(n,e){for(var t={},r=0,i,s;r<e.fieldsArray.length;++r)if((s=(i=e._fieldsArray[r]).name)!=="uninterpretedOption"&&Object.prototype.hasOwnProperty.call(n,s)){var o=H4(s);i.resolvedType instanceof hr?t[o]=dR(n[s],i.resolvedType):i.resolvedType instanceof Lr?t[o]=i.resolvedType.valuesById[n[s]]:t[o]=n[s]}return t}function Qo(n,e){if(n)return dR(e.toObject(n),e)}function hR(n,e){for(var t={},r=Object.keys(n),i=0;i<r.length;++i){var s=r[i],o=Xt.util.camelCase(s);if(Object.prototype.hasOwnProperty.call(e.fields,o)){var a=e.fields[o];a.resolvedType instanceof hr?t[o]=hR(n[s],a.resolvedType):t[o]=n[s],a.repeated&&!Array.isArray(t[o])&&(t[o]=[t[o]])}}return t}function Yo(n,e){if(n)return e.fromObject(hR(n,e))}function fR(n,e){var t=n.fullName.split("."),r=e.fullName.split("."),i=0,s=0,o=r.length-1;if(!(n instanceof su)&&e instanceof uR)for(;i<t.length&&s<o&&t[i]===r[s];){var a=e.lookup(t[i++],!0);if(a!==null&&a!==e)break;++s}else for(;i<t.length&&s<o&&t[i]===r[s];++i,++s);return r.slice(s).join(".")}function H4(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}function W4(n){if(n.syntax==="editions")switch(n.edition){case ie.Edition.EDITION_2023:return"2023";default:throw new Error("Unsupported edition "+n.edition)}return n.syntax==="proto3"?"proto3":"proto2"}function K4(n,e){if(n)if(n==="proto2"||n==="proto3")e.syntax=n;else switch(e.syntax="editions",n){case"2023":e.edition=ie.Edition.EDITION_2023;break;default:throw new Error("Unsupported edition "+n)}}});var mR=A((OZ,Q4)=>{Q4.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var yR=A((NZ,Y4)=>{Y4.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var vR=A((kZ,J4)=>{J4.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var SR=A(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.addCommonProtos=Ii.loadProtosWithOptionsSync=Ii.loadProtosWithOptions=void 0;var ER=_e("fs"),_R=_e("path"),Jo=yh();function TR(n,e){let t=n.resolvePath;n.resolvePath=(r,i)=>{if(_R.isAbsolute(i))return i;for(let s of e){let o=_R.join(s,i);try{return ER.accessSync(o,ER.constants.R_OK),o}catch{continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),t(r,i)}}function X4(n,e){return E(this,null,function*(){let t=new Jo.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));TR(t,e.includeDirs)}let r=yield t.load(n,e);return r.resolveAll(),r})}Ii.loadProtosWithOptions=X4;function Z4(n,e){let t=new Jo.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");TR(t,e.includeDirs)}let r=t.loadSync(n,e);return r.resolveAll(),r}Ii.loadProtosWithOptionsSync=Z4;function eq(){let n=mR(),e=tE(),t=yR(),r=vR();Jo.common("api",n.nested.google.nested.protobuf.nested),Jo.common("descriptor",e.nested.google.nested.protobuf.nested),Jo.common("source_context",t.nested.google.nested.protobuf.nested),Jo.common("type",r.nested.google.nested.protobuf.nested)}Ii.addCommonProtos=eq});var wR=A((au,rE)=>{"use strict";(function(n,e){function t(r){return r.default||r}typeof define=="function"&&define.amd?define([],function(){var r={};return e(r),t(r)}):typeof au=="object"?(e(au),typeof rE=="object"&&(rE.exports=t(au))):function(){var r={};e(r),n.Long=t(r)}()})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:au,function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(f,m,L){this.low=f|0,this.high=m|0,this.unsigned=!!L}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function r(f){return(f&&f.__isLong__)===!0}function i(f){var m=Math.clz32(f&-f);return f?31-m:m}t.isLong=r;var s={},o={};function a(f,m){var L,ue,ae;return m?(f>>>=0,(ae=0<=f&&f<256)&&(ue=o[f],ue)?ue:(L=u(f,0,!0),ae&&(o[f]=L),L)):(f|=0,(ae=-128<=f&&f<128)&&(ue=s[f],ue)?ue:(L=u(f,f<0?-1:0,!1),ae&&(s[f]=L),L))}t.fromInt=a;function c(f,m){if(isNaN(f))return m?I:k;if(m){if(f<0)return I;if(f>=w)return v}else{if(f<=-D)return _;if(f+1>=D)return y}return f<0?c(-f,m).neg():u(f%b|0,f/b|0,m)}t.fromNumber=c;function u(f,m,L){return new t(f,m,L)}t.fromBits=u;var l=Math.pow;function d(f,m,L){if(f.length===0)throw Error("empty string");if(typeof m=="number"?(L=m,m=!1):m=!!m,f==="NaN"||f==="Infinity"||f==="+Infinity"||f==="-Infinity")return m?I:k;if(L=L||10,L<2||36<L)throw RangeError("radix");var ue;if((ue=f.indexOf("-"))>0)throw Error("interior hyphen");if(ue===0)return d(f.substring(1),m,L).neg();for(var ae=c(l(L,8)),we=k,qe=0;qe<f.length;qe+=8){var gt=Math.min(8,f.length-qe),Ct=parseInt(f.substring(qe,qe+gt),L);if(gt<8){var rt=c(l(L,gt));we=we.mul(rt).add(c(Ct))}else we=we.mul(ae),we=we.add(c(Ct))}return we.unsigned=m,we}t.fromString=d;function h(f,m){return typeof f=="number"?c(f,m):typeof f=="string"?d(f,m):u(f.low,f.high,typeof m=="boolean"?m:f.unsigned)}t.fromValue=h;var p=65536,S=1<<24,b=p*p,w=b*b,D=w/2,x=a(S),k=a(0);t.ZERO=k;var I=a(0,!0);t.UZERO=I;var G=a(1);t.ONE=G;var V=a(1,!0);t.UONE=V;var T=a(-1);t.NEG_ONE=T;var y=u(-1,2147483647,!1);t.MAX_VALUE=y;var v=u(-1,-1,!0);t.MAX_UNSIGNED_VALUE=v;var _=u(0,-2147483648,!1);t.MIN_VALUE=_;var g=t.prototype;g.toInt=function(){return this.unsigned?this.low>>>0:this.low},g.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},g.toString=function(m){if(m=m||10,m<2||36<m)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(_)){var L=c(m),ue=this.div(L),ae=ue.mul(L).sub(this);return ue.toString(m)+ae.toInt().toString(m)}else return"-"+this.neg().toString(m);for(var we=c(l(m,6),this.unsigned),qe=this,gt="";;){var Ct=qe.div(we),rt=qe.sub(Ct.mul(we)).toInt()>>>0,me=rt.toString(m);if(qe=Ct,qe.isZero())return me+gt;for(;me.length<6;)me="0"+me;gt=""+me+gt}},g.getHighBits=function(){return this.high},g.getHighBitsUnsigned=function(){return this.high>>>0},g.getLowBits=function(){return this.low},g.getLowBitsUnsigned=function(){return this.low>>>0},g.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var m=this.high!=0?this.high:this.low,L=31;L>0&&(m&1<<L)==0;L--);return this.high!=0?L+33:L+1},g.isSafeInteger=function(){var m=this.high>>21;return m?this.unsigned?!1:m===-1&&!(this.low===0&&this.high===-2097152):!0},g.isZero=function(){return this.high===0&&this.low===0},g.eqz=g.isZero,g.isNegative=function(){return!this.unsigned&&this.high<0},g.isPositive=function(){return this.unsigned||this.high>=0},g.isOdd=function(){return(this.low&1)===1},g.isEven=function(){return(this.low&1)===0},g.equals=function(m){return r(m)||(m=h(m)),this.unsigned!==m.unsigned&&this.high>>>31===1&&m.high>>>31===1?!1:this.high===m.high&&this.low===m.low},g.eq=g.equals,g.notEquals=function(m){return!this.eq(m)},g.neq=g.notEquals,g.ne=g.notEquals,g.lessThan=function(m){return this.comp(m)<0},g.lt=g.lessThan,g.lessThanOrEqual=function(m){return this.comp(m)<=0},g.lte=g.lessThanOrEqual,g.le=g.lessThanOrEqual,g.greaterThan=function(m){return this.comp(m)>0},g.gt=g.greaterThan,g.greaterThanOrEqual=function(m){return this.comp(m)>=0},g.gte=g.greaterThanOrEqual,g.ge=g.greaterThanOrEqual,g.compare=function(m){if(r(m)||(m=h(m)),this.eq(m))return 0;var L=this.isNegative(),ue=m.isNegative();return L&&!ue?-1:!L&&ue?1:this.unsigned?m.high>>>0>this.high>>>0||m.high===this.high&&m.low>>>0>this.low>>>0?-1:1:this.sub(m).isNegative()?-1:1},g.comp=g.compare,g.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(G)},g.neg=g.negate,g.add=function(m){r(m)||(m=h(m));var L=this.high>>>16,ue=this.high&65535,ae=this.low>>>16,we=this.low&65535,qe=m.high>>>16,gt=m.high&65535,Ct=m.low>>>16,rt=m.low&65535,me=0,It=0,xe=0,Dt=0;return Dt+=we+rt,xe+=Dt>>>16,Dt&=65535,xe+=ae+Ct,It+=xe>>>16,xe&=65535,It+=ue+gt,me+=It>>>16,It&=65535,me+=L+qe,me&=65535,u(xe<<16|Dt,me<<16|It,this.unsigned)},g.subtract=function(m){return r(m)||(m=h(m)),this.add(m.neg())},g.sub=g.subtract,g.multiply=function(m){if(this.isZero())return this;if(r(m)||(m=h(m)),e){var L=e.mul(this.low,this.high,m.low,m.high);return u(L,e.get_high(),this.unsigned)}if(m.isZero())return this.unsigned?I:k;if(this.eq(_))return m.isOdd()?_:k;if(m.eq(_))return this.isOdd()?_:k;if(this.isNegative())return m.isNegative()?this.neg().mul(m.neg()):this.neg().mul(m).neg();if(m.isNegative())return this.mul(m.neg()).neg();if(this.lt(x)&&m.lt(x))return c(this.toNumber()*m.toNumber(),this.unsigned);var ue=this.high>>>16,ae=this.high&65535,we=this.low>>>16,qe=this.low&65535,gt=m.high>>>16,Ct=m.high&65535,rt=m.low>>>16,me=m.low&65535,It=0,xe=0,Dt=0,Tr=0;return Tr+=qe*me,Dt+=Tr>>>16,Tr&=65535,Dt+=we*me,xe+=Dt>>>16,Dt&=65535,Dt+=qe*rt,xe+=Dt>>>16,Dt&=65535,xe+=ae*me,It+=xe>>>16,xe&=65535,xe+=we*rt,It+=xe>>>16,xe&=65535,xe+=qe*Ct,It+=xe>>>16,xe&=65535,It+=ue*me+ae*rt+we*Ct+qe*gt,It&=65535,u(Dt<<16|Tr,It<<16|xe,this.unsigned)},g.mul=g.multiply,g.divide=function(m){if(r(m)||(m=h(m)),m.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&m.low===-1&&m.high===-1)return this;var L=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,m.low,m.high);return u(L,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?I:k;var ue,ae,we;if(this.unsigned){if(m.unsigned||(m=m.toUnsigned()),m.gt(this))return I;if(m.gt(this.shru(1)))return V;we=I}else{if(this.eq(_)){if(m.eq(G)||m.eq(T))return _;if(m.eq(_))return G;var qe=this.shr(1);return ue=qe.div(m).shl(1),ue.eq(k)?m.isNegative()?G:T:(ae=this.sub(m.mul(ue)),we=ue.add(ae.div(m)),we)}else if(m.eq(_))return this.unsigned?I:k;if(this.isNegative())return m.isNegative()?this.neg().div(m.neg()):this.neg().div(m).neg();if(m.isNegative())return this.div(m.neg()).neg();we=k}for(ae=this;ae.gte(m);){ue=Math.max(1,Math.floor(ae.toNumber()/m.toNumber()));for(var gt=Math.ceil(Math.log(ue)/Math.LN2),Ct=gt<=48?1:l(2,gt-48),rt=c(ue),me=rt.mul(m);me.isNegative()||me.gt(ae);)ue-=Ct,rt=c(ue,this.unsigned),me=rt.mul(m);rt.isZero()&&(rt=G),we=we.add(rt),ae=ae.sub(me)}return we},g.div=g.divide,g.modulo=function(m){if(r(m)||(m=h(m)),e){var L=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,m.low,m.high);return u(L,e.get_high(),this.unsigned)}return this.sub(this.div(m).mul(m))},g.mod=g.modulo,g.rem=g.modulo,g.not=function(){return u(~this.low,~this.high,this.unsigned)},g.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},g.clz=g.countLeadingZeros,g.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},g.ctz=g.countTrailingZeros,g.and=function(m){return r(m)||(m=h(m)),u(this.low&m.low,this.high&m.high,this.unsigned)},g.or=function(m){return r(m)||(m=h(m)),u(this.low|m.low,this.high|m.high,this.unsigned)},g.xor=function(m){return r(m)||(m=h(m)),u(this.low^m.low,this.high^m.high,this.unsigned)},g.shiftLeft=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?u(this.low<<m,this.high<<m|this.low>>>32-m,this.unsigned):u(0,this.low<<m-32,this.unsigned)},g.shl=g.shiftLeft,g.shiftRight=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?u(this.low>>>m|this.high<<32-m,this.high>>m,this.unsigned):u(this.high>>m-32,this.high>=0?0:-1,this.unsigned)},g.shr=g.shiftRight,g.shiftRightUnsigned=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?u(this.low>>>m|this.high<<32-m,this.high>>>m,this.unsigned):m===32?u(this.high,0,this.unsigned):u(this.high>>>m-32,0,this.unsigned)},g.shru=g.shiftRightUnsigned,g.shr_u=g.shiftRightUnsigned,g.rotateLeft=function(m){var L;return r(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?u(this.high,this.low,this.unsigned):m<32?(L=32-m,u(this.low<<m|this.high>>>L,this.high<<m|this.low>>>L,this.unsigned)):(m-=32,L=32-m,u(this.high<<m|this.low>>>L,this.low<<m|this.high>>>L,this.unsigned))},g.rotl=g.rotateLeft,g.rotateRight=function(m){var L;return r(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?u(this.high,this.low,this.unsigned):m<32?(L=32-m,u(this.high<<L|this.low>>>m,this.low<<L|this.high>>>m,this.unsigned)):(m-=32,L=32-m,u(this.low<<L|this.high>>>m,this.high<<L|this.low>>>m,this.unsigned))},g.rotr=g.rotateRight,g.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},g.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},g.toBytes=function(m){return m?this.toBytesLE():this.toBytesBE()},g.toBytesLE=function(){var m=this.high,L=this.low;return[L&255,L>>>8&255,L>>>16&255,L>>>24,m&255,m>>>8&255,m>>>16&255,m>>>24]},g.toBytesBE=function(){var m=this.high,L=this.low;return[m>>>24,m>>>16&255,m>>>8&255,m&255,L>>>24,L>>>16&255,L>>>8&255,L&255]},t.fromBytes=function(m,L,ue){return ue?t.fromBytesLE(m,L):t.fromBytesBE(m,L)},t.fromBytesLE=function(m,L){return new t(m[0]|m[1]<<8|m[2]<<16|m[3]<<24,m[4]|m[5]<<8|m[6]<<16|m[7]<<24,L)},t.fromBytesBE=function(m,L){return new t(m[4]<<24|m[5]<<16|m[6]<<8|m[7],m[0]<<24|m[1]<<16|m[2]<<8|m[3],L)},typeof BigInt=="function"&&(t.fromBigInt=function(m,L){var ue=Number(BigInt.asIntN(32,m)),ae=Number(BigInt.asIntN(32,m>>BigInt(32)));return u(ue,ae,L)},t.fromValue=function(m,L){return typeof m=="bigint"?t.fromBigInt(m,L):h(m,L)},g.toBigInt=function(){var m=BigInt(this.low>>>0),L=BigInt(this.unsigned?this.high>>>0:this.high);return L<<BigInt(32)|m});var C=n.default=t})});var aE=A(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.loadFileDescriptorSetFromObject=tt.loadFileDescriptorSetFromBuffer=tt.fromJSON=tt.loadSync=tt.load=tt.IdempotencyLevel=tt.isAnyExtension=tt.Long=void 0;var tq=gD(),fr=yh(),sE=gR(),oE=SR(),nq=wR();tt.Long=nq;function rq(n){return"@type"in n&&typeof n["@type"]=="string"}tt.isAnyExtension=rq;var IR;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(IR=tt.IdempotencyLevel||(tt.IdempotencyLevel={}));var DR={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function iq(n,e){return n===""?e:n+"."+e}function sq(n){return n instanceof fr.Service||n instanceof fr.Type||n instanceof fr.Enum}function oq(n){return n instanceof fr.Namespace||n instanceof fr.Root}function AR(n,e){let t=iq(e,n.name);return sq(n)?[[t,n]]:oq(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(r=>AR(n.nested[r],t)).reduce((r,i)=>r.concat(i),[]):[]}function bR(n,e){return function(r){return n.toObject(n.decode(r),e)}}function CR(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let r=n.fromObject(t);return n.encode(r).finish()}}function aq(n){return(n||[]).reduce((e,t)=>{for(let[r,i]of Object.entries(t))switch(r){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[r]=i}return e},{deprecated:!1,idempotency_level:IR.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function cq(n,e,t,r){let i=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:CR(i),requestDeserialize:bR(i,t),responseSerialize:CR(s),responseDeserialize:bR(s,t),originalName:tq(n.name),requestType:iE(i,r),responseType:iE(s,r),options:aq(n.parsedOptions)}}function uq(n,e,t,r){let i={};for(let s of n.methodsArray)i[s.name]=cq(s,e,t,r);return i}function iE(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,DR),fileDescriptorProtos:e}}function lq(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,DR),fileDescriptorProtos:e}}function dq(n,e,t,r){if(n instanceof fr.Service)return uq(n,e,t,r);if(n instanceof fr.Type)return iE(n,r);if(n instanceof fr.Enum)return lq(n,r);throw new Error("Type mismatch in reflection object handling")}function _h(n,e){let t={};n.resolveAll();let i=n.toDescriptor("proto3").file.map(s=>Buffer.from(sE.FileDescriptorProto.encode(s).finish()));for(let[s,o]of AR(n,""))t[s]=dq(o,s,e,i);return t}function RR(n,e){e=e||{};let t=fr.Root.fromDescriptor(n);return t.resolveAll(),_h(t,e)}function hq(n,e){return(0,oE.loadProtosWithOptions)(n,e).then(t=>_h(t,e))}tt.load=hq;function fq(n,e){let t=(0,oE.loadProtosWithOptionsSync)(n,e);return _h(t,e)}tt.loadSync=fq;function pq(n,e){e=e||{};let t=fr.Root.fromJSON(n);return t.resolveAll(),_h(t,e)}tt.fromJSON=pq;function gq(n,e){let t=sE.FileDescriptorSet.decode(n);return RR(t,e)}tt.loadFileDescriptorSetFromBuffer=gq;function mq(n,e){let t=sE.FileDescriptorSet.fromObject(n);return RR(t,e)}tt.loadFileDescriptorSetFromObject=mq;(0,oE.addCommonProtos)()});var Rs=A(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.setup=ke.getChannelzServiceDefinition=ke.getChannelzHandlers=ke.unregisterChannelzRef=ke.registerChannelzSocket=ke.registerChannelzServer=ke.registerChannelzSubchannel=ke.registerChannelzChannel=ke.ChannelzCallTracker=ke.ChannelzChildrenTracker=ke.ChannelzTrace=void 0;var OR=_e("net"),cu=cn(),lu=ve(),yq=ir(),vq=qd(),Eq=rv();function cE(n){return{channel_id:n.id,name:n.name}}function hE(n){return{subchannel_id:n.id,name:n.name}}function _q(n){return{server_id:n.id}}function Sh(n){return{socket_id:n.id,name:n.name}}var NR=32,uE=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:r?.kind==="channel"?r:void 0,childSubchannel:r?.kind==="subchannel"?r:void 0}),this.events.length>=NR*2&&(this.events=this.events.slice(NR)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Fr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Fr(e.timestamp),channel_ref:e.childChannel?cE(e.childChannel):null,subchannel_ref:e.childSubchannel?hE(e.childSubchannel):null}))}}};ke.ChannelzTrace=uE;var lE=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,i;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let t=[];for(let{ref:i}of this.subchannelChildren.values())t.push(i);let r=[];for(let{ref:i}of this.socketChildren.values())r.push(i);return{channels:e,subchannels:t,sockets:r}}};ke.ChannelzChildrenTracker=lE;var dE=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};ke.ChannelzCallTracker=dE;var Tq=1;function wh(){return Tq++}var uu=[],fE=[],Di=[],pE=[];function Sq(n,e,t){let r=wh(),i={id:r,name:n,kind:"channel"};return t&&(uu[r]={ref:i,getInfo:e}),i}ke.registerChannelzChannel=Sq;function wq(n,e,t){let r=wh(),i={id:r,name:n,kind:"subchannel"};return t&&(fE[r]={ref:i,getInfo:e}),i}ke.registerChannelzSubchannel=wq;function bq(n,e){let t=wh(),r={id:t,kind:"server"};return e&&(Di[t]={ref:r,getInfo:n}),r}ke.registerChannelzServer=bq;function Cq(n,e,t){let r=wh(),i={id:r,name:n,kind:"socket"};return t&&(pE[r]={ref:i,getInfo:e}),i}ke.registerChannelzSocket=Cq;function Iq(n){switch(n.kind){case"channel":delete uu[n.id];return;case"subchannel":delete fE[n.id];return;case"server":delete Di[n.id];return;case"socket":delete pE[n.id];return}}ke.unregisterChannelzRef=Iq;function Dq(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function kR(n){if(n==="")return[];let e=n.split(":").map(r=>Dq(r));return[].concat(...e)}function Aq(n){if((0,OR.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,OR.isIPv6)(n)){let e,t,r=n.indexOf("::");r===-1?(e=n,t=""):(e=n.substring(0,r),t=n.substring(r+2));let i=Buffer.from(kR(e)),s=Buffer.from(kR(t)),o=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,o,s])}else return null}function MR(n){switch(n){case cu.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case cu.ConnectivityState.IDLE:return{state:"IDLE"};case cu.ConnectivityState.READY:return{state:"READY"};case cu.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case cu.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Fr(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function xR(n){let e=n.getInfo();return{ref:cE(n.ref),data:{target:e.target,state:MR(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>cE(t)),subchannel_ref:e.children.subchannels.map(t=>hE(t))}}function Rq(n,e){let t=Number.parseInt(n.request.channel_id),r=uu[t];if(r===void 0){e({code:lu.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:xR(r)})}function Oq(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_channel_id);for(;i<uu.length;i++){let s=uu[i];if(s!==void 0&&(r.push(xR(s)),r.length>=t))break}e(null,{channel:r,end:i>=Di.length})}function LR(n){let e=n.getInfo();return{ref:_q(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>Sh(t))}}function Nq(n,e){let t=Number.parseInt(n.request.server_id),r=Di[t];if(r===void 0){e({code:lu.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:LR(r)})}function kq(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_server_id);for(;i<Di.length;i++){let s=Di[i];if(s!==void 0&&(r.push(LR(s)),r.length>=t))break}e(null,{server:r,end:i>=Di.length})}function Pq(n,e){let t=Number.parseInt(n.request.subchannel_id),r=fE[t];if(r===void 0){e({code:lu.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let i=r.getInfo(),s={ref:hE(r.ref),data:{target:i.target,state:MR(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:Fr(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(o=>Sh(o))};e(null,{subchannel:s})}function PR(n){var e;return(0,yq.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=Aq(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function Mq(n,e){var t,r,i,s,o;let a=Number.parseInt(n.request.socket_id),c=pE[a];if(c===void 0){e({code:lu.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let u=c.getInfo(),l=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=u.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(r=u.security.cipherSuiteOtherName)!==null&&r!==void 0?r:void 0,local_certificate:(i=u.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=u.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,d={ref:Sh(c.ref),local:u.localAddress?PR(u.localAddress):null,remote:u.remoteAddress?PR(u.remoteAddress):null,remote_name:(o=u.remoteName)!==null&&o!==void 0?o:void 0,security:l,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:Fr(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Fr(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:Fr(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:Fr(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}};e(null,{socket:d})}function xq(n,e){let t=Number.parseInt(n.request.server_id),r=Di[t];if(r===void 0){e({code:lu.Status.NOT_FOUND,details:"No server data found for id "+t});return}let i=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=r.getInfo().sessionChildren.sockets.sort((l,d)=>l.id-d.id),c=[],u=0;for(;u<a.length&&!(a[u].id>=i&&(c.push(Sh(a[u])),c.length>=s));u++);e(null,{socket_ref:c,end:u>=a.length})}function FR(){return{GetChannel:Rq,GetTopChannels:Oq,GetServer:Nq,GetServers:kq,GetSubchannel:Pq,GetSocket:Mq,GetServerSockets:xq}}ke.getChannelzHandlers=FR;var Th=null;function BR(){if(Th)return Th;let n=aE().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return Th=(0,Eq.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,Th}ke.getChannelzServiceDefinition=BR;function Lq(){(0,vq.registerAdminService)(BR,FR)}ke.setup=Lq});var UR=A(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});Ch.Subchannel=void 0;var Ae=cn(),Fq=Vc(),gE=Be(),bh=ve(),Bq=Kt(),Uq=ir(),Xo=Rs(),Vq="subchannel",qq=~(1<<31),mE=class{constructor(e,t,r,i,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=i,this.connector=s,this.connectivityState=Ae.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Xo.ChannelzCallTracker,this.childrenTracker=new Xo.ChannelzChildrenTracker,this.streamTracker=new Xo.ChannelzCallTracker;let a={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new Fq.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Uq.subchannelAddressToString)(t),this.keepaliveTime=(o=r["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Xo.ChannelzTrace,this.channelzRef=(0,Xo.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){gE.trace(bh.LogVerbosity.DEBUG,Vq,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){gE.trace(bh.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Ae.ConnectivityState.TRANSIENT_FAILURE],Ae.ConnectivityState.CONNECTING):this.transitionToState([Ae.ConnectivityState.TRANSIENT_FAILURE],Ae.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,qq);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Ae.ConnectivityState.CONNECTING],Ae.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(r=>{this.transitionToState([Ae.ConnectivityState.READY],Ae.ConnectivityState.IDLE),r&&this.keepaliveTime>0&&(this.keepaliveTime*=2,gE.log(bh.LogVerbosity.ERROR,`Connection to ${(0,Bq.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([Ae.ConnectivityState.CONNECTING],Ae.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,r){var i,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Ae.ConnectivityState[this.connectivityState]+" -> "+Ae.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ae.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Ae.ConnectivityState.READY:this.stopBackoff();break;case Ae.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Ae.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Ae.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,Xo.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Ae.ConnectivityState.CONNECTING,Ae.ConnectivityState.READY],Ae.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,r,i){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===bh.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,r,i,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Ae.ConnectivityState.IDLE],Ae.ConnectivityState.CONNECTING)||this.connectivityState===Ae.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Ae.ConnectivityState.TRANSIENT_FAILURE],Ae.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Ch.Subchannel=mE});var _E=A(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.setup=Oi.DEFAULT_PORT=void 0;var VR=nr(),zR=_e("dns"),jR=_e("util"),zq=Oy(),yE=ve(),vE=Ft(),jq=Be(),$q=ve(),Ai=Kt(),qR=_e("net"),Gq=Vc(),Hq="dns_resolver";function Ri(n){jq.trace($q.LogVerbosity.DEBUG,Hq,n)}Oi.DEFAULT_PORT=443;var Wq=3e4,Kq=jR.promisify(zR.resolveTxt),Qq=jR.promisify(zR.lookup);function Yq(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(r=>r.length));t++)for(let r of n)t<r.length&&e.push(r[t]);return e}var EE=class{constructor(e,t,r){var i,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Ri("Resolver constructed for target "+(0,Ai.uriToString)(e));let a=(0,Ai.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,qR.isIPv4)(a.host)||(0,qR.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(i=a.port)!==null&&i!==void 0?i:Oi.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:Oi.DEFAULT_PORT),this.percentage=Math.random()*100,r["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:yE.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Ai.uriToString)(this.target)}`,metadata:new vE.Metadata};let c={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new Gq.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=r["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:Wq,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Ri("Returning IP address for target "+(0,Ai.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Ri("Failed to parse DNS address "+(0,Ai.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:yE.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Ai.uriToString)(this.target)}`,metadata:new vE.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Ri("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=Qq(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let r=t.filter(o=>o.family===4),i=t.filter(o=>o.family===6);this.latestLookupResult=Yq(i,r).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Ri("Resolved addresses for target "+(0,Ai.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(Ri("Resolution error for target "+(0,Ai.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=Kq(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,zq.extractAndSelectServiceConfig)(t,this.percentage)}catch(r){this.latestServiceConfigError={code:yE.Status.UNAVAILABLE,details:`Parsing service config failed with error ${r.message}`,metadata:new vE.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Ri('resolution update delayed by "min time between resolutions" rate limit'):Ri("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function Jq(){(0,VR.registerResolver)("dns",EE),(0,VR.registerDefaultScheme)("dns")}Oi.setup=Jq});var TE=A(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.getProxiedConnection=ta.mapProxyName=void 0;var du=Be(),Zo=ve(),Xq=nr(),Zq=_e("http"),ez=_e("tls"),tz=Be(),$R=ir(),ea=Kt(),nz=_e("url"),rz=_E(),iz="proxy";function Ni(n){tz.trace(Zo.LogVerbosity.DEBUG,iz,n)}function sz(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new nz.URL(n)}catch{return(0,du.log)(Zo.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,du.log)(Zo.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let r=null;t.username&&(t.password?((0,du.log)(Zo.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${t.username}:${t.password}`):r=t.username);let i=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${i}:${s}`};return r&&(o.creds=r),Ni("Proxy server "+o.address+" set by environment variable "+e),o}function oz(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(Ni("No proxy server list set by environment variable "+e),n.split(",")):[]}function az(n,e){var t;let r={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return r;let i=sz();if(!i.address)return r;let s=(0,ea.splitHostPort)(n.path);if(!s)return r;let o=s.host;for(let c of oz())if(c===o)return Ni("Not using proxy for target in no_proxy list: "+(0,ea.uriToString)(n)),r;let a={"grpc.http_connect_target":(0,ea.uriToString)(n)};return i.creds&&(a["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:a}}ta.mapProxyName=az;function cz(n,e,t){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let i=e["grpc.http_connect_target"],s=(0,ea.parseUri)(i);if(s===null)return Promise.resolve({});let o=(0,ea.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(r=o.port)!==null&&r!==void 0?r:rz.DEFAULT_PORT}`,c={method:"CONNECT",path:a},u={Host:a};(0,$R.isTcpSubchannelAddress)(n)?(c.host=n.host,c.port=n.port):c.socketPath=n.path,"grpc.http_connect_creds"in e&&(u["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),c.headers=u;let l=(0,$R.subchannelAddressToString)(n);return Ni("Using proxy "+l+" to connect to "+c.path),new Promise((d,h)=>{let p=Zq.request(c);p.once("connect",(S,b,w)=>{var D;if(p.removeAllListeners(),b.removeAllListeners(),S.statusCode===200)if(Ni("Successfully connected to "+c.path+" through proxy "+l),"secureContext"in t){let x=(0,Xq.getDefaultAuthority)(s),k=(0,ea.splitHostPort)(x),I=(D=k?.host)!==null&&D!==void 0?D:x,G=ez.connect(Object.assign({host:I,servername:I,socket:b},t),()=>{Ni("Successfully established a TLS connection to "+c.path+" through proxy "+l),d({socket:G,realTarget:s})});G.on("error",V=>{Ni("Failed to establish a TLS connection to "+c.path+" through proxy "+l+" with error "+V.message),h()})}else Ni("Successfully established a plaintext connection to "+c.path+" through proxy "+l),d({socket:b,realTarget:s});else(0,du.log)(Zo.LogVerbosity.ERROR,"Failed to connect to "+c.path+" through proxy "+l+" with status "+S.statusCode),h()}),p.once("error",S=>{p.removeAllListeners(),(0,du.log)(Zo.LogVerbosity.ERROR,"Failed to connect to proxy "+l+" with error "+S.message),h()}),p.end()})}ta.getProxiedConnection=cz});var wE=A(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});Ih.StreamDecoder=void 0;var Br=function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n}(Br||{}),SE=class{constructor(e){this.maxReadMessageLength=e,this.readState=Br.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,r,i=[];for(;t<e.length;)switch(this.readState){case Br.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=Br.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Br.READING_SIZE:if(r=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+r),this.readSizeRemaining-=r,t+=r,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Br.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Br.NO_DATA,i.push(s)}}break;case Br.READING_MESSAGE:if(r=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+r)),this.readMessageRemaining-=r,t+=r,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Br.NO_DATA,i.push(o)}break;default:throw new Error("Unexpected read state")}return i}};Ih.StreamDecoder=SE});var GR=A(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Http2SubchannelCall=void 0;var Ur=_e("http2"),uz=_e("os"),Te=ve(),ki=Ft(),lz=wE(),dz=Be(),hz=ve(),fz="subchannel_call";function pz(n){for(let[e,t]of Object.entries(uz.constants.errno))if(t===n)return e;return"Unknown system error "+n}var bE=class{constructor(e,t,r,i,s){var o;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=i,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Te.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let a=(o=i.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:Te.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new lz.StreamDecoder(a),e.on("response",(c,u)=>{let l="";for(let d of Object.keys(c))l+="		"+d+": "+c[d]+`
`;switch(this.trace(`Received server headers:
`+l),c[":status"]){case 400:this.mappedStatusCode=Te.Status.INTERNAL;break;case 401:this.mappedStatusCode=Te.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Te.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Te.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Te.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Te.Status.UNKNOWN}if(u&Ur.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(c);else{let d;try{d=ki.Metadata.fromHttp2Headers(c)}catch(h){this.endCall({code:Te.Status.UNKNOWN,details:h.message,metadata:new ki.Metadata});return}this.listener.onReceiveMetadata(d)}}),e.on("trailers",c=>{this.handleTrailers(c)}),e.on("data",c=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+c.length);let u;try{u=this.decoder.write(c)}catch(l){this.cancelWithStatus(Te.Status.RESOURCE_EXHAUSTED,l.message);return}for(let l of u)this.trace("parsed message of length "+l.length),this.callEventTracker.addMessageReceived(),this.tryPush(l)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var c;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((c=this.finalStatus)===null||c===void 0?void 0:c.code)===Te.Status.OK)return;let u,l="";switch(e.rstCode){case Ur.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;u=Te.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`;break;case Ur.constants.NGHTTP2_REFUSED_STREAM:u=Te.Status.UNAVAILABLE,l="Stream refused by server";break;case Ur.constants.NGHTTP2_CANCEL:u=Te.Status.CANCELLED,l="Call cancelled";break;case Ur.constants.NGHTTP2_ENHANCE_YOUR_CALM:u=Te.Status.RESOURCE_EXHAUSTED,l="Bandwidth exhausted or memory limit exceeded";break;case Ur.constants.NGHTTP2_INADEQUATE_SECURITY:u=Te.Status.PERMISSION_DENIED,l="Protocol not secure enough";break;case Ur.constants.NGHTTP2_INTERNAL_ERROR:u=Te.Status.INTERNAL,this.internalError===null?l=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(u=Te.Status.UNAVAILABLE,l=this.internalError.message):l=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:u=Te.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:u,details:l,metadata:new ki.Metadata,rstCode:e.rstCode})})}),e.on("error",c=>{c.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+c.message+" code="+c.code+" errno="+pz(c.errno)+" syscall="+c.syscall),this.internalError=c),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Te.Status.UNAVAILABLE,details:"Connection dropped",metadata:new ki.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){dz.trace(hz.LogVerbosity.DEBUG,fz,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Te.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Te.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let c of Object.keys(e))t+="		"+c+": "+e[c]+`
`;this.trace(`Received server trailers:
`+t);let r;try{r=ki.Metadata.fromHttp2Headers(e)}catch{r=new ki.Metadata}let i=r.getMap(),s=this.mappedStatusCode;if(s===Te.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let c=Number(i["grpc-status"]);c in Te.Status&&(s=c,this.trace("received status code "+c+" from server")),r.remove("grpc-status")}let o="";if(typeof i["grpc-message"]=="string"){try{o=decodeURI(i["grpc-message"])}catch{o=i["grpc-message"]}r.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:r};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Te.Status.OK?t=Ur.constants.NGHTTP2_NO_ERROR:t=Ur.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new ki.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Te.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=i=>{process.nextTick(()=>{var s;let o=Te.Status.UNAVAILABLE;i?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Te.Status.INTERNAL),i&&this.cancelWithStatus(o,`Write error: ${i.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(i){this.endCall({code:Te.Status.UNAVAILABLE,details:`Write failed with error ${i.message}`,metadata:new ki.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};Dh.Http2SubchannelCall=bE});var CE=A(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.getNextCallNumber=void 0;var gz=0;function mz(){return gz++}Ah.getNextCallNumber=mz});var KR=A(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.Http2SubchannelConnector=void 0;var OE=_e("http2"),HR=_e("tls"),IE=Rs(),hu=ve(),yz=TE(),ra=Be(),WR=nr(),Rh=ir(),na=Kt(),vz=_e("net"),Ez=GR(),_z=CE(),DE="transport",Tz="transport_flowctrl",Sz=hy().version,{HTTP2_HEADER_AUTHORITY:wz,HTTP2_HEADER_CONTENT_TYPE:bz,HTTP2_HEADER_METHOD:Cz,HTTP2_HEADER_PATH:Iz,HTTP2_HEADER_TE:Dz,HTTP2_HEADER_USER_AGENT:Az}=OE.constants,Rz=2e4,Oz=Buffer.from("too_many_pings","ascii"),AE=class{constructor(e,t,r,i){this.session=e,this.options=r,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=Rz,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new IE.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Rh.subchannelAddressToString)(t),r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,IE.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${Sz}`,r["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let c=!1;s===OE.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(Oz)&&(c=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(c)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),ra.isTracerEnabled(DE)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let i=this.session.socket,s=i.remoteAddress?(0,Rh.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,o=i.localAddress?(0,Rh.stringToSubchannelAddress)(i.localAddress,i.localPort):null,a;if(this.session.encrypted){let u=i,l=u.getCipher(),d=u.getCertificate(),h=u.getPeerCertificate();a={cipherSuiteStandardName:(e=l.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:l.standardName?null:l.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:h&&"raw"in h?h.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null}}trace(e){ra.trace(hu.LogVerbosity.DEBUG,DE,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){ra.trace(hu.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){ra.trace(hu.LogVerbosity.DEBUG,Tz,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){ra.trace(hu.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((r,i,s)=>{r&&(this.keepaliveTrace("Ping failed with error "+r.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,i,s){let o=e.toHttp2Headers();o[wz]=t,o[Az]=this.userAgent,o[bz]="application/grpc",o[Cz]="POST",o[Iz]=r,o[Dz]="trailers";let a;try{a=this.session.request(o)}catch(l){throw this.handleDisconnect(),l}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let c,u;return this.channelzEnabled?(this.streamTracker.addCallStarted(),c={addMessageSent:()=>{var l;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(l=s.addMessageSent)===null||l===void 0||l.call(s)},addMessageReceived:()=>{var l;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(l=s.addMessageReceived)===null||l===void 0||l.call(s)},onCallEnd:l=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,l),this.removeActiveCall(u)},onStreamEnd:l=>{var d;l?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(d=s.onStreamEnd)===null||d===void 0||d.call(s,l)}}):c={addMessageSent:()=>{var l;(l=s.addMessageSent)===null||l===void 0||l.call(s)},addMessageReceived:()=>{var l;(l=s.addMessageReceived)===null||l===void 0||l.call(s)},onCallEnd:l=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,l),this.removeActiveCall(u)},onStreamEnd:l=>{var d;(d=s.onStreamEnd)===null||d===void 0||d.call(s,l)}},u=new Ez.Http2SubchannelCall(a,c,i,this,(0,_z.getNextCallNumber)()),this.addActiveCall(u),u}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,IE.unregisterChannelzRef)(this.channelzRef)}},RE=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){ra.trace(hu.LogVerbosity.DEBUG,DE,(0,na.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,i){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,c,u;let l;i.realTarget?(l=(0,na.uriToString)(i.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,na.uriToString)(i.realTarget))):(l=null,this.trace("creating HTTP/2 session to "+(0,Rh.subchannelAddressToString)(e)));let d=(0,WR.getDefaultAuthority)((a=i.realTarget)!==null&&a!==void 0?a:this.channelTarget),h=t._getConnectionOptions()||{};h.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?h.maxSessionMemory=r["grpc-node.max_session_memory"]:h.maxSessionMemory=Number.MAX_SAFE_INTEGER;let p="http://";if("secureContext"in h){if(p="https://",r["grpc.ssl_target_name_override"]){let w=r["grpc.ssl_target_name_override"];h.checkServerIdentity=(D,x)=>(0,HR.checkServerIdentity)(w,x),h.servername=w}else{let w=(u=(c=(0,na.splitHostPort)(d))===null||c===void 0?void 0:c.host)!==null&&u!==void 0?u:"localhost";h.servername=w}i.socket&&(h.createConnection=(w,D)=>i.socket)}else h.createConnection=(w,D)=>i.socket?i.socket:vz.connect(e);h=Object.assign(Object.assign(Object.assign({},h),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});let S=OE.connect(p+d,h);this.session=S;let b="Failed to connect";S.unref(),S.once("connect",()=>{S.removeAllListeners(),s(new AE(S,e,r,l)),this.session=null}),S.once("close",()=>{this.session=null,setImmediate(()=>{o(`${b} (${new Date().toISOString()})`)})}),S.once("error",w=>{b=w.message,this.trace("connection failed with error "+b)})})}connect(e,t,r){var i,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let a=r["grpc.ssl_target_name_override"];o.checkServerIdentity=(c,u)=>(0,HR.checkServerIdentity)(a,u),o.servername=a}else if("grpc.http_connect_target"in r){let a=(0,WR.getDefaultAuthority)((i=(0,na.parseUri)(r["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),c=(0,na.splitHostPort)(a);o.servername=(s=c?.host)!==null&&s!==void 0?s:a}r["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,yz.getProxiedConnection)(e,r,o).then(a=>this.createSession(e,t,r,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Oh.Http2SubchannelConnector=RE});var QR=A(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.getSubchannelPool=ia.SubchannelPool=void 0;var Nz=FI(),kz=UR(),Pz=ir(),Mz=Kt(),xz=KR(),Lz=1e4,fu=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let i=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[t]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Lz),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,r,i){this.ensureCleanupTask();let s=(0,Mz.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let c of a)if((0,Pz.subchannelAddressEqual)(t,c.subchannelAddress)&&(0,Nz.channelOptionsEqual)(r,c.channelArguments)&&i._equals(c.channelCredentials))return c.subchannel}let o=new kz.Subchannel(e,t,r,i,new xz.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:r,channelCredentials:i,subchannel:o}),o.ref(),o}};ia.SubchannelPool=fu;var Fz=new fu;function Bz(n){return n?Fz:new fu}ia.getSubchannelPool=Bz});var kE=A(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.FilterStackFactory=sa.FilterStack=void 0;var Nh=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMessage(t);return t}receiveMessage(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};sa.FilterStack=Nh;var NE=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Nh(this.factories.map(e=>e.createFilter()))}};sa.FilterStackFactory=NE});var PE=A(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.CompressionAlgorithms=void 0;var YR=function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n}(YR||(kh.CompressionAlgorithms=YR={}))});var xE=A(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.BaseFilter=void 0;var ME=class{sendMetadata(e){return E(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return E(this,null,function*(){return e})}receiveMessage(e){return E(this,null,function*(){return e})}receiveTrailers(e){return e}};Ph.BaseFilter=ME});var ZR=A(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.CompressionFilterFactory=aa.CompressionFilter=void 0;var Mh=_e("zlib"),XR=PE(),xh=ve(),Uz=xE(),Vz=Be(),qz=n=>typeof n=="number"&&typeof XR.CompressionAlgorithms[n]=="string",oa=class{writeMessage(e,t){return E(this,null,function*(){let r=e;t&&(r=yield this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(t?1:0,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i})}readMessage(e){return E(this,null,function*(){let t=e.readUInt8(0)===1,r=e.slice(5);return t&&(r=yield this.decompressMessage(r)),r})}},Os=class extends oa{compressMessage(e){return E(this,null,function*(){return e})}writeMessage(e,t){return E(this,null,function*(){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},LE=class extends oa{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Mh.deflate(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Mh.createInflate();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:xh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},FE=class extends oa{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Mh.gzip(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Mh.createGunzip();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:xh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},BE=class extends oa{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function JR(n,e){switch(n){case"identity":return new Os;case"deflate":return new LE(e);case"gzip":return new FE(e);default:return new BE(n)}}var Lh=class extends Uz.BaseFilter{constructor(e,t){var r,i;super(),this.sharedFilterConfig=t,this.sendCompression=new Os,this.receiveCompression=new Os,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(r=e["grpc.max_receive_message_length"])!==null&&r!==void 0?r:xh.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(qz(s)){let o=XR.CompressionAlgorithms[s],a=(i=t.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!a||a.includes(o))&&(this.currentCompressionAlgorithm=o,this.sendCompression=JR(this.currentCompressionAlgorithm,-1))}else Vz.log(xh.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}sendMetadata(e){return E(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let i=t[0];typeof i=="string"&&(this.receiveCompression=JR(i,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Os,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return E(this,null,function*(){var t;let r=yield e,i;return this.sendCompression instanceof Os?i=!1:i=(((t=r.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(r.message,i),flags:r.flags}})}receiveMessage(e){return E(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};aa.CompressionFilter=Lh;var UE=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new Lh(this.options,this.sharedFilterConfig)}};aa.CompressionFilterFactory=UE});var Fh=A(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.deadlineToString=pr.getRelativeTimeout=pr.getDeadlineTimeoutString=pr.minDeadline=void 0;function zz(...n){let e=1/0;for(let t of n){let r=t instanceof Date?t.getTime():t;r<e&&(e=r)}return e}pr.minDeadline=zz;var jz=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function $z(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[r,i]of jz){let s=t/i;if(s<1e8)return String(Math.ceil(s))+r}throw new Error("Deadline is too far in the future")}pr.getDeadlineTimeoutString=$z;var Gz=2147483647;function Hz(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),r=e-t;return r<0?0:r>Gz?1/0:r}pr.getRelativeTimeout=Hz;function Wz(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}pr.deadlineToString=Wz});var Uh=A(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.restrictControlPlaneStatusCode=void 0;var gr=ve(),Kz=[gr.Status.OK,gr.Status.INVALID_ARGUMENT,gr.Status.NOT_FOUND,gr.Status.ALREADY_EXISTS,gr.Status.FAILED_PRECONDITION,gr.Status.ABORTED,gr.Status.OUT_OF_RANGE,gr.Status.DATA_LOSS];function Qz(n,e){return Kz.includes(n)?{code:gr.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${gr.Status[n]} ${e}`}:{code:n,details:e}}Bh.restrictControlPlaneStatusCode=Qz});var tO=A(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.LoadBalancingCall=void 0;var eO=cn(),Vh=ve(),Yz=Fh(),qh=Ft(),pu=yi(),Jz=Kt(),Xz=Be(),VE=Uh(),Zz=_e("http2"),e6="load_balancing_call",qE=class{constructor(e,t,r,i,s,o,a){var c,u;this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let l=this.methodName.split("/"),d="";l.length>=2&&(d=l[1]);let h=(u=(c=(0,Jz.splitHostPort)(this.host))===null||c===void 0?void 0:c.host)!==null&&u!==void 0?u:"localhost";this.serviceUrl=`https://${h}/${d}`}trace(e){Xz.trace(Vh.LogVerbosity.DEBUG,e6,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(r=this.listener)===null||r===void 0||r.onReceiveStatus(s),(i=this.onCallEnded)===null||i===void 0||i.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+pu.PickResultType[r.pickResultType]+" subchannel: "+i+" status: "+((e=r.status)===null||e===void 0?void 0:e.code)+" "+((t=r.status)===null||t===void 0?void 0:t.details)),r.pickResultType){case pu.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var c,u,l;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let d=this.metadata.clone();if(d.merge(a),d.get("authorization").length>1&&this.outputStatus({code:Vh.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new qh.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==eO.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+eO.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&d.set("grpc-timeout",(0,Yz.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(d,this.host,this.methodName,{onReceiveMetadata:h=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(h)},onReceiveMessage:h=>{this.trace("Received message"),this.listener.onReceiveMessage(h)},onReceiveStatus:h=>{this.trace("Received status"),h.rstCode===Zz.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(h,"REFUSED"):this.outputStatus(h,"PROCESSED")}})}catch(h){this.trace("Failed to start call on picked subchannel "+i+" with error "+h.message),this.outputStatus({code:Vh.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+h.message,metadata:new qh.Metadata},"NOT_STARTED");return}(u=(c=this.callConfig).onCommitted)===null||u===void 0||u.call(c),(l=r.onCallStarted)===null||l===void 0||l.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:c,details:u}=(0,VE.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:Vh.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:c,details:u,metadata:new qh.Metadata},"PROCESSED")});break;case pu.PickResultType.DROP:let{code:s,details:o}=(0,VE.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:r.status.metadata},"DROP")});break;case pu.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:c}=(0,VE.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:a,details:c,metadata:r.status.metadata},"PROCESSED")})}break;case pu.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new qh.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};zh.LoadBalancingCall=qE});var rO=A($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.ResolvingCall=void 0;var ca=ve(),jh=Fh(),nO=Ft(),t6=Be(),n6=Uh(),r6="resolving_call",zE=class{constructor(e,t,r,i,s,o){this.channel=e,this.method=t,this.filterStackFactory=i,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&ca.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(ca.Status.CANCELLED,"Cancelled by parent call")}),r.flags&ca.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,jh.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){t6.trace(ca.LogVerbosity.DEBUG,r6,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,jh.deadlineToString)(this.deadline));let e=(0,jh.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(ca.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(r=>r(t)),process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(i=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,i.message),this.pendingHalfClose&&r.halfClose()},i=>{this.cancelWithStatus(i.code,i.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==ca.Status.OK){let{code:r,details:i}=(0,n6.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:r,details:i,metadata:new nO.Metadata});return}if(t.methodConfig.timeout){let r=new Date;r.setSeconds(r.getSeconds()+t.methodConfig.timeout.seconds),r.setMilliseconds(r.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,jh.minDeadline)(this.deadline,r),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(r=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(r,{onReceiveMetadata:i=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(i))},onReceiveMessage:i=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(i).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:i=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=i:this.outputStatus(i)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},r=>{this.outputStatus(r)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new nO.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};$h.ResolvingCall=zE});var iO=A(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.RetryingCall=Pi.MessageBufferTracker=Pi.RetryThrottler=void 0;var Gh=ve(),i6=Ft(),s6=Be(),o6="retrying_call",$E=class{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Pi.RetryThrottler=$E;var GE=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;return this.limitPerCall-i<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,i+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(i<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(t,i-e)}freeAll(e){var t;let r=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<r)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}};Pi.MessageBufferTracker=GE;var jE="grpc-previous-rpc-attempts",HE=class{constructor(e,t,r,i,s,o,a,c,u){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=c,this.retryThrottler=u,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let l=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(l.initialBackoff.substring(0,l.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){s6.trace(Gh.LogVerbosity.DEBUG,o6,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new i6.Metadata});for(let{call:r}of this.underlyingCalls)r.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let r=this.getBufferEntry(t);r.allocated&&this.bufferTracker.free(r.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(Gh.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[r,i]of this.underlyingCalls.entries())i.state==="ACTIVE"&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,t=r);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(r=>r===t||r.toString().toLowerCase()===Gh.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,i),r}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},i)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var i,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&i!==void 0?i:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(r===null)a=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(r,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var r;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===Gh.Status.OK){(r=this.retryThrottler)===null||r===void 0||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let s=(e=i.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(r=(t=this.hedgingTimer).unref)===null||r===void 0||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(jE,`${r}`);let s=!1;e.start(i,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,r>0&&o.set(jE,`${r}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&r>0&&o.metadata.set(jE,`${r}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let i=this.underlyingCalls[e],s=i.nextMessageToSend;(r=(t=this.getBufferEntry(s)).callback)===null||r===void 0||r.call(t),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:i=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let i={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(r=e.callback)===null||r===void 0||r.call(e);for(let[a,c]of this.underlyingCalls.entries())c.state==="ACTIVE"&&c.nextMessageToSend===s&&c.call.sendMessageWithContext({callback:u=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Pi.RetryingCall=HE});var Wh=A(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.BaseSubchannelWrapper=void 0;var WE=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};Hh.BaseSubchannelWrapper=WE});var aO=A(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.InternalChannel=void 0;var a6=kd(),c6=LI(),u6=QR(),sO=yi(),gu=ve(),l6=kE(),d6=ZR(),oO=nr(),KE=Be(),h6=TE(),Kh=Kt(),mr=cn(),mu=Rs(),f6=tO(),p6=Fh(),g6=rO(),QE=CE(),m6=Uh(),YE=iO(),y6=Wh(),v6=2147483647,E6=1e3,_6=30*60*1e3,Qh=new Map,T6=1<<24,S6=1<<20,JE=class extends y6.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(r,i,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},XE=class{constructor(e,t,r){var i,s,o,a,c,u,l,d;if(this.credentials=t,this.options=r,this.connectivityState=mr.ConnectivityState.IDLE,this.currentPicker=new sO.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new mu.ChannelzCallTracker,this.childrenTracker=new mu.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof a6.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let h=(0,Kh.parseUri)(e);if(h===null)throw new Error(`Could not parse target name "${e}"`);let p=(0,oO.mapUriDefaultScheme)(h);if(p===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},v6),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new mu.ChannelzTrace,this.channelzRef=(0,mu.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,oO.getDefaultAuthority)(p);let S=(0,h6.mapProxyName)(p,r);this.target=S.target,this.options=Object.assign({},this.options,S.extraOptions),this.subchannelPool=(0,u6.getSubchannelPool)(((o=r["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new YE.MessageBufferTracker((a=r["grpc.retry_buffer_size"])!==null&&a!==void 0?a:T6,(c=r["grpc.per_rpc_retry_buffer_size"])!==null&&c!==void 0?c:S6),this.keepaliveTime=(u=r["grpc.keepalive_time_ms"])!==null&&u!==void 0?u:-1,this.idleTimeoutMs=Math.max((l=r["grpc.client_idle_timeout_ms"])!==null&&l!==void 0?l:_6,E6);let b={createSubchannel:(D,x)=>{let k=this.subchannelPool.getOrCreateSubchannel(this.target,D,Object.assign({},this.options,x),this.credentials);k.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",k.getChannelzRef());let I=new JE(k,this);return this.wrappedSubchannels.add(I),I},updateState:(D,x)=>{this.currentPicker=x;let k=this.pickQueue.slice();this.pickQueue=[],k.length>0&&this.callRefTimerUnref();for(let I of k)I.doPick();this.updateState(D)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:D=>{this.channelzEnabled&&this.childrenTracker.refChild(D)},removeChannelzChild:D=>{this.channelzEnabled&&this.childrenTracker.unrefChild(D)}};this.resolvingLoadBalancer=new c6.ResolvingLoadBalancer(this.target,b,r,(D,x)=>{D.retryThrottling?Qh.set(this.getTarget(),new YE.RetryThrottler(D.retryThrottling.maxTokens,D.retryThrottling.tokenRatio,Qh.get(this.getTarget()))):Qh.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=x,this.currentResolutionError=null,process.nextTick(()=>{let k=this.configSelectionQueue;this.configSelectionQueue=[],k.length>0&&this.callRefTimerUnref();for(let I of k)I.getConfig()})},D=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+D.code+' and details "'+D.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,m6.restrictControlPlaneStatusCode)(D.code,D.details)),{metadata:D.metadata}));let x=this.configSelectionQueue;this.configSelectionQueue=[],x.length>0&&this.callRefTimerUnref();for(let k of x)k.reportResolverError(D)}),this.filterStackFactory=new l6.FilterStackFactory([new d6.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let w=new Error;(0,KE.trace)(gu.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((d=w.stack)===null||d===void 0?void 0:d.substring(w.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,KE.trace)(t??gu.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Kh.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,i;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer).ref)===null||i===void 0||i.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(r=>r===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,KE.trace)(gu.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Kh.uriToString)(this.target)+" "+mr.ConnectivityState[this.connectivityState]+" -> "+mr.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+mr.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let r of t)e!==r.currentState&&(r.timer&&clearTimeout(r.timer),this.removeConnectivityStateWatcher(r),r.callback());e!==mr.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(mr.ConnectivityState.IDLE),this.currentPicker=new sO.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(r=(t=this.idleTimer).unref)===null||r===void 0||r.call(t)}maybeStartIdleTimer(){this.connectivityState!==mr.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===gu.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,i,s){let o=(0,QE.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new f6.LoadBalancingCall(this,e,t,r,i,s,o)}createRetryingCall(e,t,r,i,s){let o=(0,QE.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new YE.RetryingCall(this,e,t,r,i,s,o,this.retryBufferTracker,Qh.get(this.getTarget()))}createInnerCall(e,t,r,i,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,r,i,s):this.createRetryingCall(e,t,r,i,s)}createResolvingCall(e,t,r,i,s){let o=(0,QE.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,p6.deadlineToString)(t));let a={deadline:t,flags:s??gu.Propagate.DEFAULTS,host:r??this.defaultAuthority,parentCall:i},c=new g6.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),c.addStatusWatcher(u=>{this.onCallEnd(u)}),c}close(){this.resolvingLoadBalancer.destroy(),this.updateState(mr.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,mu.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Kh.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===mr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),r(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===mr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,r,i,s)}};Yh.InternalChannel=XE});var tv=A(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.ChannelImplementation=void 0;var w6=kd(),b6=aO(),ZE=class{constructor(e,t,r){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof w6.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new b6.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,i,s)}};Jh.ChannelImplementation=ZE});var mO=A(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.Http2ServerCallStream=gn.ServerDuplexStreamImpl=gn.ServerWritableStreamImpl=gn.ServerReadableStreamImpl=gn.ServerUnaryCallImpl=void 0;var fO=_e("events"),ua=_e("http2"),n_=_e("stream"),cO=_e("zlib"),Re=ve(),r_=Ft(),C6=wE(),pO=Be(),vu=Id(),gO="server_call";function yu(n){pO.trace(Re.LogVerbosity.DEBUG,gO,n)}var I6="grpc-accept-encoding",D6="grpc-encoding",uO="grpc-message",lO="grpc-status",dO="grpc-timeout",A6=/(\d{1,8})\s*([HMSmun])/,R6={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},O6={[I6]:"identity,deflate,gzip",[D6]:"identity"},hO={[ua.constants.HTTP2_HEADER_STATUS]:ua.constants.HTTP_STATUS_OK,[ua.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},N6={waitForTrailers:!0},e_=class extends fO.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};gn.ServerUnaryCallImpl=e_;var Xh=class extends n_.Readable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};gn.ServerReadableStreamImpl=Xh;var Eu=class extends n_.Writable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new r_.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",r);return}}catch(i){this.emit("error",{details:(0,vu.getErrorMessage)(i),code:Re.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:Re.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};gn.ServerWritableStreamImpl=Eu;var la=class extends n_.Duplex{constructor(e,t,r,i,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new r_.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};gn.ServerDuplexStreamImpl=la;la.prototype._read=Xh.prototype._read;la.prototype._write=Eu.prototype._write;la.prototype._final=Eu.prototype._final;var t_=class extends fO.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=Re.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Re.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;yu("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:Re.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if(t==="identity")return r;if(t==="deflate"||t==="gzip"){let i;return t==="deflate"?i=cO.createInflate():i=cO.createGunzip(),new Promise((s,o)=>{let a=0,c=[];i.on("data",u=>{c.push(u),a+=u.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(i.destroy(),o({code:Re.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),i.on("end",()=>{s(Buffer.concat(c))}),i.write(r),i.end()})}else return Promise.reject({code:Re.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},hO),O6),t);this.stream.respond(r,N6)}receiveMetadata(e){let t=r_.Metadata.fromHttp2Headers(e);pO.isTracerEnabled(gO)&&yu("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(dO);if(r.length>0){let i=r[0].toString().match(A6);if(i===null){let a=new Error("Invalid deadline");return a.code=Re.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+i[1]*R6[i[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(k6,s,this),t.remove(dO)}return t.remove(ua.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(ua.constants.HTTP2_HEADER_TE),t.remove(ua.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:i}=this,s=0,o=this,a=[],c=this.maxReceiveMessageSize;this.stream.on("data",u),this.stream.on("end",l),this.stream.on("error",l);function u(d){if(s+=d.byteLength,c!==-1&&s>c){i.removeListener("data",u),i.removeListener("end",l),i.removeListener("error",l),r({code:Re.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${c})`});return}a.push(d)}function l(d){if(i.removeListener("data",u),i.removeListener("end",l),i.removeListener("error",l),d!==void 0){r({code:Re.Status.INTERNAL,details:d.message});return}if(s===0){r({code:Re.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let h=Buffer.concat(a,s),S=h.readUInt8(0)===1?e:"identity",b=o.getDecompressedMessage(h,S);if(Buffer.isBuffer(b)){t(o.deserializeMessageWithInternalError(b));return}b.then(w=>t(o.deserializeMessageWithInternalError(w)),w=>r(w.code?w:{code:Re.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return E(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,vu.getErrorMessage)(t),code:Re.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,r,i){return E(this,null,function*(){if(!this.checkCancelled()){if(r===void 0&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:Re.Status.OK,details:"OK",metadata:r})}catch(s){this.sendError({details:(0,vu.getErrorMessage)(s),code:Re.Status.INTERNAL})}}})}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===Re.Status.OK),!this.checkCancelled())if(yu("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+Re.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var i;let s=Object.assign({[lO]:e.code,[uO]:encodeURI(e.details)},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let i=Object.assign(Object.assign({[lO]:e.code,[uO]:encodeURI(e.details)},hO),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(i,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:Re.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:Re.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new C6.StreamDecoder(this.maxReceiveMessageSize),i=!1,s=!1,o=!1,a=()=>E(this,null,function*(){!o&&i&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",c=>E(this,null,function*(){let u;try{u=r.write(c)}catch(l){this.sendError({code:Re.Status.RESOURCE_EXHAUSTED,details:l.message});return}s=!0,this.stream.pause();for(let l of u){this.emit("receiveMessage");let h=l.readUInt8(0)===1?t:"identity",p;try{p=yield this.getDecompressedMessage(l,h)}catch(S){this.sendError(S);return}if(!p)return;yield this.pushOrBufferMessage(e,p)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>E(this,null,function*(){i=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(t===null||r===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return E(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return E(this,null,function*(){if(t===null){yu("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}yu("Received message of length "+t.length),this.isPushPending=!0;try{let r=yield this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let i=(0,vu.getErrorCode)(r);(i===null||i<Re.Status.OK||i>Re.Status.UNAUTHENTICATED)&&(i=Re.Status.INTERNAL),e.emit("error",{details:(0,vu.getErrorMessage)(r),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};gn.Http2ServerCallStream=t_;function k6(n){let e=new Error("Deadline exceeded");e.code=Re.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var o_=A(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.ServerCredentials=void 0;var yO=Cy(),_u=class{static createInsecure(){return new i_}static createSsl(e,t,r=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof r!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);i.push(a.cert_chain),s.push(a.private_key)}return new s_({ca:e||(0,yO.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:yO.CIPHER_SUITES})}};Zh.ServerCredentials=_u;var i_=class extends _u{_isSecure(){return!1}_getSettings(){return null}},s_=class extends _u{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var _O=A(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.Server=void 0;var Mi=_e("http2"),Vr=ve(),Ns=mO(),P6=o_(),vO=nr(),ef=Be(),Bn=ir(),M6=Kt(),Vt=Rs(),tf=~(1<<31),x6=~(1<<31),L6=2e4,{HTTP2_HEADER_PATH:EO}=Mi.constants,F6="server";function B6(){}function a_(n){return{code:Vr.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function U6(n,e){let t=a_(e);switch(n){case"unary":return(r,i)=>{i(t,null)};case"clientStream":return(r,i)=>{i(t,null)};case"serverStream":return r=>{r.emit("error",t)};case"bidi":return r=>{r.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var c_=class{constructor(e){var t,r,i,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new Vt.ChannelzTrace,this.callTracker=new Vt.ChannelzCallTracker,this.listenerChildrenTracker=new Vt.ChannelzChildrenTracker,this.sessionChildrenTracker=new Vt.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,Vt.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:tf,this.maxConnectionAgeGraceMs=(r=this.options["grpc.max_connection_age_grace_ms"])!==null&&r!==void 0?r:tf,this.keepaliveTimeMs=(i=this.options["grpc.keepalive_time_ms"])!==null&&i!==void 0?i:x6,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:L6,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,i;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,Bn.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,c=o.localAddress?(0,Bn.stringToSubchannelAddress)(o.localAddress,o.localPort):null,u;if(e.encrypted){let d=o,h=d.getCipher(),p=d.getCertificate(),S=d.getPeerCertificate();u={cipherSuiteStandardName:(t=h.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:h.standardName?null:h.name,localCertificate:p&&"raw"in p?p.raw:null,remoteCertificate:S&&"raw"in S?S.raw:null}}else u=null;return{remoteAddress:a,localAddress:c,security:u,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){ef.trace(Vr.LogVerbosity.DEBUG,F6,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let r=Object.keys(e);if(r.length===0)throw new Error("Cannot add an empty service to a server");r.forEach(i=>{let s=e[i],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[i],c;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?c=a.bind(t):c=U6(o,i),this.register(s.path,c,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(r=>{let i=e[r];this.unregister(i.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof P6.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof r!="function")throw new TypeError("callback must be a function");let i=(0,M6.parseUri)(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=(0,vO.mapUriDefaultScheme)(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(p,S)=>{process.nextTick(()=>r(p,S))},c=()=>{let p;if(t._isSecure()){let S=Object.assign(o,t._getSettings());S.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,p=Mi.createSecureServer(S),p.on("secureConnection",b=>{b.on("error",w=>{this.trace("An incoming TLS connection closed with error: "+w.message)})})}else p=Mi.createServer(o);return p.setTimeout(0,B6),this._setupHandlers(p),p},u=(p,S,b)=>p.length===0?Promise.resolve({port:S,count:b}):Promise.all(p.map(w=>{this.trace("Attempting to bind "+(0,Bn.subchannelAddressToString)(w));let D;(0,Bn.isTcpSubchannelAddress)(w)?D={host:w.host,port:S}:D=w;let x=c();return new Promise((k,I)=>{let G=V=>{this.trace("Failed to bind "+(0,Bn.subchannelAddressToString)(w)+" with error "+V.message),k(V)};x.once("error",G),x.listen(D,()=>{if(this.shutdown){x.close(),k(new Error("bindAsync failed because server is shutdown"));return}let V=x.address(),T;typeof V=="string"?T={path:V}:T={host:V.address,port:V.port};let y=(0,Vt.registerChannelzSocket)((0,Bn.subchannelAddressToString)(T),()=>({localAddress:T,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(y),this.http2ServerList.push({server:x,channelzRef:y}),this.trace("Successfully bound "+(0,Bn.subchannelAddressToString)(T)),k("port"in T?T.port:S),x.removeListener("error",G)})})})).then(w=>{let D=0;for(let x of w)if(typeof x=="number"&&(D+=1,x!==S))throw new Error("Invalid state: multiple port numbers added from single address");return{port:S,count:D+b}}),l=p=>{if(p.length===0)return Promise.resolve({port:0,count:0});let S=p[0],b=c();return new Promise((w,D)=>{let x=k=>{this.trace("Failed to bind "+(0,Bn.subchannelAddressToString)(S)+" with error "+k.message),w(l(p.slice(1)))};b.once("error",x),b.listen(S,()=>{if(this.shutdown){b.close(),w({port:0,count:0});return}let k=b.address(),I={host:k.address,port:k.port},G=(0,Vt.registerChannelzSocket)((0,Bn.subchannelAddressToString)(I),()=>({localAddress:I,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(G),this.http2ServerList.push({server:b,channelzRef:G}),this.trace("Successfully bound "+(0,Bn.subchannelAddressToString)(I)),w(u(p.slice(1),k.port,1)),b.removeListener("error",x)})})},d={onSuccessfulResolution:(p,S,b)=>{if(d.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),p.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let w;(0,Bn.isTcpSubchannelAddress)(p[0])?p[0].port===0?w=l(p):w=u(p,p[0].port,0):w=u(p,1,0),w.then(D=>{if(D.count===0){let x=`No address added out of total ${p.length} resolved`;ef.log(Vr.LogVerbosity.ERROR,x),a(new Error(x),0)}else D.count<p.length&&ef.log(Vr.LogVerbosity.INFO,`WARNING Only ${D.count} addresses added out of total ${p.length} resolved`),a(null,D.port)},D=>{let x=`No address added out of total ${p.length} resolved`;ef.log(Vr.LogVerbosity.ERROR,x),a(new Error(x),0)})},onError:p=>{a(new Error(p.details),0)}};(0,vO.createResolver)(s,d,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,Vt.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(Mi.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,Vt.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:r,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,Vt.unregisterChannelzRef)(this.channelzRef),e(s)},r=0;function i(){r--,r===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(r++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,Vt.unregisterChannelzRef)(o)),i()}));this.sessions.forEach((s,o)=>{o.closed||(r+=1,o.close(i))}),r===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[Mi.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof r!="string"||!r.startsWith("application/grpc")?(e.respond({[Mi.constants.HTTP2_HEADER_STATUS]:Mi.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let i=new Ns.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Vr.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),r?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed();return}let i=t[EO],s=this._retrieveHandler(i);if(!s){this._respondWithError(a_(i),e,r);return}let o=new Ns.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Vr.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",a=>{a?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed(),o.sendError({code:Vr.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let r=t[EO],i=this._retrieveHandler(r);if(!i){this._respondWithError(a_(r),e,null);return}let s=new Ns.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(s,i,t)||s.sendError({code:Vr.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,t,r){var i;let s=e.receiveMetadata(r),o=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")V6(e,t,s,o);else if(a==="clientStream")q6(e,t,s,o);else if(a==="serverStream")z6(e,t,s,o);else if(a==="bidi")j6(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),r="null";t&&(typeof t=="string"?r=t:r=t.address+":"+t.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var o,a,c,u,l;if(!this.started){s.destroy();return}let d=(0,Vt.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),h={ref:d,streamTracker:new Vt.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,h);let p=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+p),this.sessionChildrenTracker.refChild(d));let S=null,b=null,w=!1;if(this.maxConnectionAgeMs!==tf){let x=this.maxConnectionAgeMs/10,k=Math.random()*x*2-x;S=(c=(a=setTimeout(()=>{var I,G;w=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+p);try{s.goaway(Mi.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==tf&&(b=(G=(I=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||G===void 0?void 0:G.call(I))},this.maxConnectionAgeMs+k)).unref)===null||c===void 0?void 0:c.call(a)}let D=(l=(u=setInterval(()=>{var x,k;let I=(k=(x=setTimeout(()=>{w=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+p),s.close()},this.keepaliveTimeoutMs)).unref)===null||k===void 0?void 0:k.call(x);try{s.ping((G,V,T)=>{clearTimeout(I)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||l===void 0?void 0:l.call(u);s.on("close",()=>{this.channelzEnabled&&(w||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+p),this.sessionChildrenTracker.unrefChild(d),(0,Vt.unregisterChannelzRef)(d)),S&&clearTimeout(S),b&&clearTimeout(b),D&&clearTimeout(D),this.sessions.delete(s)})})}};nf.Server=c_;function V6(n,e,t,r){return E(this,null,function*(){try{let i=yield n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Ns.ServerUnaryCallImpl(n,t,i);e.func(s,(o,a,c,u)=>{n.sendUnaryMessage(o,a,c,u)})}catch(i){n.sendError(i)}})}function q6(n,e,t,r){let i=new Ns.ServerReadableStreamImpl(n,t,e.deserialize,r);function s(o,a,c,u){i.destroy(),n.sendUnaryMessage(o,a,c,u)}n.cancelled||(i.on("error",s),e.func(i,s))}function z6(n,e,t,r){return E(this,null,function*(){try{let i=yield n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Ns.ServerWritableStreamImpl(n,t,e.serialize,i);e.func(s)}catch(i){n.sendError(i)}})}function j6(n,e,t,r){let i=new Ns.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,r);n.cancelled||e.func(i)}});var TO=A(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.StatusBuilder=void 0;var u_=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};rf.StatusBuilder=u_});var l_=A(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0});xi.isDuration=xi.durationToMs=xi.msToDuration=void 0;function $6(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}xi.msToDuration=$6;function G6(n){return n.seconds*1e3+n.nanos/1e6|0}xi.durationToMs=G6;function H6(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}xi.isDuration=H6});var v_=A(Li=>{"use strict";var d_;Object.defineProperty(Li,"__esModule",{value:!0});Li.setup=Li.OutlierDetectionLoadBalancer=Li.OutlierDetectionLoadBalancingConfig=void 0;var of=cn(),wO=ve(),ks=l_(),bO=E_(),CO=fi(),W6=Ud(),K6=yi(),SO=ir(),Q6=Wh(),Y6=Be(),J6="outlier_detection";function ut(n){Y6.trace(wO.LogVerbosity.DEBUG,J6,n)}var y_="outlier_detection",X6=((d_=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&d_!==void 0?d_:"true")==="true",Z6={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},ej={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function da(n,e,t,r){if(e in n&&typeof n[e]!==t){let i=r?`${r}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${t}, got ${typeof n[e]}`)}}function h_(n,e,t){let r=t?`${t}.${e}`:e;if(e in n){if(!(0,ks.isDuration)(n[e]))throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function sf(n,e,t){let r=t?`${t}.${e}`:e;if(da(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}var Tu=class n{constructor(e,t,r,i,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=r??3e5,this.maxEjectionPercent=i??10,this.successRateEjection=s?Object.assign(Object.assign({},Z6),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},ej),o):null}getLoadBalancerName(){return y_}toJsonObject(){return{interval:(0,ks.msToDuration)(this.intervalMs),base_ejection_time:(0,ks.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,ks.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(h_(e,"interval"),h_(e,"base_ejection_time"),h_(e,"max_ejection_time"),sf(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");da(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),sf(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),da(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),da(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");sf(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),sf(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),da(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),da(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,ks.durationToMs)(e.interval):null,e.base_ejection_time?(0,ks.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,ks.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(CO.validateLoadBalancingConfig))}};Li.OutlierDetectionLoadBalancingConfig=Tu;var p_=class extends Q6.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((r,i,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,i,s,o)})}getConnectivityState(){return this.ejected?of.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,of.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,of.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function f_(){return{success:0,failure:0}}var g_=class{constructor(){this.activeBucket=f_(),this.inactiveBucket=f_()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=f_()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},m_=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===K6.PickResultType.COMPLETE){let r=t.subchannel,i=r.getMapEntry();if(i){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===wO.Status.OK?i.counter.addSuccess():i.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel()})}else return t}},af=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new W6.ChildLoadBalancerHandler((0,bO.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let i=e.createSubchannel(t,r),s=this.addressMap.get((0,SO.subchannelAddressToString)(t)),o=new p_(i,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,r)=>{t===of.ConnectivityState.READY?e.updateState(t,new m_(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;ut("Running success rate check");let r=t.request_volume,i=0,s=[];for(let[d,h]of this.addressMap){let p=h.counter.getLastSuccesses(),S=h.counter.getLastFailures();ut("Stats for "+d+": successes="+p+" failures="+S+" targetRequestVolume="+r),p+S>=r&&(i+=1,s.push(p/(p+S)))}if(ut("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<t.minimum_hosts)return;let o=s.reduce((d,h)=>d+h)/s.length,a=0;for(let d of s){let h=d-o;a+=h*h}let c=a/s.length,u=Math.sqrt(c),l=o-u*(t.stdev_factor/1e3);ut("stdev="+u+" ejectionThreshold="+l);for(let[d,h]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let p=h.counter.getLastSuccesses(),S=h.counter.getLastFailures();if(p+S<r)continue;let b=p/(p+S);if(ut("Checking candidate "+d+" successRate="+b),b<l){let w=Math.random()*100;ut("Candidate "+d+" randomNumber="+w+" enforcement_percentage="+t.enforcement_percentage),w<t.enforcement_percentage&&(ut("Ejecting candidate "+d),this.eject(h,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;ut("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),o=i.counter.getLastFailures();s+o>=t.request_volume&&(r+=1)}if(!(r<t.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(ut("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let u=Math.random()*100;ut("Candidate "+i+" randomNumber="+u+" enforcement_percentage="+t.enforcement_percentage),u<t.enforcement_percentage&&(ut("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let r of e.subchannelWrappers)r.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(r=(t=this.ejectionTimer).unref)===null||r===void 0||r.call(t)}runChecks(){let e=new Date;if(ut("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,r]of this.addressMap.entries())if(r.currentEjectionTimestamp===null)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(r.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(i*r.ejectionTimeMultiplier,Math.max(i,s))),o<new Date&&(ut("Unejecting "+t),this.uneject(r))}}}updateAddressList(e,t,r){if(!(t instanceof Tu))return;let i=new Set;for(let o of e)i.add((0,SO.subchannelAddressToString)(o));for(let o of i)this.addressMap.has(o)||(ut("Adding map entry for "+o),this.addressMap.set(o,{counter:new g_,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())i.has(o)||(ut("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,CO.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){ut("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else ut("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{ut("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return y_}};Li.OutlierDetectionLoadBalancer=af;function tj(){X6&&(0,bO.registerLoadBalancerType)(y_,af,Tu)}Li.setup=tj});var E_=A(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.OutlierDetectionLoadBalancingConfig=Z.BaseSubchannelWrapper=Z.registerAdminService=Z.FilterStackFactory=Z.BaseFilter=Z.PickResultType=Z.QueuePicker=Z.UnavailablePicker=Z.ChildLoadBalancerHandler=Z.subchannelAddressToString=Z.validateLoadBalancingConfig=Z.getFirstUsableConfig=Z.registerLoadBalancerType=Z.createChildChannelControlHelper=Z.BackoffTimeout=Z.durationToMs=Z.uriToString=Z.createResolver=Z.registerResolver=Z.log=Z.trace=void 0;var IO=Be();Object.defineProperty(Z,"trace",{enumerable:!0,get:function(){return IO.trace}});Object.defineProperty(Z,"log",{enumerable:!0,get:function(){return IO.log}});var DO=nr();Object.defineProperty(Z,"registerResolver",{enumerable:!0,get:function(){return DO.registerResolver}});Object.defineProperty(Z,"createResolver",{enumerable:!0,get:function(){return DO.createResolver}});var nj=Kt();Object.defineProperty(Z,"uriToString",{enumerable:!0,get:function(){return nj.uriToString}});var rj=l_();Object.defineProperty(Z,"durationToMs",{enumerable:!0,get:function(){return rj.durationToMs}});var ij=Vc();Object.defineProperty(Z,"BackoffTimeout",{enumerable:!0,get:function(){return ij.BackoffTimeout}});var cf=fi();Object.defineProperty(Z,"createChildChannelControlHelper",{enumerable:!0,get:function(){return cf.createChildChannelControlHelper}});Object.defineProperty(Z,"registerLoadBalancerType",{enumerable:!0,get:function(){return cf.registerLoadBalancerType}});Object.defineProperty(Z,"getFirstUsableConfig",{enumerable:!0,get:function(){return cf.getFirstUsableConfig}});Object.defineProperty(Z,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return cf.validateLoadBalancingConfig}});var sj=ir();Object.defineProperty(Z,"subchannelAddressToString",{enumerable:!0,get:function(){return sj.subchannelAddressToString}});var oj=Ud();Object.defineProperty(Z,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return oj.ChildLoadBalancerHandler}});var __=yi();Object.defineProperty(Z,"UnavailablePicker",{enumerable:!0,get:function(){return __.UnavailablePicker}});Object.defineProperty(Z,"QueuePicker",{enumerable:!0,get:function(){return __.QueuePicker}});Object.defineProperty(Z,"PickResultType",{enumerable:!0,get:function(){return __.PickResultType}});var aj=xE();Object.defineProperty(Z,"BaseFilter",{enumerable:!0,get:function(){return aj.BaseFilter}});var cj=kE();Object.defineProperty(Z,"FilterStackFactory",{enumerable:!0,get:function(){return cj.FilterStackFactory}});var uj=qd();Object.defineProperty(Z,"registerAdminService",{enumerable:!0,get:function(){return uj.registerAdminService}});var lj=Wh();Object.defineProperty(Z,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return lj.BaseSubchannelWrapper}});var dj=v_();Object.defineProperty(Z,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return dj.OutlierDetectionLoadBalancingConfig}})});var AO=A(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.setup=void 0;var hj=nr(),T_=class{constructor(e,t,r){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function fj(){(0,hj.registerResolver)("unix",T_)}uf.setup=fj});var PO=A(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.setup=void 0;var RO=_e("net"),lf=ve(),S_=Ft(),OO=nr(),NO=Kt(),pj=Be(),gj="ip_resolver";function kO(n){pj.trace(lf.LogVerbosity.DEBUG,gj,n)}var w_="ipv4",b_="ipv6",mj=443,df=class{constructor(e,t,r){var i;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,kO("Resolver constructed for target "+(0,NO.uriToString)(e));let s=[];if(!(e.scheme===w_||e.scheme===b_)){this.error={code:lf.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new S_.Metadata};return}let o=e.path.split(",");for(let a of o){let c=(0,NO.splitHostPort)(a);if(c===null){this.error={code:lf.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new S_.Metadata};return}if(e.scheme===w_&&!(0,RO.isIPv4)(c.host)||e.scheme===b_&&!(0,RO.isIPv6)(c.host)){this.error={code:lf.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new S_.Metadata};return}s.push({host:c.host,port:(i=c.port)!==null&&i!==void 0?i:mj})}this.addresses=s,kO("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function yj(){(0,OO.registerResolver)(w_,df),(0,OO.registerResolver)(b_,df)}hf.setup=yj});var LO=A(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.setup=yr.PickFirstLoadBalancer=yr.shuffled=yr.PickFirstLoadBalancingConfig=void 0;var MO=fi(),St=cn(),ff=yi(),vj=Be(),Ej=ve(),_j="pick_first";function C_(n){vj.trace(Ej.LogVerbosity.DEBUG,_j,n)}var Su="pick_first",Tj=250,wu=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Su}toJsonObject(){return{[Su]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};yr.PickFirstLoadBalancingConfig=wu;var I_=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:ff.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function xO(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let r=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[r],e[r]=i}return e}yr.shuffled=xO;var pf=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=St.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.onSubchannelStateUpdate(t,r,i,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(St.ConnectivityState.READY,new I_(this.currentPick)):this.children.length===0?this.updateState(St.ConnectivityState.IDLE,new ff.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(St.ConnectivityState.TRANSIENT_FAILURE,new ff.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(St.ConnectivityState.CONNECTING,new ff.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,i){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){r!==St.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){r===St.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),r===St.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let i=r.subchannel.getConnectivityState();if(i===St.ConnectivityState.IDLE||i===St.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===St.ConnectivityState.IDLE&&(C_("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var i;(i=this.children[e])===null||i===void 0||i.subchannel.startConnecting()})),this.connectionDelayTimeout=(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},Tj)).unref)===null||r===void 0?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(C_("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){C_(St.ConnectivityState[this.currentState]+" -> "+St.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(r=>({subchannel:this.channelControlHelper.createSubchannel(r,{}),hasReportedTransientFailure:!1}));for(let{subchannel:r}of t)r.ref(),this.channelControlHelper.addChannelzChild(r.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:r}of this.children)if(r.addConnectivityStateListener(this.subchannelStateListener),r.getConnectivityState()===St.ConnectivityState.READY){this.pickSubchannel(r);return}for(let r of this.children)r.subchannel.getConnectivityState()===St.ConnectivityState.TRANSIENT_FAILURE&&(r.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof wu&&(t.getShuffleAddressList()&&(e=xO(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===St.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Su}};yr.PickFirstLoadBalancer=pf;function Sj(){(0,MO.registerLoadBalancerType)(Su,pf,wu),(0,MO.registerDefaultLoadBalancerType)(Su)}yr.setup=Sj});var BO=A(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.setup=ha.RoundRobinLoadBalancer=void 0;var wj=fi(),wt=cn(),gf=yi(),bj=ir(),Cj=Be(),Ij=ve(),Dj="round_robin";function FO(n){Cj.trace(Ij.LogVerbosity.DEBUG,Dj,n)}var mf="round_robin",D_=class n{getLoadBalancerName(){return mf}constructor(){}toJsonObject(){return{[mf]:{}}}static createFromJson(e){return new n}},A_=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:gf.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},yf=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=wt.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.calculateAndUpdateState(),(i===wt.ConnectivityState.TRANSIENT_FAILURE||i===wt.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(wt.ConnectivityState.READY)>0){let e=this.subchannels.filter(r=>r.getConnectivityState()===wt.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(wt.ConnectivityState.READY,new A_(e,t))}else this.countSubchannelsWithState(wt.ConnectivityState.CONNECTING)>0?this.updateState(wt.ConnectivityState.CONNECTING,new gf.QueuePicker(this)):this.countSubchannelsWithState(wt.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(wt.ConnectivityState.TRANSIENT_FAILURE,new gf.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(wt.ConnectivityState.IDLE,new gf.QueuePicker(this))}updateState(e,t){FO(wt.ConnectivityState[this.currentState]+" -> "+wt.ConnectivityState[e]),e===wt.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),FO("Connect to address list "+e.map(r=>(0,bj.subchannelAddressToString)(r))),this.subchannels=e.map(r=>this.channelControlHelper.createSubchannel(r,{}));for(let r of this.subchannels){r.ref(),r.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(r.getChannelzRef());let i=r.getConnectivityState();(i===wt.ConnectivityState.IDLE||i===wt.ConnectivityState.TRANSIENT_FAILURE)&&r.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return mf}};ha.RoundRobinLoadBalancer=yf;function Aj(){(0,wj.registerLoadBalancerType)(mf,yf,D_)}ha.setup=Aj});var zO=A(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.experimental=U.addAdminServicesToServer=U.getChannelzHandlers=U.getChannelzServiceDefinition=U.InterceptorConfigurationError=U.InterceptingCall=U.RequesterBuilder=U.ListenerBuilder=U.StatusBuilder=U.getClientChannel=U.ServerCredentials=U.Server=U.setLogVerbosity=U.setLogger=U.load=U.loadObject=U.CallCredentials=U.ChannelCredentials=U.waitForClientReady=U.closeClient=U.Channel=U.makeGenericClientConstructor=U.makeClientConstructor=U.loadPackageDefinition=U.Client=U.compressionAlgorithms=U.propagate=U.connectivityState=U.status=U.logVerbosity=U.Metadata=U.credentials=void 0;var vf=wy();Object.defineProperty(U,"CallCredentials",{enumerable:!0,get:function(){return vf.CallCredentials}});var Rj=tv();Object.defineProperty(U,"Channel",{enumerable:!0,get:function(){return Rj.ChannelImplementation}});var Oj=PE();Object.defineProperty(U,"compressionAlgorithms",{enumerable:!0,get:function(){return Oj.CompressionAlgorithms}});var Nj=cn();Object.defineProperty(U,"connectivityState",{enumerable:!0,get:function(){return Nj.ConnectivityState}});var Ef=kd();Object.defineProperty(U,"ChannelCredentials",{enumerable:!0,get:function(){return Ef.ChannelCredentials}});var UO=ev();Object.defineProperty(U,"Client",{enumerable:!0,get:function(){return UO.Client}});var R_=ve();Object.defineProperty(U,"logVerbosity",{enumerable:!0,get:function(){return R_.LogVerbosity}});Object.defineProperty(U,"status",{enumerable:!0,get:function(){return R_.Status}});Object.defineProperty(U,"propagate",{enumerable:!0,get:function(){return R_.Propagate}});var VO=Be(),O_=rv();Object.defineProperty(U,"loadPackageDefinition",{enumerable:!0,get:function(){return O_.loadPackageDefinition}});Object.defineProperty(U,"makeClientConstructor",{enumerable:!0,get:function(){return O_.makeClientConstructor}});Object.defineProperty(U,"makeGenericClientConstructor",{enumerable:!0,get:function(){return O_.makeClientConstructor}});var kj=Ft();Object.defineProperty(U,"Metadata",{enumerable:!0,get:function(){return kj.Metadata}});var Pj=_O();Object.defineProperty(U,"Server",{enumerable:!0,get:function(){return Pj.Server}});var Mj=o_();Object.defineProperty(U,"ServerCredentials",{enumerable:!0,get:function(){return Mj.ServerCredentials}});var xj=TO();Object.defineProperty(U,"StatusBuilder",{enumerable:!0,get:function(){return xj.StatusBuilder}});U.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),combineCallCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),createInsecure:Ef.ChannelCredentials.createInsecure,createSsl:Ef.ChannelCredentials.createSsl,createFromSecureContext:Ef.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:vf.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:vf.CallCredentials.createFromGoogleCredential,createEmpty:vf.CallCredentials.createEmpty};var Lj=n=>n.close();U.closeClient=Lj;var Fj=(n,e,t)=>n.waitForReady(e,t);U.waitForClientReady=Fj;var Bj=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};U.loadObject=Bj;var Uj=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};U.load=Uj;var Vj=n=>{VO.setLogger(n)};U.setLogger=Vj;var qj=n=>{VO.setLoggerVerbosity(n)};U.setLogVerbosity=qj;var zj=n=>UO.Client.prototype.getChannel.call(n);U.getClientChannel=zj;var _f=Jy();Object.defineProperty(U,"ListenerBuilder",{enumerable:!0,get:function(){return _f.ListenerBuilder}});Object.defineProperty(U,"RequesterBuilder",{enumerable:!0,get:function(){return _f.RequesterBuilder}});Object.defineProperty(U,"InterceptingCall",{enumerable:!0,get:function(){return _f.InterceptingCall}});Object.defineProperty(U,"InterceptorConfigurationError",{enumerable:!0,get:function(){return _f.InterceptorConfigurationError}});var qO=Rs();Object.defineProperty(U,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return qO.getChannelzServiceDefinition}});Object.defineProperty(U,"getChannelzHandlers",{enumerable:!0,get:function(){return qO.getChannelzHandlers}});var jj=qd();Object.defineProperty(U,"addAdminServicesToServer",{enumerable:!0,get:function(){return jj.addAdminServicesToServer}});var $j=E_();U.experimental=$j;var Gj=_E(),Hj=AO(),Wj=PO(),Kj=LO(),Qj=BO(),Yj=v_(),Jj=Rs();Gj.setup(),Hj.setup(),Wj.setup(),Kj.setup(),Qj.setup(),Yj.setup(),Jj.setup()});var je=new X("");var zw=null;function Hn(){return zw}function Hp(n){zw??=n}var $a=class{},Ga=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F(jw),providedIn:"platform"})}return n})(),Wp=new X(""),jw=(()=>{class n extends Ga{_location;_history;_doc=F(je);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Hn().getBaseHref(this._doc)}onPopState(t){let r=Hn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Hn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function rl(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function Vw(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Sn(n){return n&&n[0]!=="?"?`?${n}`:n}var wn=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F(sl),providedIn:"root"})}return n})(),il=new X(""),sl=(()=>{class n extends wn{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??F(je).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return rl(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Sn(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Sn(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Sn(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(Y(Ga),Y(il,8))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yr=(()=>{class n{_subject=new En;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=M1(Vw(qw(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Sn(r))}normalize(t){return n.stripTrailingSlash(P1(this._basePath,qw(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Sn(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Sn(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Sn;static joinWithSlash=rl;static stripTrailingSlash=Vw;static \u0275fac=function(r){return new(r||n)(Y(wn))};static \u0275prov=K({token:n,factory:()=>k1(),providedIn:"root"})}return n})();function k1(){return new Yr(Y(wn))}function P1(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function qw(n){return n.replace(/\/index.html$/,"")}function M1(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var ng=(()=>{class n extends wn{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=rl(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Sn(s))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Sn(s))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(Y(Ga),Y(il,8))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Yw={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},Ya=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(Ya||{});var Et=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(Et||{}),Se=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Se||{}),xt=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(xt||{}),$e={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Jw(n){return Mt(n)[Le.LocaleId]}function Xw(n,e,t){let r=Mt(n),i=[r[Le.DayPeriodsFormat],r[Le.DayPeriodsStandalone]],s=sn(i,e);return sn(s,t)}function Zw(n,e,t){let r=Mt(n),i=[r[Le.DaysFormat],r[Le.DaysStandalone]],s=sn(i,e);return sn(s,t)}function eb(n,e,t){let r=Mt(n),i=[r[Le.MonthsFormat],r[Le.MonthsStandalone]],s=sn(i,e);return sn(s,t)}function tb(n,e){let r=Mt(n)[Le.Eras];return sn(r,e)}function Ha(n,e){let t=Mt(n);return sn(t[Le.DateFormat],e)}function Wa(n,e){let t=Mt(n);return sn(t[Le.TimeFormat],e)}function Ka(n,e){let r=Mt(n)[Le.DateTimeFormat];return sn(r,e)}function zt(n,e){let t=Mt(n),r=t[Le.NumberSymbols][e];if(typeof r>"u"){if(e===$e.CurrencyDecimal)return t[Le.NumberSymbols][$e.Decimal];if(e===$e.CurrencyGroup)return t[Le.NumberSymbols][$e.Group]}return r}function gl(n,e){return Mt(n)[Le.NumberFormats][e]}function x1(n){return Mt(n)[Le.Currencies]}function nb(n){if(!n[Le.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Le.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function rb(n){let e=Mt(n);return nb(e),(e[Le.ExtraData][2]||[]).map(r=>typeof r=="string"?Kp(r):[Kp(r[0]),Kp(r[1])])}function ib(n,e,t){let r=Mt(n);nb(r);let i=[r[Le.ExtraData][0],r[Le.ExtraData][1]],s=sn(i,e)||[];return sn(s,t)||[]}function sn(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Kp(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}function sb(n,e,t="en"){let r=x1(t)[n]||Yw[n]||[],i=r[1];return e==="narrow"&&typeof i=="string"?i:r[0]||n}var L1=2;function ob(n){let e,t=Yw[n];return t&&(e=t[2]),typeof e=="number"?e:L1}var F1=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ol={},B1=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function ab(n,e,t,r){let i=W1(n);e=wr(t,e)||e;let o=[],a;for(;e;)if(a=B1.exec(e),a){o=o.concat(a.slice(1));let l=o.pop();if(!l)break;e=l}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=ub(r,c),i=H1(i,r));let u="";return o.forEach(l=>{let d=$1(l);u+=d?d(i,t,c):l==="''"?"'":l.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function dl(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function wr(n,e){let t=Jw(n);if(ol[t]??={},ol[t][e])return ol[t][e];let r="";switch(e){case"shortDate":r=Ha(n,xt.Short);break;case"mediumDate":r=Ha(n,xt.Medium);break;case"longDate":r=Ha(n,xt.Long);break;case"fullDate":r=Ha(n,xt.Full);break;case"shortTime":r=Wa(n,xt.Short);break;case"mediumTime":r=Wa(n,xt.Medium);break;case"longTime":r=Wa(n,xt.Long);break;case"fullTime":r=Wa(n,xt.Full);break;case"short":let i=wr(n,"shortTime"),s=wr(n,"shortDate");r=al(Ka(n,xt.Short),[i,s]);break;case"medium":let o=wr(n,"mediumTime"),a=wr(n,"mediumDate");r=al(Ka(n,xt.Medium),[o,a]);break;case"long":let c=wr(n,"longTime"),u=wr(n,"longDate");r=al(Ka(n,xt.Long),[c,u]);break;case"full":let l=wr(n,"fullTime"),d=wr(n,"fullDate");r=al(Ka(n,xt.Full),[l,d]);break}return r&&(ol[t][e]=r),r}function al(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function bn(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function U1(n,e){return bn(n,3).substring(0,e)}function Ke(n,e,t=0,r=!1,i=!1){return function(s,o){let a=V1(n,s);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return U1(a,e);let c=zt(o,$e.MinusSign);return bn(a,e,c,r,i)}}function V1(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function Ie(n,e,t=Et.Format,r=!1){return function(i,s){return q1(i,s,n,e,t,r)}}function q1(n,e,t,r,i,s){switch(t){case 2:return eb(e,i,r)[n.getMonth()];case 1:return Zw(e,i,r)[n.getDay()];case 0:let o=n.getHours(),a=n.getMinutes();if(s){let u=rb(e),l=ib(e,i,r),d=u.findIndex(h=>{if(Array.isArray(h)){let[p,S]=h,b=o>=p.hours&&a>=p.minutes,w=o<S.hours||o===S.hours&&a<S.minutes;if(p.hours<S.hours){if(b&&w)return!0}else if(b||w)return!0}else if(h.hours===o&&h.minutes===a)return!0;return!1});if(d!==-1)return l[d]}return Xw(e,i,r)[o<12?0:1];case 3:return tb(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function cl(n){return function(e,t,r){let i=-1*r,s=zt(t,$e.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+bn(o,2,s)+bn(Math.abs(i%60),2,s);case 1:return"GMT"+(i>=0?"+":"")+bn(o,1,s);case 2:return"GMT"+(i>=0?"+":"")+bn(o,2,s)+":"+bn(Math.abs(i%60),2,s);case 3:return r===0?"Z":(i>=0?"+":"")+bn(o,2,s)+":"+bn(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var z1=0,ll=4;function j1(n){let e=dl(n,z1,1).getDay();return dl(n,0,1+(e<=ll?ll:ll+7)-e)}function cb(n){let e=n.getDay(),t=e===0?-3:ll-e;return dl(n.getFullYear(),n.getMonth(),n.getDate()+t)}function Qp(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{let s=cb(t),o=j1(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return bn(i,n,zt(r,$e.MinusSign))}}function ul(n,e=!1){return function(t,r){let s=cb(t).getFullYear();return bn(s,n,zt(r,$e.MinusSign),e)}}var Yp={};function $1(n){if(Yp[n])return Yp[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ie(3,Se.Abbreviated);break;case"GGGG":e=Ie(3,Se.Wide);break;case"GGGGG":e=Ie(3,Se.Narrow);break;case"y":e=Ke(0,1,0,!1,!0);break;case"yy":e=Ke(0,2,0,!0,!0);break;case"yyy":e=Ke(0,3,0,!1,!0);break;case"yyyy":e=Ke(0,4,0,!1,!0);break;case"Y":e=ul(1);break;case"YY":e=ul(2,!0);break;case"YYY":e=ul(3);break;case"YYYY":e=ul(4);break;case"M":case"L":e=Ke(1,1,1);break;case"MM":case"LL":e=Ke(1,2,1);break;case"MMM":e=Ie(2,Se.Abbreviated);break;case"MMMM":e=Ie(2,Se.Wide);break;case"MMMMM":e=Ie(2,Se.Narrow);break;case"LLL":e=Ie(2,Se.Abbreviated,Et.Standalone);break;case"LLLL":e=Ie(2,Se.Wide,Et.Standalone);break;case"LLLLL":e=Ie(2,Se.Narrow,Et.Standalone);break;case"w":e=Qp(1);break;case"ww":e=Qp(2);break;case"W":e=Qp(1,!0);break;case"d":e=Ke(2,1);break;case"dd":e=Ke(2,2);break;case"c":case"cc":e=Ke(7,1);break;case"ccc":e=Ie(1,Se.Abbreviated,Et.Standalone);break;case"cccc":e=Ie(1,Se.Wide,Et.Standalone);break;case"ccccc":e=Ie(1,Se.Narrow,Et.Standalone);break;case"cccccc":e=Ie(1,Se.Short,Et.Standalone);break;case"E":case"EE":case"EEE":e=Ie(1,Se.Abbreviated);break;case"EEEE":e=Ie(1,Se.Wide);break;case"EEEEE":e=Ie(1,Se.Narrow);break;case"EEEEEE":e=Ie(1,Se.Short);break;case"a":case"aa":case"aaa":e=Ie(0,Se.Abbreviated);break;case"aaaa":e=Ie(0,Se.Wide);break;case"aaaaa":e=Ie(0,Se.Narrow);break;case"b":case"bb":case"bbb":e=Ie(0,Se.Abbreviated,Et.Standalone,!0);break;case"bbbb":e=Ie(0,Se.Wide,Et.Standalone,!0);break;case"bbbbb":e=Ie(0,Se.Narrow,Et.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ie(0,Se.Abbreviated,Et.Format,!0);break;case"BBBB":e=Ie(0,Se.Wide,Et.Format,!0);break;case"BBBBB":e=Ie(0,Se.Narrow,Et.Format,!0);break;case"h":e=Ke(3,1,-12);break;case"hh":e=Ke(3,2,-12);break;case"H":e=Ke(3,1);break;case"HH":e=Ke(3,2);break;case"m":e=Ke(4,1);break;case"mm":e=Ke(4,2);break;case"s":e=Ke(5,1);break;case"ss":e=Ke(5,2);break;case"S":e=Ke(6,1);break;case"SS":e=Ke(6,2);break;case"SSS":e=Ke(6,3);break;case"Z":case"ZZ":case"ZZZ":e=cl(0);break;case"ZZZZZ":e=cl(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=cl(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=cl(2);break;default:return null}return Yp[n]=e,e}function ub(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function G1(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function H1(n,e,t){let i=n.getTimezoneOffset(),s=ub(e,i);return G1(n,-1*(s-i))}function W1(n){if($w(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return dl(i,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(F1))return K1(r)}let e=new Date(n);if(!$w(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function K1(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,u),e}function $w(n){return n instanceof Date&&!isNaN(n.valueOf())}var Q1=/^(\d+)?\.((\d+)(-(\d+))?)?$/,Gw=22,hl=".",Qa="0",Y1=";",J1=",",Jp="#",Hw="\xA4",X1="%";function rg(n,e,t,r,i,s,o=!1){let a="",c=!1;if(!isFinite(n))a=zt(t,$e.Infinity);else{let u=eP(n);o&&(u=Z1(u));let l=e.minInt,d=e.minFrac,h=e.maxFrac;if(s){let x=s.match(Q1);if(x===null)throw new Error(`${s} is not a valid digit info`);let k=x[1],I=x[3],G=x[5];k!=null&&(l=Xp(k)),I!=null&&(d=Xp(I)),G!=null?h=Xp(G):I!=null&&d>h&&(h=d)}tP(u,d,h);let p=u.digits,S=u.integerLen,b=u.exponent,w=[];for(c=p.every(x=>!x);S<l;S++)p.unshift(0);for(;S<0;S++)p.unshift(0);S>0?w=p.splice(S,p.length):(w=p,p=[0]);let D=[];for(p.length>=e.lgSize&&D.unshift(p.splice(-e.lgSize,p.length).join(""));p.length>e.gSize;)D.unshift(p.splice(-e.gSize,p.length).join(""));p.length&&D.unshift(p.join("")),a=D.join(zt(t,r)),w.length&&(a+=zt(t,i)+w.join("")),b&&(a+=zt(t,$e.Exponential)+"+"+b)}return n<0&&!c?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function lb(n,e,t,r,i){let s=gl(e,Ya.Currency),o=ig(s,zt(e,$e.MinusSign));return o.minFrac=ob(r),o.maxFrac=o.minFrac,rg(n,o,e,$e.CurrencyGroup,$e.CurrencyDecimal,i).replace(Hw,t).replace(Hw,"").trim()}function db(n,e,t){let r=gl(e,Ya.Percent),i=ig(r,zt(e,$e.MinusSign));return rg(n,i,e,$e.Group,$e.Decimal,t,!0).replace(new RegExp(X1,"g"),zt(e,$e.PercentSign))}function hb(n,e,t){let r=gl(e,Ya.Decimal),i=ig(r,zt(e,$e.MinusSign));return rg(n,i,e,$e.Group,$e.Decimal,t)}function ig(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(Y1),i=r[0],s=r[1],o=i.indexOf(hl)!==-1?i.split(hl):[i.substring(0,i.lastIndexOf(Qa)+1),i.substring(i.lastIndexOf(Qa)+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf(Jp));for(let l=0;l<c.length;l++){let d=c.charAt(l);d===Qa?t.minFrac=t.maxFrac=l+1:d===Jp?t.maxFrac=l+1:t.posSuf+=d}let u=a.split(J1);if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){let l=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf(Jp);t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+l).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function Z1(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function eP(n){let e=Math.abs(n)+"",t=0,r,i,s,o,a;for((i=e.indexOf(hl))>-1&&(e=e.replace(hl,"")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;e.charAt(s)===Qa;s++);if(s===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===Qa;)a--;for(i-=s,r=[],o=0;s<=a;s++,o++)r[o]=Number(e.charAt(s))}return i>Gw&&(r=r.splice(0,Gw-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function tP(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,s=Math.min(Math.max(e,i),t),o=s+n.integerLen,a=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let d=o;d<r.length;d++)r[d]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let d=1;d<o;d++)r[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let c=s!==0,u=e+n.integerLen,l=r.reduceRight(function(d,h,p,S){return h=h+d,S[p]=h<10?h:h-10,c&&(S[p]===0&&p>=u?S.pop():c=!1),h>=10?1:0},0);l&&(r.unshift(l),n.integerLen++)}function Xp(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}var Zp=/\s+/,Ww=[],nP=(()=>{class n{_ngEl;_renderer;initialClasses=Ww;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Zp):Ww}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Zp):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Zp).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(Ce(Zs),Ce(to))};static \u0275dir=Gn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var fl=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},fb=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new fl(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),Kw(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);Kw(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Ce(no),Ce(zp),Ce(xw))};static \u0275dir=Gn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function Kw(n,e){n.context.$implicit=e.item}var rP=(()=>{class n{_viewContainer;_context=new pl;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Qw(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Qw(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Ce(no),Ce(zp))};static \u0275dir=Gn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),pl=class{$implicit=null;ngIf=null};function Qw(n,e){if(n&&!n.createEmbeddedView)throw new oe(2020,!1)}var iP=(()=>{class n{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(t,r,i){this._ngEl=t,this._differs=r,this._renderer=i}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){let t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,r){let[i,s]=t.split("."),o=i.indexOf("-")===-1?void 0:Zi.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,i,s?`${r}${s}`:r,o):this._renderer.removeStyle(this._ngEl.nativeElement,i,o)}_applyChanges(t){t.forEachRemovedItem(r=>this._setStyle(r.key,null)),t.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),t.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static \u0275fac=function(r){return new(r||n)(Ce(Zs),Ce(Lw),Ce(to))};static \u0275dir=Gn({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return n})(),sP=(()=>{class n{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){let r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let i=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,i,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,r,i)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,r,i):!1,get:(t,r,i)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,i)}})}static \u0275fac=function(r){return new(r||n)(Ce(no))};static \u0275dir=Gn({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[Js]})}return n})();function ts(n,e){return new oe(2100,!1)}var eg=class{createSubscription(e,t){return nl(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){nl(()=>e.unsubscribe())}},tg=class{createSubscription(e,t){return e.then(r=>t?.(r),r=>{throw r}),{unsubscribe:()=>{t=null}}}dispose(e){e.unsubscribe()}},oP=new tg,aP=new eg,cP=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(el(t))return oP;if(Dw(t))return aP;throw ts(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(r){return new(r||n)(Ce(ro,16))};static \u0275pipe=Qr({name:"async",type:n,pure:!1})}return n})();var uP=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,lP=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw ts(n,t);return t.replace(uP,r=>r[0].toUpperCase()+r.slice(1).toLowerCase())}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=Qr({name:"titlecase",type:n,pure:!0})}return n})(),dP=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw ts(n,t);return t.toUpperCase()}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=Qr({name:"uppercase",type:n,pure:!0})}return n})(),hP="mediumDate",pb=new X(""),gb=new X(""),fP=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let o=r??this.defaultOptions?.dateFormat??hP,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return ab(t,o,s||this.locale,a)}catch(o){throw ts(n,o.message)}}static \u0275fac=function(r){return new(r||n)(Ce(za,16),Ce(pb,24),Ce(gb,24))};static \u0275pipe=Qr({name:"date",type:n,pure:!0})}return n})();var pP=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!sg(t))return null;i||=this._locale;try{let s=og(t);return hb(s,i,r)}catch(s){throw ts(n,s.message)}}static \u0275fac=function(r){return new(r||n)(Ce(za,16))};static \u0275pipe=Qr({name:"number",type:n,pure:!0})}return n})(),gP=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!sg(t))return null;i||=this._locale;try{let s=og(t);return db(s,i,r)}catch(s){throw ts(n,s.message)}}static \u0275fac=function(r){return new(r||n)(Ce(za,16))};static \u0275pipe=Qr({name:"percent",type:n,pure:!0})}return n})(),mP=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,r="USD"){this._locale=t,this._defaultCurrencyCode=r}transform(t,r=this._defaultCurrencyCode,i="symbol",s,o){if(!sg(t))return null;o||=this._locale,typeof i=="boolean"&&(i=i?"symbol":"code");let a=r||this._defaultCurrencyCode;i!=="code"&&(i==="symbol"||i==="symbol-narrow"?a=sb(a,i==="symbol"?"wide":"narrow",o):a=i);try{let c=og(t);return lb(c,o,a,r,s)}catch(c){throw ts(n,c.message)}}static \u0275fac=function(r){return new(r||n)(Ce(za,16),Ce(Mw,16))};static \u0275pipe=Qr({name:"currency",type:n,pure:!0})}return n})();function sg(n){return!(n==null||n===""||n!==n)}function og(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var mb=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=es({type:n});static \u0275inj=Yi({})}return n})();function Ja(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var ml="browser",yb="server";function yP(n){return n===ml}function yl(n){return n===yb}var ns=class{};function c7(n,e,t){return Ow(n,e,t)}var Eb=(()=>{class n{static \u0275prov=K({token:n,providedIn:"root",factory:()=>new ag})}return n})();var ag=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}};var ec=new X(""),dg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new oe(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(Y(ec),Y(ze))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),io=class{_doc;constructor(e){this._doc=e}manager},vl="ng-app-id";function _b(n){for(let e of n)e.remove()}function Tb(n,e){let t=e.createElement("style");return t.textContent=n,t}function EP(n,e,t,r){let i=n.head?.querySelectorAll(`style[${vl}="${e}"],link[${vl}="${e}"]`);if(i)for(let s of i)s.removeAttribute(vl),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function ug(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var hg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=yl(s),EP(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,Tb);r?.forEach(i=>this.addUsage(i,this.external,ug))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(_b(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])_b(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,Tb(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,ug(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(vl,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(Y(je),Y(Vp),Y(qp,8),Y(Kr))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),cg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},fg=/%COMP%/g;var wb="%COMP%",_P=`_nghost-${wb}`,TP=`_ngcontent-${wb}`,SP=!0,wP=new X("",{providedIn:"root",factory:()=>SP});function bP(n){return TP.replace(fg,n)}function CP(n){return _P.replace(fg,n)}function bb(n,e){return e.map(t=>t.replace(fg,n))}var pg=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c,u=null,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=u,this.tracingService=l,this.platformIsServer=yl(a),this.defaultRenderer=new Xa(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ua.ShadowDom&&(r=it($({},r),{encapsulation:Ua.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof El?i.applyToHost(t):i instanceof Za&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,l=this.removeStylesOnCompDestroy,d=this.platformIsServer,h=this.tracingService;switch(r.encapsulation){case Ua.Emulated:s=new El(c,u,r,this.appId,l,o,a,d,h);break;case Ua.ShadowDom:return new lg(c,u,t,r,o,a,this.nonce,d,h);default:s=new Za(c,u,r,l,o,a,d,h);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(Y(dg),Y(hg),Y(Vp),Y(wP),Y(je),Y(Kr),Y(ze),Y(qp),Y(fw,8))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Xa=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(cg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Sb(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Sb(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new oe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=cg[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=cg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Zi.DashCase|Zi.Important)?e.style.setProperty(t,r,i&Zi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Zi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Hn().getGlobalEventTarget(this.doc,e),!e))throw new oe(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Sb(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var lg=class extends Xa{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,a,c,u){super(e,s,o,c,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=i.styles;l=bb(i.id,l);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let h of d){let p=ug(h,s);a&&p.setAttribute("nonce",a),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Za=class extends Xa{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,u){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let l=r.styles;this.styles=u?bb(u,l):l,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},El=class extends Za{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,u){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,u,l),this.contentAttr=bP(l),this.hostAttr=CP(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var _l=class n extends $a{supportsDOMEvents=!0;static makeCurrent(){Hp(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=DP();return t==null?null:AP(t)}resetBaseElement(){tc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ja(document.cookie,e)}},tc=null;function DP(){return tc=tc||document.head.querySelector("base"),tc?tc.getAttribute("href"):null}function AP(n){return new URL(n,document.baseURI).pathname}var RP=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Ib=(()=>{class n extends io{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(Y(je))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Cb=["alt","control","meta","shift"],OP={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},NP={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Db=(()=>{class n extends io{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Hn().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),Cb.forEach(u=>{let l=r.indexOf(u);l>-1&&(r.splice(l,1),o+=u+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=OP[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Cb.forEach(o=>{if(o!==i){let a=NP[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(Y(je))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function kP(n,e){return Fw($({rootComponent:n},PP(e)))}function PP(n){return{appProviders:[...BP,...n?.providers??[]],platformProviders:FP}}function MP(){_l.makeCurrent()}function xP(){return new Up}function LP(){return lw(document),document}var FP=[{provide:Kr,useValue:ml},{provide:dw,useValue:MP,multi:!0},{provide:je,useFactory:LP}];var BP=[{provide:cw,useValue:"root"},{provide:Up,useFactory:xP},{provide:ec,useClass:Ib,multi:!0,deps:[je]},{provide:ec,useClass:Db,multi:!0,deps:[je]},pg,hg,dg,{provide:ww,useExisting:pg},{provide:ns,useClass:RP},[]];var oo=class{},ao=class{},Cn=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var wl=class{encodeKey(e){return Ab(e)}encodeValue(e){return Ab(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function UP(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var VP=/%(\d[a-f0-9])/gi,qP={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ab(n){return encodeURIComponent(n).replace(VP,(e,t)=>qP[t]??e)}function Tl(n){return`${n}`}var Cr=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new wl,e.fromString){if(e.fromObject)throw new oe(2805,!1);this.map=UP(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(Tl):[Tl(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Tl(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Tl(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var bl=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function zP(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Rb(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Ob(n){return typeof Blob<"u"&&n instanceof Blob}function Nb(n){return typeof FormData<"u"&&n instanceof FormData}function jP(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var nc="Content-Type",Cl="Accept",Eg="X-Request-URL",Pb="text/plain",Mb="application/json",xb=`${Mb}, ${Pb}, */*`,so=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(zP(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Cn,this.context??=new bl,!this.params)this.params=new Cr,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Rb(this.body)||Ob(this.body)||Nb(this.body)||jP(this.body)?this.body:this.body instanceof Cr?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Nb(this.body)?null:Ob(this.body)?this.body.type||null:Rb(this.body)?null:typeof this.body=="string"?Pb:this.body instanceof Cr?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Mb:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,u=e.headers||this.headers,l=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(u=Object.keys(e.setHeaders).reduce((h,p)=>h.set(p,e.setHeaders[p]),u)),e.setParams&&(l=Object.keys(e.setParams).reduce((h,p)=>h.set(p,e.setParams[p]),l)),new n(t,r,o,{params:l,headers:u,context:d,reportProgress:c,responseType:i,withCredentials:a,transferCache:s})}},Ir=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Ir||{}),co=class{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new Cn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},rc=class n extends co{constructor(e={}){super(e)}type=Ir.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Jr=class n extends co{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Ir.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},br=class extends co{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Lb=200,$P=204;function gg(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var Fb=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof so)s=t;else{let c;i.headers instanceof Cn?c=i.headers:c=new Cn(i.headers);let u;i.params&&(i.params instanceof Cr?u=i.params:u=new Cr({fromObject:i.params})),s=new so(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:u,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let o=W(s).pipe(Sr(c=>this.handler.handle(c)));if(t instanceof so||i.observe==="events")return o;let a=o.pipe(Tn(c=>c instanceof Jr));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(he(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new oe(2806,!1);return c.body}));case"blob":return a.pipe(he(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new oe(2807,!1);return c.body}));case"text":return a.pipe(he(c=>{if(c.body!==null&&typeof c.body!="string")throw new oe(2808,!1);return c.body}));case"json":default:return a.pipe(he(c=>c.body))}case"response":return a;default:throw new oe(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Cr().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,gg(i,r))}post(t,r,i={}){return this.request("POST",t,gg(i,r))}put(t,r,i={}){return this.request("PUT",t,gg(i,r))}static \u0275fac=function(r){return new(r||n)(Y(oo))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),GP=/^\)\]\}',?\n/;function kb(n){if(n.url)return n.url;let e=Eg.toLocaleLowerCase();return n.headers.get(e)}var Bb=new X(""),Sl=(()=>{class n{fetchImpl=F(mg,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t));ngZone=F(ze);destroyRef=F(Fa);destroyed=!1;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed=!0})}handle(t){return new nn(r=>{let i=new AbortController;return this.doRequest(t,i.signal,r).then(yg,s=>r.error(new br({error:s}))),()=>i.abort()})}doRequest(t,r,i){return E(this,null,function*(){let s=this.createRequestInit(t),o;try{let p=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,$({signal:r},s)));HP(p),i.next({type:Ir.Sent}),o=yield p}catch(p){i.error(new br({error:p,status:p.status??0,statusText:p.statusText,url:t.urlWithParams,headers:p.headers}));return}let a=new Cn(o.headers),c=o.statusText,u=kb(o)??t.urlWithParams,l=o.status,d=null;if(t.reportProgress&&i.next(new rc({headers:a,status:l,statusText:c,url:u})),o.body){let p=o.headers.get("content-length"),S=[],b=o.body.getReader(),w=0,D,x,k=typeof Zone<"u"&&Zone.current,I=!1;if(yield this.ngZone.runOutsideAngular(()=>E(this,null,function*(){for(;;){if(this.destroyed){yield b.cancel(),I=!0;break}let{done:V,value:T}=yield b.read();if(V)break;if(S.push(T),w+=T.length,t.reportProgress){x=t.responseType==="text"?(x??"")+(D??=new TextDecoder).decode(T,{stream:!0}):void 0;let y=()=>i.next({type:Ir.DownloadProgress,total:p?+p:void 0,loaded:w,partialText:x});k?k.run(y):y()}}})),I){i.complete();return}let G=this.concatChunks(S,w);try{let V=o.headers.get(nc)??"";d=this.parseBody(t,G,V)}catch(V){i.error(new br({error:V,headers:new Cn(o.headers),status:o.status,statusText:o.statusText,url:kb(o)??t.urlWithParams}));return}}l===0&&(l=d?Lb:0),l>=200&&l<300?(i.next(new Jr({body:d,headers:a,status:l,statusText:c,url:u})),i.complete()):i.error(new br({error:d,headers:a,status:l,statusText:c,url:u}))})}parseBody(t,r,i){switch(t.responseType){case"json":let s=new TextDecoder().decode(r).replace(GP,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:i});case"arraybuffer":return r.buffer}}createRequestInit(t){let r={},i=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>r[s]=o.join(",")),t.headers.has(Cl)||(r[Cl]=xb),!t.headers.has(nc)){let s=t.detectContentTypeHeader();s!==null&&(r[nc]=s)}return{body:t.serializeBody(),method:t.method,headers:r,credentials:i}}concatChunks(t,r){let i=new Uint8Array(r),s=0;for(let o of t)i.set(o,s),s+=o.length;return i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),mg=class{};function yg(){}function HP(n){n.then(yg,yg)}function WP(n,e){return e(n)}function KP(n,e,t){return(r,i)=>vt(t,()=>e(r,s=>n(s,i)))}var Ub=new X(""),_g=new X(""),Vb=new X("",{providedIn:"root",factory:()=>!0});var Il=(()=>{class n extends oo{backend;injector;chain=null;pendingTasks=F(Ju);contributeToStability=F(Vb);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Ub),...this.injector.get(_g,[])]));this.chain=r.reduceRight((i,s)=>KP(i,s,this.injector),WP)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Ys(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(Y(ao),Y($n))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();var QP=/^\)\]\}',?\n/,YP=RegExp(`^${Eg}:`,"m");function JP(n){return"responseURL"in n&&n.responseURL?n.responseURL:YP.test(n.getAllResponseHeaders())?n.getResponseHeader(Eg):null}var vg=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new oe(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?We(r.\u0275loadImpl()):W(null)).pipe(yt(()=>new nn(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((b,w)=>o.setRequestHeader(b,w.join(","))),t.headers.has(Cl)||o.setRequestHeader(Cl,xb),!t.headers.has(nc)){let b=t.detectContentTypeHeader();b!==null&&o.setRequestHeader(nc,b)}if(t.responseType){let b=t.responseType.toLowerCase();o.responseType=b!=="json"?b:"text"}let a=t.serializeBody(),c=null,u=()=>{if(c!==null)return c;let b=o.statusText||"OK",w=new Cn(o.getAllResponseHeaders()),D=JP(o)||t.url;return c=new rc({headers:w,status:o.status,statusText:b,url:D}),c},l=()=>{let{headers:b,status:w,statusText:D,url:x}=u(),k=null;w!==$P&&(k=typeof o.response>"u"?o.responseText:o.response),w===0&&(w=k?Lb:0);let I=w>=200&&w<300;if(t.responseType==="json"&&typeof k=="string"){let G=k;k=k.replace(QP,"");try{k=k!==""?JSON.parse(k):null}catch(V){k=G,I&&(I=!1,k={error:V,text:k})}}I?(s.next(new Jr({body:k,headers:b,status:w,statusText:D,url:x||void 0})),s.complete()):s.error(new br({error:k,headers:b,status:w,statusText:D,url:x||void 0}))},d=b=>{let{url:w}=u(),D=new br({error:b,status:o.status||0,statusText:o.statusText||"Unknown Error",url:w||void 0});s.error(D)},h=!1,p=b=>{h||(s.next(u()),h=!0);let w={type:Ir.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(w.total=b.total),t.responseType==="text"&&o.responseText&&(w.partialText=o.responseText),s.next(w)},S=b=>{let w={type:Ir.UploadProgress,loaded:b.loaded};b.lengthComputable&&(w.total=b.total),s.next(w)};return o.addEventListener("load",l),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",p),a!==null&&o.upload&&o.upload.addEventListener("progress",S)),o.send(a),s.next({type:Ir.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",l),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",p),a!==null&&o.upload&&o.upload.removeEventListener("progress",S)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(Y(ns))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),qb=new X(""),XP="XSRF-TOKEN",ZP=new X("",{providedIn:"root",factory:()=>XP}),eM="X-XSRF-TOKEN",tM=new X("",{providedIn:"root",factory:()=>eM}),ic=class{},nM=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r){this.doc=t,this.cookieName=r}getToken(){return null}static \u0275fac=function(r){return new(r||n)(Y(je),Y(ZP))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function rM(n,e){let t=n.url.toLowerCase();if(!F(qb)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=F(ic).getToken(),i=F(tM);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var Tg=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Tg||{});function iM(n,e){return{\u0275kind:n,\u0275providers:e}}function sM(...n){let e=[Fb,vg,Il,{provide:oo,useExisting:Il},{provide:ao,useFactory:()=>F(Bb,{optional:!0})??F(vg)},{provide:Ub,useValue:rM,multi:!0},{provide:qb,useValue:!0},{provide:ic,useClass:nM}];for(let t of n)e.push(...t.\u0275providers);return rn(e)}function oM(){return iM(Tg.Fetch,[Sl,{provide:Bb,useExisting:Sl},{provide:ao,useExisting:Sl}])}var uM=new X(""),zb="b",jb="h",$b="s",Gb="st",Hb="u",Wb="rt",Sg=new X(""),lM=["GET","HEAD"];function dM(n,e){let h=F(Sg),{isCacheActive:t}=h,r=JS(h,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||i===!1||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!lM.includes(s)||!r.includeRequestsWithAuthHeaders&&hM(n)||r.filter?.(n)===!1)return e(n);let o=F(hw),a=F(uM,{optional:!0}),c=a?mM(n.url,a):n.url,u=pM(n,c),l=o.get(u,null),d=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(d=i.includeHeaders),l){let{[zb]:p,[Wb]:S,[jb]:b,[$b]:w,[Gb]:D,[Hb]:x}=l,k=p;switch(S){case"arraybuffer":k=new TextEncoder().encode(p).buffer;break;case"blob":k=new Blob([p]);break}let I=new Cn(b);return W(new Jr({body:k,headers:I,status:w,statusText:D,url:x}))}return e(n).pipe(st(p=>{p instanceof Jr&&o.set(u,{[zb]:p.body,[jb]:fM(p.headers,d),[$b]:p.status,[Gb]:p.statusText,[Hb]:c,[Wb]:n.responseType})}))}function hM(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function fM(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function Kb(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function pM(n,e){let{params:t,method:r,responseType:i}=n,s=Kb(t),o=n.serializeBody();o instanceof URLSearchParams?o=Kb(o):typeof o!="string"&&(o="");let a=[r,i,e,o,s].join("|"),c=gM(a);return c}function gM(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function Qb(n){return[{provide:Sg,useFactory:()=>(Ba("NgHttpTransferCache"),$({isCacheActive:!0},n))},{provide:_g,useValue:dM,multi:!0},{provide:Va,multi:!0,useFactory:()=>{let e=F(qa),t=F(Sg);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}function mM(n,e){let t=new URL(n,"resolve://").origin,r=e[t];return r?n.replace(t,r):n}var VK=(()=>{class n{_doc;_dom;constructor(t){this._doc=t,this._dom=Hn()}addTag(t,r=!1){return t?this._getOrCreateElement(t,r):null}addTags(t,r=!1){return t?t.reduce((i,s)=>(s&&i.push(this._getOrCreateElement(s,r)),i),[]):[]}getTag(t){return t&&this._doc.querySelector(`meta[${t}]`)||null}getTags(t){if(!t)return[];let r=this._doc.querySelectorAll(`meta[${t}]`);return r?[].slice.call(r):[]}updateTag(t,r){if(!t)return null;r=r||this._parseSelector(t);let i=this.getTag(r);return i?this._setMetaElementAttributes(t,i):this._getOrCreateElement(t,!0)}removeTag(t){this.removeTagElement(this.getTag(t))}removeTagElement(t){t&&this._dom.remove(t)}_getOrCreateElement(t,r=!1){if(!r){let o=this._parseSelector(t),a=this.getTags(o).filter(c=>this._containsAttributes(t,c))[0];if(a!==void 0)return a}let i=this._dom.createElement("meta");return this._setMetaElementAttributes(t,i),this._doc.getElementsByTagName("head")[0].appendChild(i),i}_setMetaElementAttributes(t,r){return Object.keys(t).forEach(i=>r.setAttribute(this._getMetaKeyMap(i),t[i])),r}_parseSelector(t){let r=t.name?"name":"property";return`${r}="${t[r]}"`}_containsAttributes(t,r){return Object.keys(t).every(i=>r.getAttribute(this._getMetaKeyMap(i))===t[i])}_getMetaKeyMap(t){return vM[t]||t}static \u0275fac=function(r){return new(r||n)(Y(je))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vM={httpEquiv:"http-equiv"},Yb=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(Y(je))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var EM=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=Y(_M),i},providedIn:"root"})}return n})(),_M=(()=>{class n extends EM{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case Xi.NONE:return r;case Xi.HTML:return eo(r,"HTML")?Ji(r):Tw(this._doc,String(r)).toString();case Xi.STYLE:return eo(r,"Style")?Ji(r):r;case Xi.SCRIPT:if(eo(r,"Script"))return Ji(r);throw new oe(5200,!1);case Xi.URL:return eo(r,"URL")?Ji(r):_w(String(r));case Xi.RESOURCE_URL:if(eo(r,"ResourceURL"))return Ji(r);throw new oe(5201,!1);default:throw new oe(5202,!1)}}bypassSecurityTrustHtml(t){return gw(t)}bypassSecurityTrustStyle(t){return mw(t)}bypassSecurityTrustScript(t){return yw(t)}bypassSecurityTrustUrl(t){return vw(t)}bypassSecurityTrustResourceUrl(t){return Ew(t)}static \u0275fac=function(r){return new(r||n)(Y(je))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wg=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n}(wg||{});function qK(...n){let e=[],t=new Set;for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);let r=t.has(wg.HttpTransferCacheOptions);return rn([[],Bw(),t.has(wg.NoHttpTransferCache)||r?[]:Qb({}),e])}var re="primary",yc=Symbol("RouteTitle"),Ag=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ss(n){return new Ag(n)}function i0(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function SM(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Kn(n[t],e[t]))return!1;return!0}function Kn(n,e){let t=n?Rg(n):void 0,r=e?Rg(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!s0(n[i],e[i]))return!1;return!0}function Rg(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function s0(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function o0(n){return n.length>0?n[n.length-1]:null}function ni(n){return nw(n)?n:el(n)?We(Promise.resolve(n)):W(n)}var wM={exact:c0,subset:u0},a0={exact:bM,subset:CM,ignored:()=>!0};function Jb(n,e,t){return wM[t.paths](n.root,e.root,t.matrixParams)&&a0[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function bM(n,e){return Kn(n,e)}function c0(n,e,t){if(!rs(n.segments,e.segments)||!Rl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!c0(n.children[r],e.children[r],t))return!1;return!0}function CM(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>s0(n[t],e[t]))}function u0(n,e,t){return l0(n,e,e.segments,t)}function l0(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!rs(i,t)||e.hasChildren()||!Rl(i,t,r))}else if(n.segments.length===t.length){if(!rs(n.segments,t)||!Rl(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!u0(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!rs(n.segments,i)||!Rl(n.segments,i,r)||!n.children[re]?!1:l0(n.children[re],e,s,r)}}function Rl(n,e,t){return e.every((r,i)=>a0[t](n[i].parameters,r.parameters))}var Yn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ye([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ss(this.queryParams),this._queryParamMap}toString(){return AM.serialize(this)}},ye=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ol(this)}},Xr=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ss(this.parameters),this._parameterMap}toString(){return h0(this)}};function IM(n,e){return rs(n,e)&&n.every((t,r)=>Kn(t.parameters,e[r].parameters))}function rs(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function DM(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===re&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==re&&(t=t.concat(e(i,r)))}),t}var os=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>new Zr,providedIn:"root"})}return n})(),Zr=class{parse(e){let t=new Ng(e);return new Yn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${sc(e.root,!0)}`,r=NM(e.queryParams),i=typeof e.fragment=="string"?`#${RM(e.fragment)}`:"";return`${t}${r}${i}`}},AM=new Zr;function Ol(n){return n.segments.map(e=>h0(e)).join("/")}function sc(n,e){if(!n.hasChildren())return Ol(n);if(e){let t=n.children[re]?sc(n.children[re],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==re&&r.push(`${i}:${sc(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=DM(n,(r,i)=>i===re?[sc(n.children[re],!1)]:[`${i}:${sc(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[re]!=null?`${Ol(n)}/${t[0]}`:`${Ol(n)}/(${t.join("//")})`}}function d0(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dl(n){return d0(n).replace(/%3B/gi,";")}function RM(n){return encodeURI(n)}function Og(n){return d0(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Nl(n){return decodeURIComponent(n)}function Xb(n){return Nl(n.replace(/\+/g,"%20"))}function h0(n){return`${Og(n.path)}${OM(n.parameters)}`}function OM(n){return Object.entries(n).map(([e,t])=>`;${Og(e)}=${Og(t)}`).join("")}function NM(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Dl(t)}=${Dl(i)}`).join("&"):`${Dl(t)}=${Dl(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var kM=/^[^\/()?;#]+/;function bg(n){let e=n.match(kM);return e?e[0]:""}var PM=/^[^\/()?;=#]+/;function MM(n){let e=n.match(PM);return e?e[0]:""}var xM=/^[^=?&#]+/;function LM(n){let e=n.match(xM);return e?e[0]:""}var FM=/^[^&#]+/;function BM(n){let e=n.match(FM);return e?e[0]:""}var Ng=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ye([],{}):new ye([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[re]=new ye(e,t)),r}parseSegment(){let e=bg(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new oe(4009,!1);return this.capture(e),new Xr(Nl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=MM(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=bg(this.remaining);i&&(r=i,this.capture(r))}e[Nl(t)]=Nl(r)}parseQueryParam(e){let t=LM(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=BM(this.remaining);o&&(r=o,this.capture(r))}let i=Xb(t),s=Xb(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=bg(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new oe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=re);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[re]:new ye([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new oe(4011,!1)}};function f0(n){return n.segments.length>0?new ye([],{[re]:n}):n}function p0(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=p0(i);if(r===re&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ye(n.segments,e);return UM(t)}function UM(n){if(n.numberOfChildren===1&&n.children[re]){let e=n.children[re];return new ye(n.segments.concat(e.segments),e.children)}return n}function ei(n){return n instanceof Yn}function g0(n,e,t=null,r=null){let i=m0(n);return y0(i,e,t,r)}function m0(n){let e;function t(s){let o={};for(let c of s.children){let u=t(c);o[c.outlet]=u}let a=new ye(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=f0(r);return e??i}function y0(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Cg(i,i,i,t,r);let s=VM(e);if(s.toRoot())return Cg(i,i,new ye([],{}),t,r);let o=qM(s,i,n),a=o.processChildren?ac(o.segmentGroup,o.index,s.commands):E0(o.segmentGroup,o.index,s.commands);return Cg(i,o.segmentGroup,a,t,r)}function Pl(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function uc(n){return typeof n=="object"&&n!=null&&n.outlets}function Cg(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;n===e?o=t:o=v0(n,e,t);let a=f0(p0(o));return new Yn(a,s,i)}function v0(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=v0(s,e,t)}),new ye(n.segments,r)}var Ml=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Pl(r[0]))throw new oe(4003,!1);let i=r.find(uc);if(i&&i!==o0(r))throw new oe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function VM(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Ml(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Ml(t,e,r)}var ho=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function qM(n,e,t){if(n.isAbsolute)return new ho(e,!0,0);if(!t)return new ho(e,!1,NaN);if(t.parent===null)return new ho(t,!0,0);let r=Pl(n.commands[0])?0:1,i=t.segments.length-1+r;return zM(t,i,n.numberOfDoubleDots)}function zM(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new oe(4005,!1);i=r.segments.length}return new ho(r,!1,i-s)}function jM(n){return uc(n[0])?n[0].outlets:{[re]:n}}function E0(n,e,t){if(n??=new ye([],{}),n.segments.length===0&&n.hasChildren())return ac(n,e,t);let r=$M(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ye(n.segments.slice(0,r.pathIndex),{});return s.children[re]=new ye(n.segments.slice(r.pathIndex),n.children),ac(s,0,i)}else return r.match&&i.length===0?new ye(n.segments,{}):r.match&&!n.hasChildren()?kg(n,e,t):r.match?ac(n,0,i):kg(n,e,t)}function ac(n,e,t){if(t.length===0)return new ye(n.segments,{});{let r=jM(t),i={};if(Object.keys(r).some(s=>s!==re)&&n.children[re]&&n.numberOfChildren===1&&n.children[re].segments.length===0){let s=ac(n.children[re],e,t);return new ye(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=E0(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new ye(n.segments,i)}}function $M(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(uc(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!e0(c,u,o))return s;r+=2}else{if(!e0(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function kg(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(uc(s)){let c=GM(s.outlets);return new ye(r,c)}if(i===0&&Pl(t[0])){let c=n.segments[e];r.push(new Xr(c.path,Zb(t[0]))),i++;continue}let o=uc(s)?s.outlets[re]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Pl(a)?(r.push(new Xr(o,Zb(a))),i+=2):(r.push(new Xr(o,{})),i++)}return new ye(r,{})}function GM(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=kg(new ye([],{}),0,r))}),e}function Zb(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function e0(n,e,t){return n==t.path&&Kn(e,t.parameters)}var kl="imperative",et=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(et||{}),$t=class{id;url;constructor(e,t){this.id=e,this.url=t}},ti=class extends $t{type=et.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},on=class extends $t{urlAfterRedirects;type=et.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Lt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Lt||{}),po=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(po||{}),Qn=class extends $t{reason;code;type=et.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Jn=class extends $t{reason;code;type=et.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},go=class extends $t{error;target;type=et.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lc=class extends $t{urlAfterRedirects;state;type=et.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xl=class extends $t{urlAfterRedirects;state;type=et.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ll=class extends $t{urlAfterRedirects;state;shouldActivate;type=et.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Fl=class extends $t{urlAfterRedirects;state;type=et.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bl=class extends $t{urlAfterRedirects;state;type=et.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ul=class{route;type=et.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Vl=class{route;type=et.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ql=class{snapshot;type=et.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zl=class{snapshot;type=et.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jl=class{snapshot;type=et.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$l=class{snapshot;type=et.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mo=class{routerEvent;position;anchor;type=et.Scroll;constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},dc=class{},yo=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function HM(n,e){return n.providers&&!n._injector&&(n._injector=Zu(n.providers,e,`Route: ${n.path}`)),n._injector??e}function In(n){return n.outlet||re}function WM(n,e){let t=n.filter(r=>In(r)===e);return t.push(...n.filter(r=>In(r)!==e)),t}function vc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Gl=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return vc(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new as(this.rootInjector)}},as=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Gl(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(Y($n))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Hl=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Pg(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Pg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Mg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Mg(e,this._root).map(t=>t.value)}};function Pg(n,e){if(n===e.value)return e;for(let t of e.children){let r=Pg(n,t);if(r)return r}return null}function Mg(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Mg(n,t);if(r.length)return r.unshift(e),r}return[]}var jt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function lo(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var hc=class extends Hl{snapshot;constructor(e,t){super(e),this.snapshot=t,zg(this,e)}toString(){return this.snapshot.toString()}};function _0(n){let e=KM(n),t=new Ne([new Xr("",{})]),r=new Ne({}),i=new Ne({}),s=new Ne({}),o=new Ne(""),a=new Xn(t,r,s,o,i,re,n,e.root);return a.snapshot=e.root,new hc(new jt(a,[]),e)}function KM(n){let e={},t={},r={},i="",s=new is([],e,r,i,t,re,n,null,{});return new fc("",new jt(s,[]))}var Xn=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(he(u=>u[yc]))??W(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(he(e=>ss(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(he(e=>ss(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wl(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&S0(i)&&(r.resolve[yc]=i.title),r}var is=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[yc]}constructor(e,t,r,i,s,o,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ss(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ss(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},fc=class extends Hl{url;constructor(e,t){super(t),this.url=e,zg(this,t)}toString(){return T0(this._root)}};function zg(n,e){e.value._routerState=n,e.children.forEach(t=>zg(n,t))}function T0(n){let e=n.children.length>0?` { ${n.children.map(T0).join(", ")} } `:"";return`${n.value}${e}`}function Ig(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Kn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Kn(e.params,t.params)||n.paramsSubject.next(t.params),SM(e.url,t.url)||n.urlSubject.next(t.url),Kn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function xg(n,e){let t=Kn(n.params,e.params)&&IM(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||xg(n.parent,e.parent))}function S0(n){return typeof n.title=="string"||n.title===null}var w0=new X(""),jg=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=re;activateEvents=new Xs;deactivateEvents=new Xs;attachEvents=new Xs;detachEvents=new Xs;routerOutletData=uw(void 0);parentContexts=F(as);location=F(no);changeDetector=F(ro);inputBinder=F(Ec,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new oe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new oe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new oe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new oe(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Lg(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Gn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Js]})}return n})(),Lg=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Xn?this.route:e===as?this.childContexts:e===w0?this.outletData:this.parent.get(e,t)}},Ec=new X(""),$g=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Yu([r.queryParams,r.params,r.data]).pipe(yt(([s,o,a],c)=>(a=$($($({},s),o),a),c===0?W(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=Uw(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Gg=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Iw({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Rw(0,"router-outlet")},dependencies:[jg],encapsulation:2})}return n})();function Hg(n){let e=n.children&&n.children.map(Hg),t=e?it($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==re&&(t.component=Gg),t}function QM(n,e,t){let r=pc(n,e._root,t?t._root:void 0);return new hc(r,e)}function pc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=YM(n,e,t);return new jt(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>pc(n,a)),o}}let r=JM(e.value),i=e.children.map(s=>pc(n,s));return new jt(r,i)}}function YM(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return pc(n,r,i);return pc(n,r)})}function JM(n){return new Xn(new Ne(n.url),new Ne(n.params),new Ne(n.queryParams),new Ne(n.fragment),new Ne(n.data),n.outlet,n.component,n)}var vo=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},b0="ngNavigationCancelingError";function Kl(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ei(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=C0(!1,Lt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function C0(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[b0]=!0,t.cancellationCode=e,t}function XM(n){return I0(n)&&ei(n.url)}function I0(n){return!!n&&n[b0]}var ZM=(n,e,t,r)=>he(i=>(new Fg(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Fg=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Ig(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=lo(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=lo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=lo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=lo(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new $l(s.value.snapshot))}),e.children.length&&this.forwardEvent(new zl(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Ig(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Ig(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Ql=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},fo=class{component;route;constructor(e,t){this.component=e,this.route=t}};function ex(n,e,t){let r=n._root,i=e?e._root:null;return oc(r,i,t,[r.value])}function tx(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function _o(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!aw(n)?n:e.get(n):r}function oc(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=lo(e);return n.children.forEach(o=>{nx(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>cc(a,t.getContext(o),i)),i}function nx(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=rx(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Ql(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?oc(n,e,a?a.children:null,r,i):oc(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new fo(a.outlet.component,o))}else o&&cc(e,a,i),i.canActivateChecks.push(new Ql(r)),s.component?oc(n,null,a?a.children:null,r,i):oc(n,null,t,r,i);return i}function rx(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!rs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!rs(n.url,e.url)||!Kn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xg(n,e)||!Kn(n.queryParams,e.queryParams);case"paramsChange":default:return!xg(n,e)}}function cc(n,e,t){let r=lo(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?cc(o,e.children.getContext(s),t):cc(o,null,t):cc(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new fo(e.outlet.component,i)):t.canDeactivateChecks.push(new fo(null,i)):t.canDeactivateChecks.push(new fo(null,i))}function _c(n){return typeof n=="function"}function ix(n){return typeof n=="boolean"}function sx(n){return n&&_c(n.canLoad)}function ox(n){return n&&_c(n.canActivate)}function ax(n){return n&&_c(n.canActivateChild)}function cx(n){return n&&_c(n.canDeactivate)}function ux(n){return n&&_c(n.canMatch)}function D0(n){return n instanceof rw||n?.name==="EmptyError"}var Al=Symbol("INITIAL_VALUE");function Eo(){return yt(n=>Yu(n.map(e=>e.pipe(Qs(1),Mp(Al)))).pipe(he(e=>{for(let t of e)if(t!==!0){if(t===Al)return Al;if(t===!1||lx(t))return t}return!0}),Tn(e=>e!==Al),Qs(1)))}function lx(n){return ei(n)||n instanceof vo}function dx(n,e){return Pt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?W(it($({},t),{guardsResult:!0})):hx(o,r,i,n).pipe(Pt(a=>a&&ix(a)?fx(r,s,n,e):W(a)),he(a=>it($({},t),{guardsResult:a})))})}function hx(n,e,t,r){return We(n).pipe(Pt(i=>vx(i.component,i.route,t,e,r)),Wr(i=>i!==!0,!0))}function fx(n,e,t,r){return We(e).pipe(Sr(i=>iw(gx(i.route.parent,r),px(i.route,r),yx(n,i.path,t),mx(n,i.route,t))),Wr(i=>i!==!0,!0))}function px(n,e){return n!==null&&e&&e(new jl(n)),W(!0)}function gx(n,e){return n!==null&&e&&e(new ql(n)),W(!0)}function mx(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return W(!0);let i=r.map(s=>Op(()=>{let o=vc(e)??t,a=_o(s,o),c=ox(a)?a.canActivate(e,n):vt(o,()=>a(e,n));return ni(c).pipe(Wr())}));return W(i).pipe(Eo())}function yx(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>tx(o)).filter(o=>o!==null).map(o=>Op(()=>{let a=o.guards.map(c=>{let u=vc(o.node)??t,l=_o(c,u),d=ax(l)?l.canActivateChild(r,n):vt(u,()=>l(r,n));return ni(d).pipe(Wr())});return W(a).pipe(Eo())}));return W(s).pipe(Eo())}function vx(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return W(!0);let o=s.map(a=>{let c=vc(e)??i,u=_o(a,c),l=cx(u)?u.canDeactivate(n,e,t,r):vt(c,()=>u(n,e,t,r));return ni(l).pipe(Wr())});return W(o).pipe(Eo())}function Ex(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return W(!0);let s=i.map(o=>{let a=_o(o,n),c=sx(a)?a.canLoad(e,t):vt(n,()=>a(e,t));return ni(c)});return W(s).pipe(Eo(),A0(r))}function A0(n){return bp(st(e=>{if(typeof e!="boolean")throw Kl(n,e)}),he(e=>e===!0))}function _x(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return W(!0);let s=i.map(o=>{let a=_o(o,n),c=ux(a)?a.canMatch(e,t):vt(n,()=>a(e,t));return ni(c)});return W(s).pipe(Eo(),A0(r))}var gc=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},mc=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function uo(n){return La(new gc(n))}function Tx(n){return La(new oe(4e3,!1))}function Sx(n){return La(C0(!1,Lt.GuardRejected))}var Bg=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return W(r);if(i.numberOfChildren>1||!i.children[re])return Tx(`${e.redirectTo}`);i=i.children[re]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:l,url:d,outlet:h,params:p,data:S,title:b}=i,w=vt(s,()=>a({params:p,data:S,queryParams:c,fragment:u,routeConfig:l,url:d,outlet:h,title:b}));if(w instanceof Yn)throw new mc(w);t=w}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new mc(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Yn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new ye(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new oe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Ug={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function wx(n,e,t,r,i){let s=R0(n,e,t);return s.matched?(r=HM(e,r),_x(r,e,t,i).pipe(he(o=>o===!0?s:$({},Ug)))):W(s)}function R0(n,e,t){if(e.path==="**")return bx(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},Ug):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||i0)(t,n,e);if(!i)return $({},Ug);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?$($({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function bx(n){return{matched:!0,parameters:n.length>0?o0(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function t0(n,e,t,r){return t.length>0&&Dx(n,t,r)?{segmentGroup:new ye(e,Ix(r,new ye(t,n.children))),slicedSegments:[]}:t.length===0&&Ax(n,t,r)?{segmentGroup:new ye(n.segments,Cx(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ye(n.segments,n.children),slicedSegments:t}}function Cx(n,e,t,r){let i={};for(let s of t)if(Jl(n,e,s)&&!r[In(s)]){let o=new ye([],{});i[In(s)]=o}return $($({},r),i)}function Ix(n,e){let t={};t[re]=e;for(let r of n)if(r.path===""&&In(r)!==re){let i=new ye([],{});t[In(r)]=i}return t}function Dx(n,e,t){return t.some(r=>Jl(n,e,r)&&In(r)!==re)}function Ax(n,e,t){return t.some(r=>Jl(n,e,r))}function Jl(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Rx(n,e,t){return e.length===0&&!n.children[t]}var Vg=class{};function Ox(n,e,t,r,i,s,o="emptyOnly"){return new qg(n,e,t,r,i,o,s).recognize()}var Nx=31,qg=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Bg(this.urlSerializer,this.urlTree)}noMatchError(e){return new oe(4002,`'${e.segmentGroup}'`)}recognize(){let e=t0(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(he(({children:t,rootSnapshot:r})=>{let i=new jt(r,t),s=new fc("",i),o=g0(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new is([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),re,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,re,t).pipe(he(r=>({children:r,rootSnapshot:t})),Qi(r=>{if(r instanceof mc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof gc?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(he(o=>o instanceof jt?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return We(s).pipe(Sr(o=>{let a=r.children[o],c=WM(t,o);return this.processSegmentGroup(e,c,a,o,i)}),Pp((o,a)=>(o.push(...a),o)),Np(null),sw(),Pt(o=>{if(o===null)return uo(r);let a=O0(o);return kx(a),W(a)}))}processSegment(e,t,r,i,s,o,a){return We(t).pipe(Sr(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(Qi(u=>{if(u instanceof gc)return W(null);throw u}))),Wr(c=>!!c),Qi(c=>{if(D0(c))return Rx(r,i,s)?W(new Vg):uo(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return In(r)!==o&&(o===re||!Jl(i,s,r))?uo(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):uo(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:u,consumedSegments:l,positionalParamSegments:d,remainingSegments:h}=R0(t,i,s);if(!c)return uo(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Nx&&(this.allowRedirects=!1));let p=new is(s,u,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,n0(i),In(i),i.component??i._loadedComponent??null,i,r0(i)),S=Wl(p,a,this.paramsInheritanceStrategy);p.params=Object.freeze(S.params),p.data=Object.freeze(S.data);let b=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,d,p,e);return this.applyRedirects.lineralizeSegments(i,b).pipe(Pt(w=>this.processSegment(e,r,t,w.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=wx(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(yt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(yt(({routes:u})=>{let l=r._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=c,S=new is(h,d,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,n0(r),In(r),r.component??r._loadedComponent??null,r,r0(r)),b=Wl(S,o,this.paramsInheritanceStrategy);S.params=Object.freeze(b.params),S.data=Object.freeze(b.data);let{segmentGroup:w,slicedSegments:D}=t0(t,h,p,u);if(D.length===0&&w.hasChildren())return this.processChildren(l,u,w,S).pipe(he(k=>new jt(S,k)));if(u.length===0&&D.length===0)return W(new jt(S,[]));let x=In(r)===s;return this.processSegment(l,u,w,D,x?re:s,!0,S).pipe(he(k=>new jt(S,k instanceof jt?[k]:[])))}))):uo(t)))}getChildConfig(e,t,r){return t.children?W({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?W({routes:t._loadedRoutes,injector:t._loadedInjector}):Ex(e,t,r,this.urlSerializer).pipe(Pt(i=>i?this.configLoader.loadChildren(e,t).pipe(st(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):Sx(t))):W({routes:[],injector:e})}};function kx(n){n.sort((e,t)=>e.value.outlet===re?-1:t.value.outlet===re?1:e.value.outlet.localeCompare(t.value.outlet))}function Px(n){let e=n.value.routeConfig;return e&&e.path===""}function O0(n){let e=[],t=new Set;for(let r of n){if(!Px(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=O0(r.children);e.push(new jt(r.value,i))}return e.filter(r=>!t.has(r))}function n0(n){return n.data||{}}function r0(n){return n.resolve||{}}function Mx(n,e,t,r,i,s){return Pt(o=>Ox(n,e,t,r,o.extractedUrl,i,s).pipe(he(({state:a,tree:c})=>it($({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function xx(n,e){return Pt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return W(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of N0(c))o.add(u);let a=0;return We(o).pipe(Sr(c=>s.has(c)?Lx(c,r,n,e):(c.data=Wl(c,c.parent,n).resolve,W(void 0))),st(()=>a++),kp(1),Pt(c=>a===o.size?W(t):_n))})}function N0(n){let e=n.children.map(t=>N0(t)).flat();return[n,...e]}function Lx(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!S0(i)&&(s[yc]=i.title),Fx(s,n,e,r).pipe(he(o=>(n._resolvedData=o,n.data=Wl(n,n.parent,t).resolve,null)))}function Fx(n,e,t,r){let i=Rg(n);if(i.length===0)return W({});let s={};return We(i).pipe(Pt(o=>Bx(n[o],e,t,r).pipe(Wr(),st(a=>{if(a instanceof vo)throw Kl(new Zr,a);s[o]=a}))),kp(1),he(()=>s),Qi(o=>D0(o)?_n:La(o)))}function Bx(n,e,t,r){let i=vc(e)??r,s=_o(n,i),o=s.resolve?s.resolve(e,t):vt(i,()=>s(e,t));return ni(o)}function Dg(n){return yt(e=>{let t=n(e);return t?We(t).pipe(he(()=>e)):W(e)})}var Wg=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===re);return r}getResolvedTitleForRoute(t){return t.data[yc]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F(k0),providedIn:"root"})}return n})(),k0=(()=>{class n extends Wg{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(Y(Yb))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cs=new X("",{providedIn:"root",factory:()=>({})}),us=new X(""),Xl=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=F(Pw);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return W(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=ni(t.loadComponent()).pipe(he(M0),st(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Ys(()=>{this.componentLoaders.delete(t)})),i=new Ip(r,()=>new En).pipe(Cp());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return W({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=P0(r,this.compiler,t,this.onLoadEndListener).pipe(Ys(()=>{this.childrenLoaders.delete(r)})),o=new Ip(s,()=>new En).pipe(Cp());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function P0(n,e,t,r){return ni(n.loadChildren()).pipe(he(M0),Pt(i=>i instanceof Cw||Array.isArray(i)?W(i):We(e.compileModuleAsync(i))),he(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(us,[],{optional:!0,self:!0}).flat()),{routes:o.map(Hg),injector:s}}))}function Ux(n){return n&&typeof n=="object"&&"default"in n}function M0(n){return Ux(n)?n.default:n}var Zl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F(Vx),providedIn:"root"})}return n})(),Vx=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Kg=new X(""),Qg=new X("");function x0(n,e,t){let r=n.get(Qg),i=n.get(je);return n.get(ze).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),qx(n))),{onViewTransitionCreated:c}=r;return c&&vt(n,()=>c({transition:a,from:e,to:t})),o})}function qx(n){return new Promise(e=>{pw({read:()=>setTimeout(e)},{injector:n})})}var Yg=new X(""),ed=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new En;transitionAbortSubject=new En;configLoader=F(Xl);environmentInjector=F($n);destroyRef=F(Fa);urlSerializer=F(os);rootContexts=F(as);location=F(Yr);inputBindingEnabled=F(Ec,{optional:!0})!==null;titleStrategy=F(Wg);options=F(cs,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=F(Zl);createViewTransition=F(Kg,{optional:!0});navigationErrorHandler=F(Yg,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>W(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Ul(i)),r=i=>this.events.next(new Vl(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(it($({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new Ne(null),this.transitions.pipe(Tn(r=>r!==null),yt(r=>{let i=!1,s=!1;return W(r).pipe(yt(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Lt.SupersededByNewNavigation),_n;this.currentTransition=r,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?it($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&c!=="reload"){let u="";return this.events.next(new Jn(o.id,this.urlSerializer.serialize(o.rawUrl),u,po.IgnoredSameUrlNavigation)),o.resolve(!1),_n}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return W(o).pipe(yt(u=>(this.events.next(new ti(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?_n:Promise.resolve(u))),Mx(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),st(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=it($({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let l=new lc(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:u,extractedUrl:l,source:d,restoredState:h,extras:p}=o,S=new ti(u,this.urlSerializer.serialize(l),d,h);this.events.next(S);let b=_0(this.rootComponentType).snapshot;return this.currentTransition=r=it($({},o),{targetSnapshot:b,urlAfterRedirects:l,extras:it($({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=l,W(r)}else{let u="";return this.events.next(new Jn(o.id,this.urlSerializer.serialize(o.extractedUrl),u,po.IgnoredByUrlHandlingStrategy)),o.resolve(!1),_n}}),st(o=>{let a=new xl(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),he(o=>(this.currentTransition=r=it($({},o),{guards:ex(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),dx(this.environmentInjector,o=>this.events.next(o)),st(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Kl(this.urlSerializer,o.guardsResult);let a=new Ll(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Tn(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Lt.GuardRejected),!1)),Dg(o=>{if(o.guards.canActivateChecks.length!==0)return W(o).pipe(st(a=>{let c=new Fl(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),yt(a=>{let c=!1;return W(a).pipe(xx(this.paramsInheritanceStrategy,this.environmentInjector),st({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Lt.NoDataFromResolver)}}))}),st(a=>{let c=new Bl(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),Dg(o=>{let a=c=>{let u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(st(l=>{c.component=l}),he(()=>{})));for(let l of c.children)u.push(...a(l));return u};return Yu(a(o.targetSnapshot.root)).pipe(Np(null),Qs(1))}),Dg(()=>this.afterPreactivation()),yt(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?We(c).pipe(he(()=>r)):W(r)}),he(o=>{let a=QM(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=it($({},o),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),st(()=>{this.events.next(new dc)}),ZM(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Qs(1),st({next:o=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new on(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),ow(this.transitionAbortSubject.pipe(st(o=>{throw o}))),Ys(()=>{!i&&!s&&this.cancelNavigationTransition(r,"",Lt.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),Qi(o=>{if(this.destroyed)return r.resolve(!1),_n;if(s=!0,I0(o))this.events.next(new Qn(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),XM(o)?this.events.next(new yo(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new go(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=vt(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof vo){let{message:u,cancellationCode:l}=Kl(this.urlSerializer,c);this.events.next(new Qn(r.id,this.urlSerializer.serialize(r.extractedUrl),u,l)),this.events.next(new yo(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return _n}))}))}cancelNavigationTransition(t,r,i){let s=new Qn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zx(n){return n!==kl}var L0=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F(jx),providedIn:"root"})}return n})(),Yl=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},jx=(()=>{class n extends Yl{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Fp(n)))(i||n)}})();static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),F0=(()=>{class n{urlSerializer=F(os);options=F(cs,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=F(Yr);urlHandlingStrategy=F(Zl);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Yn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof Yn?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=_0(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>F($x),providedIn:"root"})}return n})(),$x=(()=>{class n extends F0{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof ti?this.updateStateMemento():t instanceof Jn?this.commitTransition(r):t instanceof lc?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof dc?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Qn&&(t.code===Lt.GuardRejected||t.code===Lt.NoDataFromResolver)?this.restoreHistory(r):t instanceof go?this.restoreHistory(r,!0):t instanceof on&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=$($({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=$($({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Fp(n)))(i||n)}})();static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function td(n,e){n.events.pipe(Tn(t=>t instanceof on||t instanceof Qn||t instanceof go||t instanceof Jn),he(t=>t instanceof on||t instanceof Jn?0:(t instanceof Qn?t.code===Lt.Redirect||t.code===Lt.SupersededByNewNavigation:!1)?2:1),Tn(t=>t!==2),Qs(1)).subscribe(()=>{e()})}var Gx={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Hx={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Zn=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=F(jp);stateManager=F(F0);options=F(cs,{optional:!0})||{};pendingTasks=F(Ju);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=F(ed);urlSerializer=F(os);location=F(Yr);urlHandlingStrategy=F(Zl);_events=new En;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=F(L0);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=F(us,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!F(Ec,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new ZS;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Qn&&r.code!==Lt.Redirect&&r.code!==Lt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof on)this.navigated=!0;else if(r instanceof yo){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||zx(i.source)},o);this.scheduleNavigation(a,kl,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Kx(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),kl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=$({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Hg),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:o,l=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":l=$($({},this.currentUrlTree.queryParams),s);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=s||null}l!==null&&(l=this.removeEmptyProps(l));let d;try{let h=i?i.snapshot:this.routerState.snapshot.root;d=m0(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return y0(d,t,l,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=ei(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,kl,null,r)}navigate(t,r={skipLocationChange:!1}){return Wx(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},Gx):r===!1?i=$({},Hx):i=r,ei(t))return Jb(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Jb(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,u;o?(a=o.resolve,c=o.reject,u=o.promise):u=new Promise((d,h)=>{a=d,c=h});let l=this.pendingTasks.add();return td(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(l))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(d=>Promise.reject(d))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Wx(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new oe(4008,!1)}function Kx(n){return!(n instanceof dc)&&!(n instanceof yo)}var B0=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new En;constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a;let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof on&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(ei(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Sw(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:ei(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Ce(Zn),Ce(Xn),Bp("tabindex"),Ce(to),Ce(Zs),Ce(wn))};static \u0275dir=Gn({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&Nw("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Aw("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ja],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ja],replaceUrl:[2,"replaceUrl","replaceUrl",ja],routerLink:"routerLink"},features:[Js]})}return n})();var Tc=class{};var U0=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,i,s){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Tn(t=>t instanceof on),Sr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Zu(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return We(i).pipe(Rp())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=W(null);let s=i.pipe(Pt(o=>o===null?W(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return We([s,o]).pipe(Rp())}else return s})}static \u0275fac=function(r){return new(r||n)(Y(Zn),Y($n),Y(Tc),Y(Xl))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),V0=new X(""),Qx=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ti?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof on?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Jn&&t.code===po.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof mo&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new mo(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){bw()};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function Yx(n,...e){return rn([{provide:us,multi:!0,useValue:n},[],{provide:Xn,useFactory:q0,deps:[Zn]},{provide:Va,multi:!0,useFactory:z0},e.map(t=>t.\u0275providers)])}function q0(n){return n.routerState.root}function Sc(n,e){return{\u0275kind:n,\u0275providers:e}}function z0(){let n=F(Rt);return e=>{let t=n.get(qa);if(e!==t.components[0])return;let r=n.get(Zn),i=n.get(j0);n.get(Xg)===1&&r.initialNavigation(),n.get(H0,null,xp.Optional)?.setUpPreloading(),n.get(V0,null,xp.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var j0=new X("",{factory:()=>new En}),Xg=new X("",{providedIn:"root",factory:()=>1});function $0(){let n=[{provide:Xg,useValue:0},$p(()=>{let e=F(Rt);return e.get(Wp,Promise.resolve()).then(()=>new Promise(r=>{let i=e.get(Zn),s=e.get(j0);td(i,()=>{r(!0)}),e.get(ed).afterPreactivation=()=>(r(!0),s.closed?W(void 0):s),i.initialNavigation()}))})];return Sc(2,n)}function G0(){let n=[$p(()=>{F(Zn).setUpLocationChangeListener()}),{provide:Xg,useValue:2}];return Sc(3,n)}var H0=new X("");function W0(n){return Sc(0,[{provide:H0,useExisting:U0},{provide:Tc,useExisting:n}])}function K0(){return Sc(8,[$g,{provide:Ec,useExisting:$g}])}function Q0(n){Ba("NgRouterViewTransitions");let e=[{provide:Kg,useValue:x0},{provide:Qg,useValue:$({skipNextTransition:!!n?.skipInitialTransition},n)}];return Sc(9,e)}var Y0=[Yr,{provide:os,useClass:Zr},Zn,as,{provide:Xn,useFactory:q0,deps:[Zn]},Xl,[]],Jx=(()=>{class n{constructor(){}static forRoot(t,r){return{ngModule:n,providers:[Y0,[],{provide:us,multi:!0,useValue:t},[],r?.errorHandler?{provide:Yg,useValue:r.errorHandler}:[],{provide:cs,useValue:r||{}},r?.useHash?Zx():eL(),Xx(),r?.preloadingStrategy?W0(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?tL(r):[],r?.bindToComponentInputs?K0().\u0275providers:[],r?.enableViewTransitions?Q0().\u0275providers:[],nL()]}}static forChild(t){return{ngModule:n,providers:[{provide:us,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=es({type:n});static \u0275inj=Yi({})}return n})();function Xx(){return{provide:V0,useFactory:()=>{let n=F(Eb),e=F(ze),t=F(cs),r=F(ed),i=F(os);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Qx(i,r,n,e,t)}}}function Zx(){return{provide:wn,useClass:ng}}function eL(){return{provide:wn,useClass:sl}}function tL(n){return[n.initialNavigation==="disabled"?G0().\u0275providers:[],n.initialNavigation==="enabledBlocking"?$0().\u0275providers:[]]}var Jg=new X("");function nL(){return[{provide:Jg,useFactory:z0},{provide:Va,multi:!0,useExisting:Jg}]}var FQ=(()=>{class n{constructor(){this._headerType=new Ne("light"),this.headerType=this._headerType.asObservable(),this._headerDashboard=new Ne(!1),this.headerDashboard=this._headerDashboard.asObservable(),this._headerBooking=new Ne(!1),this.headerBooking=this._headerBooking.asObservable(),this._headerHeight=new Ne(0),this.headerHeight=this._headerHeight.asObservable(),this._loading=new Ne(!1),this.loading=this._loading.asObservable(),this._sidebarDashboardOpened=new Ne(!0),this.sidebarDashboardOpened=this._sidebarDashboardOpened.asObservable(),this._hideNav=new Ne(!1),this.hideNav=this._hideNav.asObservable(),this._minFooter=new Ne(!1),this.minFooter=this._minFooter.asObservable(),this._footerHeight=new Ne(0),this.footerHeight=this._footerHeight.asObservable()}changeHeaderType(t){t&&this._headerType.next(t)}changeHeaderHeight(t){this._headerHeight.next(t)}changeFooterHeight(t){this._footerHeight.next(t)}toggleHideNav(t){let r=t??!this._hideNav.value;r&&this._headerHeight.next(0),this._hideNav.next(r)}setLoading(t){t?this._loading.next(!0):setTimeout(()=>{this._loading.next(!1)},500)}changeHeaderDashboard(t){this._headerDashboard.next(t)}setBookingMode(t){t&&this._headerType.next("dark"),this._minFooter.next(t),this._headerBooking.next(t)}setMinimizedFooter(t){this._minFooter.next(t)}toggleDashboardSidebar(){this._sidebarDashboardOpened.next(!this._sidebarDashboardOpened.value)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var J0=()=>{};var rL={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var eC=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},iL=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},nd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,l=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|u>>6,p=u&63;c||(p=64,o||(h=64)),r.push(t[l],t[d],t[h],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(eC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iL(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let d=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||d==null)throw new em;let h=s<<2|a>>4;if(r.push(h),u!==64){let p=a<<4&240|u>>2;if(r.push(p),d!==64){let S=u<<6&192|d;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},em=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},sL=function(n){let e=eC(n);return nd.encodeByteArray(e,!0)},bc=function(n){return sL(n).replace(/\./g,"")},rd=function(n){try{return nd.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nm(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var oL=()=>nm().__FIREBASE_DEFAULTS__,aL=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cL=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&rd(n[1]);return e&&JSON.parse(e)},rm=()=>{try{return J0()||oL()||aL()||cL()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},im=n=>{var e,t;return(t=(e=rm())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},tC=n=>{let e=im(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},sm=()=>{var n;return(n=rm())===null||n===void 0?void 0:n.config};var ls=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function ds(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function id(n){return E(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function nC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[bc(JSON.stringify(t)),bc(JSON.stringify(o)),""].join(".")}var wc={};function uL(){let n={prod:[],emulator:[]};for(let e of Object.keys(wc))wc[e]?n.emulator.push(e):n.prod.push(e);return n}function lL(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var X0=!1;function sd(n,e){if(typeof window>"u"||typeof document>"u"||!ds(window.location.host)||wc[n]===e||wc[n]||X0)return;wc[n]=e;function t(h){return`__firebase__banner__${h}`}let r="__firebase__banner",s=uL().prod.length>0;function o(){let h=document.getElementById(r);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,p){h.setAttribute("width","24"),h.setAttribute("id",p),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){let h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{X0=!0,o()},h}function l(h,p){h.setAttribute("id",p),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){let h=lL(r),p=t("text"),S=document.getElementById(p)||document.createElement("span"),b=t("learnmore"),w=document.getElementById(b)||document.createElement("a"),D=t("preprendIcon"),x=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){let k=h.element;a(k),l(w,b);let I=u();c(x,D),k.append(x,S,w,I),document.body.appendChild(k)}s?(S.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function dL(){var n;let e=(n=rm())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sC(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function oC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function aC(){return!dL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Cc(){try{return typeof indexedDB=="object"}catch{return!1}}function cC(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}function qQ(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var hL="FirebaseError",Gt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=hL,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dn.prototype.create)}},Dn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?fL(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Gt(i,a,r)}};function fL(n,e){return n.replace(pL,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var pL=/\{\$([^}]+)}/g;function er(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Z0(s)&&Z0(o)){if(!er(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Z0(n){return n!==null&&typeof n=="object"}function od(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function To(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function So(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function uC(n,e){let t=new tm(n,e);return t.subscribe.bind(t)}var tm=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");gL(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Zg),i.error===void 0&&(i.error=Zg),i.complete===void 0&&(i.complete=Zg);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function gL(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Zg(){}var mL=1e3,yL=2,vL=4*60*60*1e3,EL=.5;function _L(n,e=mL,t=yL){let r=e*Math.pow(t,n),i=Math.round(EL*r*(Math.random()-.5)*2);return Math.min(vL,r+i)}function Qe(n){return n&&n._delegate?n._delegate:n}rL.NODE_CLIENT=!0;var Ot=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var hs="[DEFAULT]";var om=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new ls;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SL(e))try{this.getOrInitializeService({instanceIdentifier:hs})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=hs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return E(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=hs){return this.instances.has(e)}getOptions(e=hs){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:TL(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=hs){return this.component?this.component.multipleInstances?e:hs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function TL(n){return n===hs?void 0:n}function SL(n){return n.instantiationMode==="EAGER"}var ad=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new om(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var wL=[],ce=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ce||{}),bL={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},CL=ce.INFO,IL={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},DL=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=IL[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},tr=class{constructor(e){this.name=e,this._logLevel=CL,this._logHandler=DL,this._userLogHandler=null,wL.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}};var AL=(n,e)=>e.some(t=>n instanceof t),lC,dC;function RL(){return lC||(lC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OL(){return dC||(dC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var hC=new WeakMap,cm=new WeakMap,fC=new WeakMap,am=new WeakMap,lm=new WeakMap;function NL(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(An(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&hC.set(t,n)}).catch(()=>{}),lm.set(e,n),e}function kL(n){if(cm.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});cm.set(n,e)}var um={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return An(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pC(n){um=n(um)}function PL(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(cd(this),e,...t);return fC.set(r,e.sort?e.sort():[e]),An(r)}:OL().includes(n)?function(...e){return n.apply(cd(this),e),An(hC.get(this))}:function(...e){return An(n.apply(cd(this),e))}}function ML(n){return typeof n=="function"?PL(n):(n instanceof IDBTransaction&&kL(n),AL(n,RL())?new Proxy(n,um):n)}function An(n){if(n instanceof IDBRequest)return NL(n);if(am.has(n))return am.get(n);let e=ML(n);return e!==n&&(am.set(n,e),lm.set(e,n)),e}var cd=n=>lm.get(n);function mC(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=An(o);return r&&o.addEventListener("upgradeneeded",c=>{r(An(o.result),c.oldVersion,c.newVersion,An(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}function YQ(n,{blocked:e}={}){let t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),An(t).then(()=>{})}var xL=["get","getKey","getAll","getAllKeys","count"],LL=["put","add","delete","clear"],dm=new Map;function gC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(dm.get(e))return dm.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=LL.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||xL.includes(t)))return;let s=function(o,...a){return E(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[t](...a),i&&c.done]))[0]})};return dm.set(e,s),s}pC(n=>it($({},n),{get:(e,t,r)=>gC(e,t)||n.get(e,t,r),has:(e,t)=>!!gC(e,t)||n.has(e,t)}));var fm=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(FL(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function FL(n){let e=n.getComponent();return e?.type==="VERSION"}var pm="@firebase/app",yC="0.13.2";var Dr=new tr("@firebase/app"),BL="@firebase/app-compat",UL="@firebase/analytics-compat",VL="@firebase/analytics",qL="@firebase/app-check-compat",zL="@firebase/app-check",jL="@firebase/auth",$L="@firebase/auth-compat",GL="@firebase/database",HL="@firebase/data-connect",WL="@firebase/database-compat",KL="@firebase/functions",QL="@firebase/functions-compat",YL="@firebase/installations",JL="@firebase/installations-compat",XL="@firebase/messaging",ZL="@firebase/messaging-compat",eF="@firebase/performance",tF="@firebase/performance-compat",nF="@firebase/remote-config",rF="@firebase/remote-config-compat",iF="@firebase/storage",sF="@firebase/storage-compat",oF="@firebase/firestore",aF="@firebase/ai",cF="@firebase/firestore-compat",uF="firebase",lF="11.10.0";var gm="[DEFAULT]",dF={[pm]:"fire-core",[BL]:"fire-core-compat",[VL]:"fire-analytics",[UL]:"fire-analytics-compat",[zL]:"fire-app-check",[qL]:"fire-app-check-compat",[jL]:"fire-auth",[$L]:"fire-auth-compat",[GL]:"fire-rtdb",[HL]:"fire-data-connect",[WL]:"fire-rtdb-compat",[KL]:"fire-fn",[QL]:"fire-fn-compat",[YL]:"fire-iid",[JL]:"fire-iid-compat",[XL]:"fire-fcm",[ZL]:"fire-fcm-compat",[eF]:"fire-perf",[tF]:"fire-perf-compat",[nF]:"fire-rc",[rF]:"fire-rc-compat",[iF]:"fire-gcs",[sF]:"fire-gcs-compat",[oF]:"fire-fst",[cF]:"fire-fst-compat",[aF]:"fire-vertex","fire-js":"fire-js",[uF]:"fire-js-all"};var Ic=new Map,hF=new Map,mm=new Map;function vC(n,e){try{n.container.addComponent(e)}catch(t){Dr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Rn(n){let e=n.name;if(mm.has(e))return Dr.debug(`There were multiple attempts to register component ${e}.`),!1;mm.set(e,n);for(let t of Ic.values())vC(t,n);for(let t of hF.values())vC(t,n);return!0}function wo(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wt(n){return n==null?!1:n.settings!==void 0}var fF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new Dn("app","Firebase",fF);var ym=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ot("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}};var bo=lF;function _m(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:gm,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw ri.create("bad-app-name",{appName:String(i)});if(t||(t=sm()),!t)throw ri.create("no-options");let s=Ic.get(i);if(s){if(er(t,s.options)&&er(r,s.config))return s;throw ri.create("duplicate-app",{appName:i})}let o=new ad(i);for(let c of mm.values())o.addComponent(c);let a=new ym(t,r,o);return Ic.set(i,a),a}function fs(n=gm){let e=Ic.get(n);if(!e&&n===gm&&sm())return _m();if(!e)throw ri.create("no-app",{appName:n});return e}function ud(){return Array.from(Ic.values())}function Fe(n,e,t){var r;let i=(r=dF[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Dr.warn(a.join(" "));return}Rn(new Ot(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var pF="firebase-heartbeat-database",gF=1,Dc="firebase-heartbeat-store",hm=null;function SC(){return hm||(hm=mC(pF,gF,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Dc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ri.create("idb-open",{originalErrorMessage:n.message})})),hm}function mF(n){return E(this,null,function*(){try{let t=(yield SC()).transaction(Dc),r=yield t.objectStore(Dc).get(wC(n));return yield t.done,r}catch(e){if(e instanceof Gt)Dr.warn(e.message);else{let t=ri.create("idb-get",{originalErrorMessage:e?.message});Dr.warn(t.message)}}})}function EC(n,e){return E(this,null,function*(){try{let r=(yield SC()).transaction(Dc,"readwrite");yield r.objectStore(Dc).put(e,wC(n)),yield r.done}catch(t){if(t instanceof Gt)Dr.warn(t.message);else{let r=ri.create("idb-set",{originalErrorMessage:t?.message});Dr.warn(r.message)}}})}function wC(n){return`${n.name}!${n.options.appId}`}var yF=1024,vF=30,vm=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Em(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return E(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=_C();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>vF){let o=_F(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Dr.warn(r)}})}getHeartbeatsHeader(){return E(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=_C(),{heartbeatsToSend:r,unsentEntries:i}=EF(this._heartbeatsCache.heartbeats),s=bc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Dr.warn(t),""}})}};function _C(){return new Date().toISOString().substring(0,10)}function EF(n,e=yF){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),TC(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),TC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Em=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return E(this,null,function*(){return Cc()?cC().then(()=>!0).catch(()=>!1):!1})}read(){return E(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield mF(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return E(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return EC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return E(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return EC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function TC(n){return bc(JSON.stringify({version:2,heartbeats:n})).length}function _F(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function TF(n){Rn(new Ot("platform-logger",e=>new fm(e),"PRIVATE")),Rn(new Ot("heartbeat",e=>new vm(e),"PRIVATE")),Fe(pm,yC,n),Fe(pm,yC,"esm2017"),Fe("fire-js","")}TF("");var SF="firebase",wF="11.10.0";Fe(SF,wF,"app");function Tm(n){n===void 0&&(Lp(Tm),n=F(Rt));let e=n.get(Xu);return t=>new nn(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var ii=new tl("ANGULARFIRE2_VERSION");function Ac(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Io=(n,e)=>{let t=e?[e]:ud(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Co=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Co||{}),bC=Gp()&&typeof Zone<"u"?Co.WARN:Co.SILENT;var ld=class{zone;delegate;constructor(e,t=tw){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},si=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=F(ze);this.outsideAngular=t.runOutsideAngular(()=>new ld(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ld(typeof Zone>"u"?void 0:Zone.current,ew))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CC=!1;function bF(n,e){!CC&&(bC>Co.SILENT||Gp())&&(CC=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),bC>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function CF(n){let e=F(ze,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function ps(n){let e=F(ze,{optional:!0});return e?e.run(()=>n()):n()}var IF=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),vt(t,()=>ps(()=>n.apply(void 0,r)))),De=(n,e,t)=>(t||=e?Co.WARN:Co.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=F(si),o=F(Xu),a=F($n)}catch{return bF(n,t),n.apply(this,i)}for(let u=0;u<arguments.length;u++)typeof i[u]=="function"&&(e&&(r||=ps(()=>o.add())),i[u]=IF(i[u],r,a));let c=CF(()=>n.apply(this,i));return e?c instanceof nn?c.pipe(Ap(s.outsideAngular),Dp(s.insideAngular),Tm(a)):c instanceof Promise?ps(()=>new Promise((u,l)=>{o.run(()=>c).then(d=>vt(a,()=>ps(()=>u(d))),d=>vt(a,()=>ps(()=>l(d))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:ps(()=>c):c instanceof nn?c.pipe(Ap(s.outsideAngular),Dp(s.insideAngular)):ps(()=>c)});var Ar=class{constructor(e){return e}},gs=class{constructor(){return ud()}};function DF(n){return n&&n.length===1?n[0]:new Ar(fs())}var Sm=new X("angularfire2._apps"),AF={provide:Ar,useFactory:DF,deps:[[new qt,Sm]]},RF={provide:gs,deps:[[new qt,Sm]]};function OF(n){return(e,t)=>{let r=t.get(Kr);Fe("angularfire",ii.full,"core"),Fe("angularfire",ii.full,"app"),Fe("angular",kw.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Ar(i)}}function VY(n,...e){return rn([AF,RF,{provide:Sm,useFactory:OF(n),multi:!0,deps:[ze,Rt,si,...e]}])}var qY=De(_m,!0);var NF=new Map,kF={activated:!1,tokenObservers:[]},PF={initialized:!1,enabled:!1};function On(n){return NF.get(n)||Object.assign({},kF)}function RC(){return PF}var MF="https://content-firebaseappcheck.googleapis.com/v1";var xF="exchangeDebugToken",IC={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},QY=24*60*60*1e3;var Cm=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return E(this,null,function*(){this.stop();try{this.pending=new ls,this.pending.promise.catch(t=>{}),yield LF(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ls,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function LF(n){return new Promise(e=>{setTimeout(e,n)})}var FF={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},oi=new Dn("appCheck","AppCheck",FF);function OC(n){if(!On(n).activated)throw oi.create("use-before-activation",{appName:n.name})}function NC(r,i){return E(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let p=yield o.getHeartbeatsHeader();p&&(s["X-Firebase-Client"]=p)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(p){throw oi.create("fetch-network-error",{originalErrorMessage:p?.message})}if(c.status!==200)throw oi.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(p){throw oi.create("fetch-parse-error",{originalErrorMessage:p?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw oi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function kC(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${MF}/projects/${t}/apps/${r}:${xF}?key=${i}`,body:{debug_token:e}}}var BF="firebase-app-check-database",UF=1,Im="firebase-app-check-store";var dd=null;function VF(){return dd||(dd=new Promise((n,e)=>{try{let t=indexedDB.open(BF,UF);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(oi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Im,{keyPath:"compositeKey"})}}}catch(t){e(oi.create("storage-open",{originalErrorMessage:t?.message}))}}),dd)}function qF(n,e){return zF(jF(n),e)}function zF(n,e){return E(this,null,function*(){let r=(yield VF()).transaction(Im,"readwrite"),s=r.objectStore(Im).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(oi.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function jF(n){return`${n.options.appId}-${n.name}`}var Rc=new tr("@firebase/app-check");function wm(n,e){return Cc()?qF(n,e).catch(t=>{Rc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function PC(){return RC().enabled}function MC(){return E(this,null,function*(){let n=RC();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var $F={error:"UNKNOWN_ERROR"};function GF(n){return nd.encodeString(JSON.stringify(n),!1)}function Dm(n,e=!1,t=!1){return E(this,null,function*(){let r=n.app;OC(r);let i=On(r),s=i.token,o;if(s&&!Oc(s)&&(i.token=void 0,s=void 0),!s){let u=yield i.cachedTokenPromise;u&&(Oc(u)?s=u:yield wm(r,void 0))}if(!e&&s&&Oc(s))return{token:s.token};let a=!1;if(PC())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=NC(kC(r,yield MC()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let u=yield i.exchangeTokenPromise;return yield wm(r,u),i.token=u,{token:u.token}}catch(u){return u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Rc.warn(u.message):t&&Rc.error(u),bm(u)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=yield On(r).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Rc.warn(u.message):t&&Rc.error(u),o=u}let c;return s?o?Oc(s)?c={token:s.token,internalError:o}:c=bm(o):(c={token:s.token},i.token=s,yield wm(r,s)):c=bm(o),a&&QF(r,c),c})}function HF(n){return E(this,null,function*(){let e=n.app;OC(e);let{provider:t}=On(e);if(PC()){let r=yield MC(),{token:i}=yield NC(kC(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function WF(n,e,t,r){let{app:i}=n,s=On(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Oc(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),DC(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>DC(n))}function xC(n,e){let t=On(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function DC(n){let{app:e}=n,t=On(e),r=t.tokenRefresher;r||(r=KF(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function KF(n){let{app:e}=n;return new Cm(()=>E(null,null,function*(){let t=On(e),r;if(t.token?r=yield Dm(n,!0):r=yield Dm(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=On(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},IC.RETRIAL_MIN_WAIT,IC.RETRIAL_MAX_WAIT)}function QF(n,e){let t=On(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Oc(n){return n.expireTimeMillis-Date.now()>0}function bm(n){return{token:GF($F),error:n}}var Am=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=On(this.app);for(let t of e)xC(this.app,t.next);return Promise.resolve()}};function YF(n,e){return new Am(n,e)}function JF(n){return{getToken:e=>Dm(n,e),getLimitedUseToken:()=>HF(n),addTokenListener:e=>WF(n,"INTERNAL",e),removeTokenListener:e=>xC(n.app,e)}}var XF="@firebase/app-check",ZF="0.10.1";var e2="app-check",AC="app-check-internal";function t2(){Rn(new Ot(e2,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return YF(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(AC).initialize()})),Rn(new Ot(AC,n=>{let e=n.getProvider("app-check").getImmediate();return JF(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Fe(XF,ZF)}t2();var n2="app-check";var Do=class{constructor(){return Io(n2)}};var r2=["localhost","0.0.0.0","127.0.0.1"],cJ=typeof window<"u"&&r2.includes(window.location.hostname);function GC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var HC=GC,WC=new Dn("auth","Firebase",GC());var pd=new tr("@firebase/auth");function i2(n,...e){pd.logLevel<=ce.WARN&&pd.warn(`Auth (${bo}): ${n}`,...e)}function fd(n,...e){pd.logLevel<=ce.ERROR&&pd.error(`Auth (${bo}): ${n}`,...e)}function ys(n,...e){throw Qm(n,...e)}function Km(n,...e){return Qm(n,...e)}function KC(n,e,t){let r=Object.assign(Object.assign({},HC()),{[e]:t});return new Dn("auth","Firebase",r).create(e,{appName:n.name})}function ui(n){return KC(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qm(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return WC.create(n,...e)}function le(n,e,...t){if(!n)throw Qm(e,...t)}function Rr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw fd(e),new Error(e)}function gd(n,e){n||Rr(e)}function s2(){return LC()==="http:"||LC()==="https:"}function LC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function o2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s2()||sC()||"connection"in navigator)?navigator.onLine:!0}function a2(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var km=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,gd(t>e,"Short delay should be less than long delay!"),this.isMobile=rC()||oC()}get(){return o2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function c2(n,e){gd(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Mc=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var u2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var l2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],d2=new km(3e4,6e4);function li(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function vs(s,o,a,c){return E(this,arguments,function*(n,e,t,r,i={}){return QC(n,i,()=>E(null,null,function*(){let u={},l={};r&&(e==="GET"?l=r:u={body:JSON.stringify(r)});let d=od(Object.assign({key:n.config.apiKey},l)).slice(1),h=yield n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);let p=Object.assign({method:e,headers:h},u);return iC()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&ds(n.emulatorConfig.host)&&(p.credentials="include"),Mc.fetch()(yield YC(n,n.config.apiHost,t,d),p)}))})}function QC(n,e,t){return E(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},u2),e);try{let i=new Pm(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw hd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw hd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw hd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw hd(n,"user-disabled",o);let l=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw KC(n,l,u);ys(n,l)}}catch(i){if(i instanceof Gt)throw i;ys(n,"network-request-failed",{message:String(i)})}})}function Bc(s,o,a,c){return E(this,arguments,function*(n,e,t,r,i={}){let u=yield vs(n,e,t,r,i);return"mfaPendingCredential"in u&&ys(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function YC(n,e,t,r){return E(this,null,function*(){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?c2(n.config,i):`${n.config.apiScheme}://${i}`;return l2.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o})}function h2(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Pm=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Km(this.auth,"network-request-failed")),d2.get())})}};function hd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Km(n,e,r);return i.customData._tokenResponse=t,i}function FC(n){return n!==void 0&&n.enterprise!==void 0}var Mm=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return h2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function f2(n,e){return E(this,null,function*(){return vs(n,"GET","/v2/recaptchaConfig",li(n,e))})}function p2(n,e){return E(this,null,function*(){return vs(n,"POST","/v1/accounts:delete",e)})}function md(n,e){return E(this,null,function*(){return vs(n,"POST","/v1/accounts:lookup",e)})}function kc(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Ym(n,e=!1){return E(this,null,function*(){let t=Qe(n),r=yield t.getIdToken(e),i=JC(r);le(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:kc(Rm(i.auth_time)),issuedAtTime:kc(Rm(i.iat)),expirationTime:kc(Rm(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Rm(n){return Number(n)*1e3}function JC(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return fd("JWT malformed, contained fewer than 3 sections"),null;try{let i=rd(t);return i?JSON.parse(i):(fd("Failed to decode base64 JWT payload"),null)}catch(i){return fd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function BC(n){let e=JC(n);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function xm(n,e,t=!1){return E(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Gt&&g2(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function g2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Lm=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>E(this,null,function*(){yield this.iteration()}),t)}iteration(){return E(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var xc=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function yd(n){return E(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield xm(n,md(t,{idToken:r}));le(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?XC(s.providerUserInfo):[],a=m2(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,l=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new xc(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(n,d)})}function Jm(n){return E(this,null,function*(){let e=Qe(n);yield yd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function m2(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function XC(n){return n.map(e=>{var{providerId:t}=e,r=Qu(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function y2(n,e){return E(this,null,function*(){let t=yield QC(n,{},()=>E(null,null,function*(){let r=od({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=yield YC(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&ds(n.emulatorConfig.host)&&(c.credentials="include"),Mc.fetch()(o,c)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function v2(n,e){return E(this,null,function*(){return vs(n,"POST","/v2/accounts:revokeToken",li(n,e))})}var Pc=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):BC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){le(e.length!==0,"internal-error");let t=BC(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return E(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return E(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield y2(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(le(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(le(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(le(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Rr("not implemented")}};function ai(n,e){le(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ci=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Qu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new xc(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return E(this,null,function*(){let t=yield xm(this,this.stsTokenManager.getToken(this.auth,e));return le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Ym(this,e)}reload(){return Jm(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return E(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield yd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return E(this,null,function*(){if(Wt(this.auth.app))return Promise.reject(ui(this.auth));let e=yield this.getIdToken();return yield xm(this,p2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,l;let d=(r=t.displayName)!==null&&r!==void 0?r:void 0,h=(i=t.email)!==null&&i!==void 0?i:void 0,p=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,b=(a=t.tenantId)!==null&&a!==void 0?a:void 0,w=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,D=(u=t.createdAt)!==null&&u!==void 0?u:void 0,x=(l=t.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:k,emailVerified:I,isAnonymous:G,providerData:V,stsTokenManager:T}=t;le(k&&T,e,"internal-error");let y=Pc.fromJSON(this.name,T);le(typeof k=="string",e,"internal-error"),ai(d,e.name),ai(h,e.name),le(typeof I=="boolean",e,"internal-error"),le(typeof G=="boolean",e,"internal-error"),ai(p,e.name),ai(S,e.name),ai(b,e.name),ai(w,e.name),ai(D,e.name),ai(x,e.name);let v=new n({uid:k,auth:e,email:h,emailVerified:I,displayName:d,isAnonymous:G,photoURL:S,phoneNumber:p,tenantId:b,stsTokenManager:y,createdAt:D,lastLoginAt:x});return V&&Array.isArray(V)&&(v.providerData=V.map(_=>Object.assign({},_))),w&&(v._redirectEventId=w),v}static _fromIdTokenResponse(e,t,r=!1){return E(this,null,function*(){let i=new Pc;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield yd(s),s})}static _fromGetAccountInfoResponse(e,t,r){return E(this,null,function*(){let i=t.users[0];le(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?XC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Pc;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new xc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c})}};var UC=new Map;function ms(n){gd(n instanceof Function,"Expected a class definition");let e=UC.get(n);return e?(gd(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,UC.set(n,e),e)}var E2=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return E(this,null,function*(){return!0})}_set(t,r){return E(this,null,function*(){this.storage[t]=r})}_get(t){return E(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return E(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Fm=E2;function Om(n,e,t){return`firebase:${n}:${e}:${t}`}var vd=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Om(this.userKey,i.apiKey,s),this.fullPersistenceKey=Om("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return E(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield md(this.auth,{idToken:e}).catch(()=>{});return t?ci._fromGetAccountInfoResponse(this.auth,t,e):null}return ci._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return E(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return E(this,null,function*(){if(!t.length)return new n(ms(Fm),e,r);let i=(yield Promise.all(t.map(u=>E(null,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||ms(Fm),o=Om(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let l=yield u._get(o);if(l){let d;if(typeof l=="string"){let h=yield md(e,{idToken:l}).catch(()=>{});if(!h)break;d=yield ci._fromGetAccountInfoResponse(e,h,l)}else d=ci._fromJSON(e,l);u!==s&&(a=d),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(u=>E(null,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,r))})}};function VC(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(w2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(C2(e))return"Blackberry";if(I2(e))return"Webos";if(T2(e))return"Safari";if((e.includes("chrome/")||S2(e))&&!e.includes("edge/"))return"Chrome";if(b2(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function _2(n=Ht()){return/firefox\//i.test(n)}function T2(n=Ht()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function S2(n=Ht()){return/crios\//i.test(n)}function w2(n=Ht()){return/iemobile/i.test(n)}function b2(n=Ht()){return/android/i.test(n)}function C2(n=Ht()){return/blackberry/i.test(n)}function I2(n=Ht()){return/webos/i.test(n)}function ZC(n,e=[]){let t;switch(n){case"Browser":t=VC(Ht());break;case"Worker":t=`${VC(Ht())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bo}/${r}`}var Bm=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return E(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function D2(t){return E(this,arguments,function*(n,e={}){return vs(n,"GET","/v2/passwordPolicy",li(n,e))})}var A2=6,Um=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:A2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Ed=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _d(this),this.idTokenSubscription=new _d(this),this.beforeStateQueue=new Bm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ms(t)),this._initializationPromise=this.queue(()=>E(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield vd.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return E(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return E(this,null,function*(){try{let t=yield md(this,{idToken:e}),r=yield ci._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return E(this,null,function*(){var t;if(Wt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return E(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return E(this,null,function*(){try{yield yd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=a2()}_delete(){return E(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return E(this,null,function*(){if(Wt(this.app))return Promise.reject(ui(this));let t=e?Qe(e):null;return t&&le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return E(this,null,function*(){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>E(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return E(this,null,function*(){return Wt(this.app)?Promise.reject(ui(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Wt(this.app)?Promise.reject(ui(this)):this.queue(()=>E(this,null,function*(){yield this.assertedPersistence.setPersistence(ms(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return E(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return E(this,null,function*(){let e=yield D2(this),t=new Um(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Dn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return E(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield v2(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return E(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return E(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ms(e)||this._popupRedirectResolver;le(t,this,"argument-error"),this.redirectPersistenceManager=yield vd.create(this,[ms(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return E(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>E(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return E(this,null,function*(){if(e===this.currentUser)return this.queue(()=>E(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return E(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return E(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return E(this,null,function*(){var e;if(Wt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&i2(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Es(n){return Qe(n)}var _d=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=uC(t=>this.observer=t)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var eI={loadJS(){return E(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R2(n){return eI.loadJS(n)}function O2(){return eI.recaptchaEnterpriseScript}var Vm=class{constructor(){this.enterprise=new qm}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},qm=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},N2="recaptcha-enterprise",tI="NO_RECAPTCHA",zm=class{constructor(e){this.type=N2,this.auth=Es(e)}verify(e="verify",t=!1){return E(this,null,function*(){function r(s){return E(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>E(null,null,function*(){f2(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new Mm(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;FC(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(tI)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Vm().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&FC(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=O2();c.length!==0&&(c+=a),R2(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})})}};function Nc(n,e,t,r=!1,i=!1){return E(this,null,function*(){let s=new zm(n),o;if(i)o=tI;else try{o=yield s.verify(t)}catch{o=yield s.verify(t,!0)}let a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){let c=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){let c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function jm(n,e,t,r,i){return E(this,null,function*(){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let a=yield Nc(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(a=>E(null,null,function*(){if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let c=yield Nc(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(a)}));else if(i==="PHONE_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){let a=yield Nc(n,e,t);return r(n,a).catch(c=>E(null,null,function*(){var u;if(((u=n._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let l=yield Nc(n,e,t,!1,!0);return r(n,l)}return Promise.reject(c)}))}else{let a=yield Nc(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(i+" provider is not supported.")})}function Xm(n,e){let t=wo(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(er(s,e??{}))return i;ys(i,"already-initialized")}return t.initialize({options:e})}function k2(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ms);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Zm(n,e,t){let r=Es(n);le(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=nI(e),{host:o,port:a}=P2(e),c=a===null?"":`:${a}`,u={url:`${s}//${o}${c}/`},l=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){le(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),le(er(u,r.config.emulator)&&er(l,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,ds(o)?(id(`${s}//${o}${c}`),sd("Auth",!0)):i||M2()}function nI(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function P2(n){let e=nI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:qC(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:qC(o)}}}function qC(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function M2(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Lc=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Rr("not implemented")}_getIdTokenResponse(e){return Rr("not implemented")}_linkToIdToken(e,t){return Rr("not implemented")}_getReauthenticationResolver(e){return Rr("not implemented")}};function x2(n,e){return E(this,null,function*(){return vs(n,"POST","/v1/accounts:signUp",e)})}function L2(n,e){return E(this,null,function*(){return Bc(n,"POST","/v1/accounts:signInWithPassword",li(n,e))})}function F2(n,e){return E(this,null,function*(){return Bc(n,"POST","/v1/accounts:signInWithEmailLink",li(n,e))})}function B2(n,e){return E(this,null,function*(){return Bc(n,"POST","/v1/accounts:signInWithEmailLink",li(n,e))})}var Fc=class n extends Lc{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return E(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jm(e,t,"signInWithPassword",L2,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return F2(e,{email:this._email,oobCode:this._password});default:ys(e,"internal-error")}})}_linkToIdToken(e,t){return E(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jm(e,r,"signUpPassword",x2,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return B2(e,{idToken:t,email:this._email,oobCode:this._password});default:ys(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Nm(n,e){return E(this,null,function*(){return Bc(n,"POST","/v1/accounts:signInWithIdp",li(n,e))})}var U2="http://localhost",Td=class n extends Lc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ys("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Qu(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Nm(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Nm(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Nm(e,t)}buildRequest(){let e={requestUri:U2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=od(t)}return e}};function V2(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function q2(n){let e=To(So(n)).link,t=e?To(So(e)).deep_link_id:null,r=To(So(n)).deep_link_id;return(r?To(So(r)).link:null)||r||t||e||n}var Sd=class n{constructor(e){var t,r,i,s,o,a;let c=To(So(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,l=(r=c.oobCode)!==null&&r!==void 0?r:null,d=V2((i=c.mode)!==null&&i!==void 0?i:null);le(u&&l&&d,"argument-error"),this.apiKey=u,this.operation=d,this.code=l,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=q2(e);try{return new n(t)}catch{return null}}};var rI=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Fc._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Sd.parseLink(r);return le(i,"argument-error"),Fc._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),$m=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Gm=class extends $m{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ey=(()=>{class n extends Gm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Td._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();function iI(n,e){return E(this,null,function*(){return Bc(n,"POST","/v1/accounts:signUp",li(n,e))})}var Ao=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return E(this,null,function*(){let s=yield ci._fromIdTokenResponse(e,r,i),o=zC(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return E(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=zC(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function zC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function ty(n){return E(this,null,function*(){var e;if(Wt(n.app))return Promise.reject(ui(n));let t=Es(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ao({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield iI(t,{returnSecureToken:!0}),i=yield Ao._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var Hm=class n extends Gt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function z2(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Hm._fromErrorAndOperation(n,s,e,r):s})}function j2(n,e,t=!1){return E(this,null,function*(){if(Wt(n.app))return Promise.reject(ui(n));let r="signIn",i=yield z2(n,r,e),s=yield Ao._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function bd(n,e){return E(this,null,function*(){return j2(Es(n),e)})}function sI(n){return E(this,null,function*(){let e=Es(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function ny(n,e,t){return E(this,null,function*(){if(Wt(n.app))return Promise.reject(ui(n));let r=Es(n),o=yield jm(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iI,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&sI(n),c}),a=yield Ao._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function ry(n,e,t){return Wt(n.app)?Promise.reject(ui(n)):bd(Qe(n),rI.credential(e,t)).catch(r=>E(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&sI(n),r}))}function Cd(n,e,t,r){return Qe(n).onAuthStateChanged(e,t,r)}function iy(n){return Qe(n).signOut()}var jC="@firebase/auth",$C="1.10.8";var Wm=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return E(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function $2(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G2(n){Rn(new Ot("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;le(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZC(n)},u=new Ed(r,i,s,c);return k2(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Rn(new Ot("auth-internal",e=>{let t=Es(e.getProvider("auth").getImmediate());return(r=>new Wm(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fe(jC,$C,$2(n)),Fe(jC,$C,"esm2017")}Mc.initialize(fetch,Headers,Response);function sy(n=fs()){let e=wo(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Xm(n),r=im("auth");return r&&Zm(t,`http://${r}`),t}G2("Node");var oI=Km("operation-not-supported-in-this-environment");function aI(){return E(this,null,function*(){throw oI})}var wd=class{constructor(){throw oI}};var oy=wd,ay=aI;var cy=aI;var uy=wd;Ed.prototype.setPersistence=()=>E(null,null,function*(){});function lI(n){return new nn(function(e){var t=Cd(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var dI="auth",_s=class{constructor(e){return e}},Uc=class{constructor(){return Io(dI)}};var ly=new X("angularfire2.auth-instances");function OB(n,e){let t=Ac(dI,n,e);return t&&new _s(t)}function NB(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new _s(r)}}var kB={provide:Uc,deps:[[new qt,ly]]},PB={provide:_s,useFactory:OB,deps:[[new qt,ly],Ar]};function cX(n,...e){return Fe("angularfire",ii.full,"auth"),rn([PB,kB,{provide:ly,useFactory:NB(n),multi:!0,deps:[ze,Rt,si,gs,[new qt,Do],...e]}])}var hI=De(lI,!0);var fI=De(ny,!0,2);var uX=De(sy,!0);var pI=De(ty,!0,2),gI=De(bd,!0,2);var mI=De(ry,!0,2);var yI=De(ay,!0,2),vI=De(cy,!0,2);var EI=De(iy,!0,2);import{TextEncoder as Xj,inspect as Zj,TextDecoder as Iee}from"util";var _I=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},TI={};var Or,dy;(function(){var n;function e(T,y){function v(){}v.prototype=y.prototype,T.D=y.prototype,T.prototype=new v,T.prototype.constructor=T,T.C=function(_,g,C){for(var f=Array(arguments.length-2),m=2;m<arguments.length;m++)f[m-2]=arguments[m];return y.prototype[g].apply(_,f)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,y,v){v||(v=0);var _=Array(16);if(typeof y=="string")for(var g=0;16>g;++g)_[g]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(g=0;16>g;++g)_[g]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=T.g[0],v=T.g[1],g=T.g[2];var C=T.g[3],f=y+(C^v&(g^C))+_[0]+3614090360&4294967295;y=v+(f<<7&4294967295|f>>>25),f=C+(g^y&(v^g))+_[1]+3905402710&4294967295,C=y+(f<<12&4294967295|f>>>20),f=g+(v^C&(y^v))+_[2]+606105819&4294967295,g=C+(f<<17&4294967295|f>>>15),f=v+(y^g&(C^y))+_[3]+3250441966&4294967295,v=g+(f<<22&4294967295|f>>>10),f=y+(C^v&(g^C))+_[4]+4118548399&4294967295,y=v+(f<<7&4294967295|f>>>25),f=C+(g^y&(v^g))+_[5]+1200080426&4294967295,C=y+(f<<12&4294967295|f>>>20),f=g+(v^C&(y^v))+_[6]+2821735955&4294967295,g=C+(f<<17&4294967295|f>>>15),f=v+(y^g&(C^y))+_[7]+4249261313&4294967295,v=g+(f<<22&4294967295|f>>>10),f=y+(C^v&(g^C))+_[8]+1770035416&4294967295,y=v+(f<<7&4294967295|f>>>25),f=C+(g^y&(v^g))+_[9]+2336552879&4294967295,C=y+(f<<12&4294967295|f>>>20),f=g+(v^C&(y^v))+_[10]+4294925233&4294967295,g=C+(f<<17&4294967295|f>>>15),f=v+(y^g&(C^y))+_[11]+2304563134&4294967295,v=g+(f<<22&4294967295|f>>>10),f=y+(C^v&(g^C))+_[12]+1804603682&4294967295,y=v+(f<<7&4294967295|f>>>25),f=C+(g^y&(v^g))+_[13]+4254626195&4294967295,C=y+(f<<12&4294967295|f>>>20),f=g+(v^C&(y^v))+_[14]+2792965006&4294967295,g=C+(f<<17&4294967295|f>>>15),f=v+(y^g&(C^y))+_[15]+1236535329&4294967295,v=g+(f<<22&4294967295|f>>>10),f=y+(g^C&(v^g))+_[1]+4129170786&4294967295,y=v+(f<<5&4294967295|f>>>27),f=C+(v^g&(y^v))+_[6]+3225465664&4294967295,C=y+(f<<9&4294967295|f>>>23),f=g+(y^v&(C^y))+_[11]+643717713&4294967295,g=C+(f<<14&4294967295|f>>>18),f=v+(C^y&(g^C))+_[0]+3921069994&4294967295,v=g+(f<<20&4294967295|f>>>12),f=y+(g^C&(v^g))+_[5]+3593408605&4294967295,y=v+(f<<5&4294967295|f>>>27),f=C+(v^g&(y^v))+_[10]+38016083&4294967295,C=y+(f<<9&4294967295|f>>>23),f=g+(y^v&(C^y))+_[15]+3634488961&4294967295,g=C+(f<<14&4294967295|f>>>18),f=v+(C^y&(g^C))+_[4]+3889429448&4294967295,v=g+(f<<20&4294967295|f>>>12),f=y+(g^C&(v^g))+_[9]+568446438&4294967295,y=v+(f<<5&4294967295|f>>>27),f=C+(v^g&(y^v))+_[14]+3275163606&4294967295,C=y+(f<<9&4294967295|f>>>23),f=g+(y^v&(C^y))+_[3]+4107603335&4294967295,g=C+(f<<14&4294967295|f>>>18),f=v+(C^y&(g^C))+_[8]+1163531501&4294967295,v=g+(f<<20&4294967295|f>>>12),f=y+(g^C&(v^g))+_[13]+2850285829&4294967295,y=v+(f<<5&4294967295|f>>>27),f=C+(v^g&(y^v))+_[2]+4243563512&4294967295,C=y+(f<<9&4294967295|f>>>23),f=g+(y^v&(C^y))+_[7]+1735328473&4294967295,g=C+(f<<14&4294967295|f>>>18),f=v+(C^y&(g^C))+_[12]+2368359562&4294967295,v=g+(f<<20&4294967295|f>>>12),f=y+(v^g^C)+_[5]+4294588738&4294967295,y=v+(f<<4&4294967295|f>>>28),f=C+(y^v^g)+_[8]+2272392833&4294967295,C=y+(f<<11&4294967295|f>>>21),f=g+(C^y^v)+_[11]+1839030562&4294967295,g=C+(f<<16&4294967295|f>>>16),f=v+(g^C^y)+_[14]+4259657740&4294967295,v=g+(f<<23&4294967295|f>>>9),f=y+(v^g^C)+_[1]+2763975236&4294967295,y=v+(f<<4&4294967295|f>>>28),f=C+(y^v^g)+_[4]+1272893353&4294967295,C=y+(f<<11&4294967295|f>>>21),f=g+(C^y^v)+_[7]+4139469664&4294967295,g=C+(f<<16&4294967295|f>>>16),f=v+(g^C^y)+_[10]+3200236656&4294967295,v=g+(f<<23&4294967295|f>>>9),f=y+(v^g^C)+_[13]+681279174&4294967295,y=v+(f<<4&4294967295|f>>>28),f=C+(y^v^g)+_[0]+3936430074&4294967295,C=y+(f<<11&4294967295|f>>>21),f=g+(C^y^v)+_[3]+3572445317&4294967295,g=C+(f<<16&4294967295|f>>>16),f=v+(g^C^y)+_[6]+76029189&4294967295,v=g+(f<<23&4294967295|f>>>9),f=y+(v^g^C)+_[9]+3654602809&4294967295,y=v+(f<<4&4294967295|f>>>28),f=C+(y^v^g)+_[12]+3873151461&4294967295,C=y+(f<<11&4294967295|f>>>21),f=g+(C^y^v)+_[15]+530742520&4294967295,g=C+(f<<16&4294967295|f>>>16),f=v+(g^C^y)+_[2]+3299628645&4294967295,v=g+(f<<23&4294967295|f>>>9),f=y+(g^(v|~C))+_[0]+4096336452&4294967295,y=v+(f<<6&4294967295|f>>>26),f=C+(v^(y|~g))+_[7]+1126891415&4294967295,C=y+(f<<10&4294967295|f>>>22),f=g+(y^(C|~v))+_[14]+2878612391&4294967295,g=C+(f<<15&4294967295|f>>>17),f=v+(C^(g|~y))+_[5]+4237533241&4294967295,v=g+(f<<21&4294967295|f>>>11),f=y+(g^(v|~C))+_[12]+1700485571&4294967295,y=v+(f<<6&4294967295|f>>>26),f=C+(v^(y|~g))+_[3]+2399980690&4294967295,C=y+(f<<10&4294967295|f>>>22),f=g+(y^(C|~v))+_[10]+4293915773&4294967295,g=C+(f<<15&4294967295|f>>>17),f=v+(C^(g|~y))+_[1]+2240044497&4294967295,v=g+(f<<21&4294967295|f>>>11),f=y+(g^(v|~C))+_[8]+1873313359&4294967295,y=v+(f<<6&4294967295|f>>>26),f=C+(v^(y|~g))+_[15]+4264355552&4294967295,C=y+(f<<10&4294967295|f>>>22),f=g+(y^(C|~v))+_[6]+2734768916&4294967295,g=C+(f<<15&4294967295|f>>>17),f=v+(C^(g|~y))+_[13]+1309151649&4294967295,v=g+(f<<21&4294967295|f>>>11),f=y+(g^(v|~C))+_[4]+4149444226&4294967295,y=v+(f<<6&4294967295|f>>>26),f=C+(v^(y|~g))+_[11]+3174756917&4294967295,C=y+(f<<10&4294967295|f>>>22),f=g+(y^(C|~v))+_[2]+718787259&4294967295,g=C+(f<<15&4294967295|f>>>17),f=v+(C^(g|~y))+_[9]+3951481745&4294967295,T.g[0]=T.g[0]+y&4294967295,T.g[1]=T.g[1]+(g+(f<<21&4294967295|f>>>11))&4294967295,T.g[2]=T.g[2]+g&4294967295,T.g[3]=T.g[3]+C&4294967295}r.prototype.u=function(T,y){y===void 0&&(y=T.length);for(var v=y-this.blockSize,_=this.B,g=this.h,C=0;C<y;){if(g==0)for(;C<=v;)i(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<y;)if(_[g++]=T.charCodeAt(C++),g==this.blockSize){i(this,_),g=0;break}}else for(;C<y;)if(_[g++]=T[C++],g==this.blockSize){i(this,_),g=0;break}}this.h=g,this.o+=y},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var y=1;y<T.length-8;++y)T[y]=0;var v=8*this.o;for(y=T.length-8;y<T.length;++y)T[y]=v&255,v/=256;for(this.u(T),T=Array(16),y=v=0;4>y;++y)for(var _=0;32>_;_+=8)T[v++]=this.g[y]>>>_&255;return T};function s(T,y){var v=a;return Object.prototype.hasOwnProperty.call(v,T)?v[T]:v[T]=y(T)}function o(T,y){this.h=y;for(var v=[],_=!0,g=T.length-1;0<=g;g--){var C=T[g]|0;_&&C==y||(v[g]=C,_=!1)}this.g=v}var a={};function c(T){return-128<=T&&128>T?s(T,function(y){return new o([y|0],0>y?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return w(u(-T));for(var y=[],v=1,_=0;T>=v;_++)y[_]=T/v|0,v*=4294967296;return new o(y,0)}function l(T,y){if(T.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(T.charAt(0)=="-")return w(l(T.substring(1),y));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=u(Math.pow(y,8)),_=d,g=0;g<T.length;g+=8){var C=Math.min(8,T.length-g),f=parseInt(T.substring(g,g+C),y);8>C?(C=u(Math.pow(y,C)),_=_.j(C).add(u(f))):(_=_.j(v),_=_.add(u(f)))}return _}var d=c(0),h=c(1),p=c(16777216);n=o.prototype,n.m=function(){if(b(this))return-w(this).m();for(var T=0,y=1,v=0;v<this.g.length;v++){var _=this.i(v);T+=(0<=_?_:4294967296+_)*y,y*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(b(this))return"-"+w(this).toString(T);for(var y=u(Math.pow(T,6)),v=this,_="";;){var g=I(v,y).g;v=D(v,g.j(y));var C=((0<v.g.length?v.g[0]:v.h)>>>0).toString(T);if(v=g,S(v))return C+_;for(;6>C.length;)C="0"+C;_=C+_}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(var y=0;y<T.g.length;y++)if(T.g[y]!=0)return!1;return!0}function b(T){return T.h==-1}n.l=function(T){return T=D(this,T),b(T)?-1:S(T)?0:1};function w(T){for(var y=T.g.length,v=[],_=0;_<y;_++)v[_]=~T.g[_];return new o(v,~T.h).add(h)}n.abs=function(){return b(this)?w(this):this},n.add=function(T){for(var y=Math.max(this.g.length,T.g.length),v=[],_=0,g=0;g<=y;g++){var C=_+(this.i(g)&65535)+(T.i(g)&65535),f=(C>>>16)+(this.i(g)>>>16)+(T.i(g)>>>16);_=f>>>16,C&=65535,f&=65535,v[g]=f<<16|C}return new o(v,v[v.length-1]&-2147483648?-1:0)};function D(T,y){return T.add(w(y))}n.j=function(T){if(S(this)||S(T))return d;if(b(this))return b(T)?w(this).j(w(T)):w(w(this).j(T));if(b(T))return w(this.j(w(T)));if(0>this.l(p)&&0>T.l(p))return u(this.m()*T.m());for(var y=this.g.length+T.g.length,v=[],_=0;_<2*y;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var g=0;g<T.g.length;g++){var C=this.i(_)>>>16,f=this.i(_)&65535,m=T.i(g)>>>16,L=T.i(g)&65535;v[2*_+2*g]+=f*L,x(v,2*_+2*g),v[2*_+2*g+1]+=C*L,x(v,2*_+2*g+1),v[2*_+2*g+1]+=f*m,x(v,2*_+2*g+1),v[2*_+2*g+2]+=C*m,x(v,2*_+2*g+2)}for(_=0;_<y;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=y;_<2*y;_++)v[_]=0;return new o(v,0)};function x(T,y){for(;(T[y]&65535)!=T[y];)T[y+1]+=T[y]>>>16,T[y]&=65535,y++}function k(T,y){this.g=T,this.h=y}function I(T,y){if(S(y))throw Error("division by zero");if(S(T))return new k(d,d);if(b(T))return y=I(w(T),y),new k(w(y.g),w(y.h));if(b(y))return y=I(T,w(y)),new k(w(y.g),y.h);if(30<T.g.length){if(b(T)||b(y))throw Error("slowDivide_ only works with positive integers.");for(var v=h,_=y;0>=_.l(T);)v=G(v),_=G(_);var g=V(v,1),C=V(_,1);for(_=V(_,2),v=V(v,2);!S(_);){var f=C.add(_);0>=f.l(T)&&(g=g.add(v),C=f),_=V(_,1),v=V(v,1)}return y=D(T,g.j(y)),new k(g,y)}for(g=d;0<=T.l(y);){for(v=Math.max(1,Math.floor(T.m()/y.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),C=u(v),f=C.j(y);b(f)||0<f.l(T);)v-=_,C=u(v),f=C.j(y);S(C)&&(C=h),g=g.add(C),T=D(T,f)}return new k(g,T)}n.A=function(T){return I(this,T).h},n.and=function(T){for(var y=Math.max(this.g.length,T.g.length),v=[],_=0;_<y;_++)v[_]=this.i(_)&T.i(_);return new o(v,this.h&T.h)},n.or=function(T){for(var y=Math.max(this.g.length,T.g.length),v=[],_=0;_<y;_++)v[_]=this.i(_)|T.i(_);return new o(v,this.h|T.h)},n.xor=function(T){for(var y=Math.max(this.g.length,T.g.length),v=[],_=0;_<y;_++)v[_]=this.i(_)^T.i(_);return new o(v,this.h^T.h)};function G(T){for(var y=T.g.length+1,v=[],_=0;_<y;_++)v[_]=T.i(_)<<1|T.i(_-1)>>>31;return new o(v,T.h)}function V(T,y){var v=y>>5;y%=32;for(var _=T.g.length-v,g=[],C=0;C<_;C++)g[C]=0<y?T.i(C+v)>>>y|T.i(C+v+1)<<32-y:T.i(C+v);return new o(g,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,dy=TI.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=l,Or=TI.Integer=o}).apply(typeof _I<"u"?_I:typeof self<"u"?self:typeof window<"u"?window:{});var xs=XS(zO(),1),ON=XS(aE(),1);import{randomBytes as e$}from"crypto";var jO="@firebase/firestore",$O="4.8.0";var ht=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ht.UNAUTHENTICATED=new ht(null);ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid");ht.FIRST_PARTY=new ht("first-party-uid");ht.MOCK_USER=new ht("mock-user");var t$="11.10.0";var ka=t$;function n$(n){ka=n}function r$(n){return Zj(n,{depth:100})}var Ls=new tr("@firebase/firestore");function fa(){return Ls.logLevel}function z(n,...e){if(Ls.logLevel<=ce.DEBUG){let t=e.map(gS);Ls.debug(`Firestore (${ka}): ${n}`,...t)}}function qn(n,...e){if(Ls.logLevel<=ce.ERROR){let t=e.map(gS);Ls.error(`Firestore (${ka}): ${n}`,...t)}}function Fi(n,...e){if(Ls.logLevel<=ce.WARN){let t=e.map(gS);Ls.warn(`Firestore (${ka}): ${n}`,...t)}}function gS(n){if(typeof n=="string")return n;try{return r$(n)}catch{return n}}function J(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,NN(n,r,t)}function NN(n,e,t){let r=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{let i=JSON.stringify(t);r+=" CONTEXT: "+i}catch{r+=" CONTEXT: "+t}throw qn(r),new Error(r)}function Ee(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||NN(e,i,r)}function ee(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},B=class extends Gt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Df=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},B_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ht.UNAUTHENTICATED))}shutdown(){}},U_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},V_=class{constructor(e){this.authProvider=e,this.currentUser=ht.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ee(this.tokenListener===void 0,42304);let r=this.tokenCounter,i=c=>this.tokenCounter!==r?(r=this.tokenCounter,t(c)):Promise.resolve(),s=new vn;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new vn,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>E(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),o())};this.authProvider.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.authProvider.getImmediate({optional:!0});c?a(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vn)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.tokenCounter!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ee(typeof r.accessToken=="string",31837,{tokenData:r}),new Df(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string",2055,{currentUid:e}),new ht(e)}},q_=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},z_=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new q_(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Af=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},j_=class{constructor(e,t){this.appCheckProvider=t,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,Wt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken)}start(e,t){Ee(this.tokenListener===void 0,3512);let r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new Af(this.serverAppAppCheckToken));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ee(typeof t.token=="string",44558,{tokenResult:t}),this.latestAppCheckToken=t.token,new Af(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function i$(n){if(!n)return new B_;switch(n.type){case"firstParty":return new z_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new B(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function s$(n){return e$(n)}function mS(){return new Xj}var Ea=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let s=s$(40);for(let o=0;o<s.length;++o)r.length<i&&s[o]<t&&(r+=e.charAt(s[o]%e.length))}return r}};function se(n,e){return n<e?-1:n>e?1:0}function yS(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return se(r,i);{let s=mS(),o=s.encode(GO(n,t)),a=s.encode(GO(e,t)),c=o$(o,a);return c!==0?c:se(r,i)}}t+=r>65535?2:1}return se(n.length,e.length)}function GO(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function o$(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return se(n[t],e[t]);return se(n.length,e.length)}function Fs(n,e,t){return n.length!==e.length?!1:n.every((r,i)=>t(r,e[i]))}var HO="__name__",Rf=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&J(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&J(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return se(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):yS(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Or.fromString(e.substring(4,e.length-2))}},Pe=class n extends Rf{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},a$=/^[_a-zA-Z][_a-zA-Z0-9]*$/,tn=class n extends Rf{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return a$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HO}static keyField(){return new n([HO])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new B(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(!(c==="\\"||c==="."||c==="`"))throw new B(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a==="."&&!o?(s(),i++):(r+=a,i++)}if(s(),o)throw new B(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Pe.fromString(e))}static fromName(e){return new n(Pe.fromString(e).popFirst(5))}static empty(){return new n(Pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new Pe(e.slice()))}};function kN(n,e,t){if(!t)throw new B(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function c$(n,e,t,r){if(e===!0&&r===!0)throw new B(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function WO(n){if(!Q.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function KO(n){if(Q.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function PN(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ap(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=u$(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":J(12329,{type:typeof n})}function u$(n){return n.constructor?n.constructor.name:null}function en(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new B(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ap(n);throw new B(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xe(n,e){let t={typeString:n};return e&&(t.value=e),t}function $u(n,e){if(!PN(n))throw new B(O.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}else if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new B(O.INVALID_ARGUMENT,t);return!0}var QO=-62135596800,YO=1e6,Ue=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-t*1e3)*YO);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<QO)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/YO}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($u(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-QO,t=String(e).padStart(12,"0"),r=String(this.nanoseconds).padStart(9,"0");return t+"."+r}};Ue._jsonSchemaVersion="firestore/timestamp/1.0";Ue._jsonSchema={type:Xe("string",Ue._jsonSchemaVersion),seconds:Xe("number"),nanoseconds:Xe("number")};var te=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ue(0,0))}static max(){return new n(new Ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Au=-1;function l$(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new Ue(t+1,0):new Ue(t,r));return new Bs(i,Q.empty(),e)}function d$(n){return new Bs(n.readTime,n.key,Au)}var Bs=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(te.min(),Q.empty(),Au)}static max(){return new n(te.max(),Q.empty(),Au)}};function h$(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=Q.comparator(n.documentKey,e.documentKey),t!==0)?t:se(n.largestBatchId,e.largestBatchId)}var f$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",$_=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Pa(n){return E(this,null,function*(){if(n.code===O.FAILED_PRECONDITION&&n.message===f$)z("LocalStore","Unexpectedly lost primary lease");else throw n})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function p$(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ma(n){return n.name==="IndexedDbTransactionError"}var Oee=15*1e3,Nee=60*1e3;var vS=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.setPreviousValue(i),this.writeNewSequenceNumber=i=>r.writeSequenceNumber(i))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})(),bf="",g$="",m$="",y$="";function v$(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=JO(e)),e=E$(n.get(t),e);return JO(e)}function E$(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+=bf+m$;break;case bf:t+=bf+y$;break;default:t+=s}}return t}function JO(n){return n+bf+g$}var _$="remoteDocuments";var MN="owner";var xN="mutationQueues";var LN="mutations";var FN="documentMutations",T$="remoteDocumentsV14";var BN="remoteDocumentGlobal";var UN="targets";var VN="targetDocuments";var qN="targetGlobal",zN="collectionParents";var jN="clientMetadata";var $N="bundles";var GN="namedQueries";var S$="indexConfiguration";var w$="indexState";var b$="indexEntries";var HN="documentOverlays";var C$="globals";var I$=[xN,LN,FN,_$,UN,MN,qN,VN],D$=I$,A$=[...D$,jN],R$=[...A$,BN],O$=[...R$,zN],N$=[...O$,$N,GN],kee=[...N$,HN],k$=[xN,LN,FN,T$,UN,MN,qN,VN,jN,BN,zN,$N,GN,HN],P$=k$,M$=[...P$,S$,w$,b$];var Pee=[...M$,C$];function XO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function WN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ve=class n{constructor(e,t){this.comparator=e,this.root=t||Cu.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cu.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ma(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ma(this.root,e,this.comparator,!1)}getReverseIterator(){return new ma(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ma(this.root,e,this.comparator,!0)}},ma=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cu=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,s=this;if(r(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});let t=this.left.check();if(t!==this.right.check())throw J(27949);return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),G_=class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Cu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};Cu.EMPTY=new G_;var dt=class n{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(t!==void 0?r=this.data.getIteratorFrom(t):r=this.data.getIterator();r.hasNext();){let i=r.getNext();if(!e(i.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Of(this.data.getIterator())}getIteratorFrom(e){return new Of(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Of=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var mn=class n{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new n([])}unionWith(e){let t=new dt(tn.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fs(this.fields,e.fields,(t,r)=>t.isEqual(r))}};function x$(n){return Buffer.from(n,"base64").toString("binary")}function L$(n){return Buffer.from(n,"binary").toString("base64")}var bt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=x$(e);return new n(t)}static fromUint8Array(e){let t=F$(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return L$(this.binaryString)}toUint8Array(){return B$(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};bt.EMPTY_BYTE_STRING=new bt("");function F$(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function B$(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var U$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jr(n){if(Ee(!!n,39018),typeof n=="string"){let e=0,t=U$.exec(n);if(Ee(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}else{let e=Me(n.seconds),t=Me(n.nanos);return{seconds:e,nanos:t}}}function Me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function $r(n){return typeof n=="string"?bt.fromBase64String(n):bt.fromUint8Array(n)}var KN="server_timestamp",QN="__type__",YN="__previous_value__",JN="__local_write_time__";function ES(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[QN])===null||t===void 0?void 0:t.stringValue)===KN}function V$(n,e){let t={fields:{[QN]:{stringValue:KN},[JN]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&ES(e)&&(e=cp(e)),e&&(t.fields[YN]=e),{mapValue:t}}function cp(n){let e=n.mapValue.fields[YN];return ES(e)?cp(e):e}function Ru(n){let e=jr(n.mapValue.fields[JN].timestampValue);return new Ue(e.seconds,e.nanos)}var H_=class{constructor(e,t,r,i,s,o,a,c,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=l}},W_="(default)",Nf=class n{constructor(e,t){this.projectId=e,this.database=t||W_}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===W_}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function q$(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new B(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nf(n.options.projectId,e)}var _S=-1;function up(n){return n==null}function Ou(n){return n===0&&1/n===-1/0}function z$(n){return typeof n=="number"&&Number.isInteger(n)&&!Ou(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var TS="__type__",XN="__max__",Tf={mapValue:{fields:{__type__:{stringValue:XN}}}},SS="__vector__",_a="value";function Ui(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ES(n)?4:tk(n)?9007199254740991:ek(n)?10:11:J(28295,{value:n})}function Un(n,e){if(n===e)return!0;let t=Ui(n),r=Ui(e);if(t!==r)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ru(n).isEqual(Ru(e));case 3:return j$(n,e);case 5:return n.stringValue===e.stringValue;case 6:return G$(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return $$(n,e);case 2:return H$(n,e);case 9:return Fs(n.arrayValue.values||[],e.arrayValue.values||[],Un);case 10:case 11:return W$(n,e);case 9007199254740991:return!0;default:return J(52216,{left:n})}}function j$(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=jr(n.timestampValue),r=jr(e.timestampValue);return t.seconds===r.seconds&&t.nanos===r.nanos}function $$(n,e){return Me(n.geoPointValue.latitude)===Me(e.geoPointValue.latitude)&&Me(n.geoPointValue.longitude)===Me(e.geoPointValue.longitude)}function G$(n,e){return $r(n.bytesValue).isEqual($r(e.bytesValue))}function H$(n,e){if("integerValue"in n&&"integerValue"in e)return Me(n.integerValue)===Me(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=Me(n.doubleValue),r=Me(e.doubleValue);return t===r?Ou(t)===Ou(r):isNaN(t)&&isNaN(r)}return!1}function W$(n,e){let t=n.mapValue.fields||{},r=e.mapValue.fields||{};if(XO(t)!==XO(r))return!1;for(let i in t)if(t.hasOwnProperty(i)&&(r[i]===void 0||!Un(t[i],r[i])))return!1;return!0}function Nu(n,e){return(n.values||[]).find(t=>Un(t,e))!==void 0}function Ta(n,e){if(n===e)return 0;let t=Ui(n),r=Ui(e);if(t!==r)return se(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return se(n.booleanValue,e.booleanValue);case 2:return K$(n,e);case 3:return ZO(n.timestampValue,e.timestampValue);case 4:return ZO(Ru(n),Ru(e));case 5:return yS(n.stringValue,e.stringValue);case 6:return J$(n.bytesValue,e.bytesValue);case 7:return Q$(n.referenceValue,e.referenceValue);case 8:return Y$(n.geoPointValue,e.geoPointValue);case 9:return ZN(n.arrayValue,e.arrayValue);case 10:return X$(n.mapValue,e.mapValue);case 11:return Z$(n.mapValue,e.mapValue);default:throw J(23264,{leftType:t})}}function K$(n,e){let t=Me(n.integerValue||n.doubleValue),r=Me(e.integerValue||e.doubleValue);return t<r?-1:t>r?1:t===r?0:isNaN(t)?isNaN(r)?0:-1:1}function ZO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return se(n,e);let t=jr(n),r=jr(e),i=se(t.seconds,r.seconds);return i!==0?i:se(t.nanos,r.nanos)}function Q$(n,e){let t=n.split("/"),r=e.split("/");for(let i=0;i<t.length&&i<r.length;i++){let s=se(t[i],r[i]);if(s!==0)return s}return se(t.length,r.length)}function Y$(n,e){let t=se(Me(n.latitude),Me(e.latitude));return t!==0?t:se(Me(n.longitude),Me(e.longitude))}function J$(n,e){let t=$r(n),r=$r(e);return t.compareTo(r)}function ZN(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Ta(t[i],r[i]);if(s)return s}return se(t.length,r.length)}function X$(n,e){var t,r,i,s;let o=n.fields||{},a=e.fields||{},c=(t=o[_a])===null||t===void 0?void 0:t.arrayValue,u=(r=a[_a])===null||r===void 0?void 0:r.arrayValue,l=se(((i=c?.values)===null||i===void 0?void 0:i.length)||0,((s=u?.values)===null||s===void 0?void 0:s.length)||0);return l!==0?l:ZN(c,u)}function Z$(n,e){if(n===Tf.mapValue&&e===Tf.mapValue)return 0;if(n===Tf.mapValue)return 1;if(e===Tf.mapValue)return-1;let t=n.fields||{},r=Object.keys(t),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){let a=yS(r[o],s[o]);if(a!==0)return a;let c=Ta(t[r[o]],i[s[o]]);if(c!==0)return c}return se(r.length,s.length)}function Sa(n){return wS(n)}function wS(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?t9(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?e9(n.bytesValue):"referenceValue"in n?r9(n.referenceValue):"geoPointValue"in n?n9(n.geoPointValue):"arrayValue"in n?s9(n.arrayValue):"mapValue"in n?i9(n.mapValue):J(61005,{value:n})}function e9(n){return $r(n).toBase64()}function t9(n){let e=jr(n);return`time(${e.seconds},${e.nanos})`}function n9(n){return`geo(${n.latitude},${n.longitude})`}function r9(n){return Q.fromName(n).toString()}function i9(n){let e=Object.keys(n.fields||{}).sort(),t="{",r=!0;for(let i of e)r?r=!1:t+=",",t+=`${i}:${wS(n.fields[i])}`;return t+"}"}function s9(n){let e="[",t=!0;for(let r of n.values||[])t?t=!1:e+=",",e+=wS(r);return e+"]"}function lp(n){switch(Ui(n)){case 0:return 4;case 1:return 4;case 2:return 8;case 3:return 16;case 4:let e=cp(n);return e?16+lp(e):16;case 5:return n.stringValue.length*2;case 6:return $r(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 8:return 16;case 9:return a9(n.arrayValue);case 10:case 11:return o9(n.mapValue);default:throw J(13486,{value:n})}}function o9(n){let e=0;return Hi(n.fields,(t,r)=>{e+=t.length+lp(r)}),e}function a9(n){return(n.values||[]).reduce((e,t)=>e+lp(t),0)}function eN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function K_(n){return!!n&&"integerValue"in n}function c9(n){return!!n&&"doubleValue"in n}function u9(n){return K_(n)||c9(n)}function bS(n){return!!n&&"arrayValue"in n}function tN(n){return!!n&&"nullValue"in n}function nN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cf(n){return!!n&&"mapValue"in n}function ek(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[TS])===null||t===void 0?void 0:t.stringValue)===SS}function Iu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Hi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Iu(r)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Iu(n.arrayValue.values[t]);return e}else return Object.assign({},n)}function tk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===XN}var Mee={mapValue:{fields:{[TS]:{stringValue:SS},[_a]:{arrayValue:{}}}}};var Zt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Cf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let r=this.getFieldsMap(e.popLast());r[e.lastSegment()]=Iu(t)}setAll(e){let t=tn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Iu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Cf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Un(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];(!Cf(i)||!i.mapValue.fields)&&(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hi(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Iu(this.value))}};function nk(n){let e=[];return Hi(n.fields,(t,r)=>{let i=new tn([t]);if(Cf(r)){let o=nk(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new mn(e)}var zn=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,te.min(),te.min(),te.min(),Zt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,te.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,te.min(),te.min(),Zt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,te.min(),te.min(),Zt.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(te.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function l9(n,e,t){let r=e.data.field(n),i=t.data.field(n);return r!==null&&i!==null?Ta(r,i):J(42886)}var wa=class{constructor(e,t){this.position=e,this.inclusive=t}};function rk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField())r=Q.comparator(Q.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);r=Ta(o,a)}if(s.dir==="desc"&&(r=r*-1),r!==0)break}return r}function d9(n,e,t){let r=rk(n,e,t);return n.inclusive?r>=0:r>0}function h9(n,e,t){let r=rk(n,e,t);return n.inclusive?r<=0:r<0}function rN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let r=n.position[t],i=e.position[t];if(!Un(r,i))return!1}return!0}var Us=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function f9(n){return n.field.canonicalString()+n.dir}function p9(n){return`${n.field.canonicalString()} (${n.dir})`}function g9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var kf=class{},Ze=class n extends kf{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Y_(e,t,r):t==="array-contains"?new Z_(e,r):t==="in"?new eT(e,r):t==="not-in"?new tT(e,r):t==="array-contains-any"?new nT(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new J_(e,r):new X_(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ta(t,this.value)):t!==null&&Ui(this.value)===Ui(t)&&this.matchesComparison(Ta(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},jn=class n extends kf{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return ik(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function ik(n){return n.op==="and"}function sk(n){return m9(n)&&ik(n)}function m9(n){for(let e of n.filters)if(e instanceof jn)return!1;return!0}function Q_(n){if(n instanceof Ze)return n.field.canonicalString()+n.op.toString()+Sa(n.value);if(sk(n))return n.filters.map(e=>Q_(e)).join(",");{let e=n.filters.map(t=>Q_(t)).join(",");return`${n.op}(${e})`}}function ok(n,e){if(n instanceof Ze)return y9(n,e);if(n instanceof jn)return v9(n,e);J(19439)}function y9(n,e){return e instanceof Ze&&n.op===e.op&&n.field.isEqual(e.field)&&Un(n.value,e.value)}function v9(n,e){return e instanceof jn&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((r,i,s)=>r&&ok(i,e.filters[s]),!0):!1}function ak(n){return n instanceof Ze?_9(n):n instanceof jn?E9(n):"Filter"}function E9(n){return n.op.toString()+" {"+n.getFilters().map(ak).join(" ,")+"}"}function _9(n){return`${n.field.canonicalString()} ${n.op} ${Sa(n.value)}`}var Y_=class extends Ze{constructor(e,t,r){super(e,t,r),this.key=Q.fromName(r.referenceValue)}matches(e){let t=Q.comparator(e.key,this.key);return this.matchesComparison(t)}},J_=class extends Ze{constructor(e,t){super(e,"in",t),this.keys=ck("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},X_=class extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=ck("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ck(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Q.fromName(r.referenceValue))}var Z_=class extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return bS(t)&&Nu(t.arrayValue,this.value)}},eT=class extends Ze{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Nu(this.value.arrayValue,t)}},tT=class extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nu(this.value.arrayValue,t)}},nT=class extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!bS(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(r=>Nu(this.value.arrayValue,r))}};var rT=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function iN(n,e=null,t=[],r=[],i=null,s=null,o=null){return new rT(n,e,t,r,i,s,o)}function CS(n){let e=ee(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Q_(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>f9(r)).join(","),up(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Sa(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Sa(r)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function T9(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>ak(t)).join(", ")}]`),up(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>p9(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>Sa(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>Sa(t)).join(",")),`Target(${e})`}function IS(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!g9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ok(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!rN(n.startAt,e.startAt)?!1:rN(n.endAt,e.endAt)}function iT(n){return Q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Vi=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function S9(n,e,t,r,i,s,o,a){return new Vi(n,e,t,r,i,s,o,a)}function dp(n){return new Vi(n)}function w9(n,e){return new Vi(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function sN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function b9(n){let e=new dt(tn.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(i=>{i.isInequality()&&(e=e.add(i.field))})}),e}function C9(n){return Q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function uk(n){return n.collectionGroup!==null}function ku(n){let e=ee(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";b9(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new Us(s,r))}),t.has(tn.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new Us(tn.keyField(),r))}return e.memoizedNormalizedOrderBy}function Vn(n){let e=ee(n);return e.memoizedTarget||(e.memoizedTarget=I9(e,ku(n))),e.memoizedTarget}function I9(n,e){if(n.limitType==="F")return iN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Us(i.field,s)});let t=n.endAt?new wa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new wa(n.startAt.position,n.startAt.inclusive):null;return iN(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function DS(n,e){let t=n.filters.concat([e]);return new Vi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function D9(n,e){let t=n.explicitOrderBy.concat([e]);return new Vi(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function sT(n,e,t){return new Vi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hp(n,e){return IS(Vn(n),Vn(e))&&n.limitType===e.limitType}function lk(n){return`${CS(Vn(n))}|lt:${n.limitType}`}function pa(n){return`Query(target=${T9(Vn(n))}; limitType=${n.limitType})`}function fp(n,e){return e.isFoundDocument()&&A9(n,e)&&R9(n,e)&&O9(n,e)&&N9(n,e)}function A9(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):Q.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function R9(n,e){for(let t of ku(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function O9(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function N9(n,e){return!(n.startAt&&!h9(n.startAt,ku(n),e)||n.endAt&&!d9(n.endAt,ku(n),e))}function k9(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function dk(n){return(e,t)=>{let r=!1;for(let i of ku(n)){let s=P9(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function P9(n,e,t){let r=n.field.isKeyField()?Q.comparator(e.key,t.key):l9(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:n.dir})}}var Gr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0){this.inner[r]=[[e,t]],this.innerSize++;return}for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e)){i[s]=[e,t];return}i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hi(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return WN(this.inner)}size(){return this.innerSize}};var M9=new Ve(Q.comparator);function Hr(){return M9}var hk=new Ve(Q.comparator);function bu(...n){let e=hk;for(let t of n)e=e.insert(t.key,t);return e}function x9(){return Pu()}function fk(n){let e=hk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ps(){return Pu()}function pk(){return Pu()}function Pu(){return new Gr(n=>n.toString(),(n,e)=>n.isEqual(e))}var L9=new Ve(Q.comparator);function F9(){return L9}var B9=new dt(Q.comparator);function de(...n){let e=B9;for(let t of n)e=e.add(t);return e}var U9=new dt(se);function V9(){return U9}function AS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ou(e)?"-0":e}}function gk(n){return{integerValue:""+n}}function q9(n,e){return z$(e)?gk(e):AS(n,e)}var ba=class{constructor(){this._=void 0}};function z9(n,e,t){return n instanceof Ca?V$(t,e):n instanceof Vs?yk(n,e):n instanceof qs?vk(n,e):G9(n,e)}function j9(n,e,t){return n instanceof Vs?yk(n,e):n instanceof qs?vk(n,e):t}function mk(n,e){return n instanceof Ia?u9(e)?e:{integerValue:0}:null}function $9(n,e){return n instanceof Vs&&e instanceof Vs||n instanceof qs&&e instanceof qs?Fs(n.elements,e.elements,Un):n instanceof Ia&&e instanceof Ia?Un(n.operand,e.operand):n instanceof Ca&&e instanceof Ca}var Ca=class extends ba{},Vs=class extends ba{constructor(e){super(),this.elements=e}};function yk(n,e){let t=Ek(e);for(let r of n.elements)t.some(i=>Un(i,r))||t.push(r);return{arrayValue:{values:t}}}var qs=class extends ba{constructor(e){super(),this.elements=e}};function vk(n,e){let t=Ek(e);for(let r of n.elements)t=t.filter(i=>!Un(i,r));return{arrayValue:{values:t}}}var Ia=class extends ba{constructor(e,t){super(),this.serializer=e,this.operand=t}};function G9(n,e){let t=mk(n,e),r=oN(t)+oN(n.operand);return K_(t)&&K_(n.operand)?gk(r):AS(n.serializer,r)}function oN(n){return Me(n.integerValue||n.doubleValue)}function Ek(n){return bS(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function H9(n,e){return n.field.isEqual(e.field)&&$9(n.transform,e.transform)}function W9(n,e){return n===void 0&&e===void 0?!0:n&&e?Fs(n,e,(t,r)=>H9(t,r)):!1}var oT=class{constructor(e,t){this.version=e,this.transformResults=t}},zr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function pp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var Da=class{};function _k(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Pf(n.key,zr.none()):new zs(n.key,n.data,zr.none());{let t=n.data,r=Zt.empty(),i=new dt(tn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Er(n.key,r,new mn(i.toArray()),zr.none())}}function K9(n,e,t){n instanceof zs?Y9(n,e,t):n instanceof Er?X9(n,e,t):e5(n,e,t)}function Du(n,e,t,r){return n instanceof zs?J9(n,e,t,r):n instanceof Er?Z9(n,e,t,r):t5(n,e,t)}function Q9(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=mk(r.transform,i||null);s!=null&&(t===null&&(t=Zt.empty()),t.set(r.field,s))}return t||null}function aN(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!W9(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var zs=class extends Da{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}};function Y9(n,e,t){let r=n.value.clone(),i=Sk(n.fieldTransforms,e,t.transformResults);r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function J9(n,e,t,r){if(!pp(n.precondition,e))return t;let i=n.value.clone(),s=wk(n.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}var Er=class extends Da{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function X9(n,e,t){if(!pp(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let r=Sk(n.fieldTransforms,e,t.transformResults),i=e.data;i.setAll(Tk(n)),i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function Z9(n,e,t,r){if(!pp(n.precondition,e))return t;let i=wk(n.fieldTransforms,r,e),s=e.data;return s.setAll(Tk(n)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function Tk(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Sk(n,e,t){let r=new Map;Ee(n.length===t.length,32656,{serverTransformResultCount:t.length,fieldTransformCount:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,j9(o,a,t[i]))}return r}function wk(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,z9(s,o,e))}return r}var Pf=class extends Da{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function e5(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function t5(n,e,t){return pp(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var aT=class extends Da{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var cT=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];if(s.key.isEqual(e.key)){let o=r[i];K9(s,e,o)}}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Du(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Du(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=pk();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=_k(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),de())}isEqual(e){return this.batchId===e.batchId&&Fs(this.mutations,e.mutations,(t,r)=>aN(t,r))&&Fs(this.baseMutations,e.baseMutations,(t,r)=>aN(t,r))}},uT=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ee(e.mutations.length===r.length,58842,{mutationsSent:e.mutations.length,resultsReceived:r.length});let i=F9(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var lT=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var dT=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var lt=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n}(lt||{});function n5(n){switch(n){case O.OK:return J(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return J(15467,{code:n})}}function r5(n){return n5(n)&&n!==O.ABORTED}function If(n){if(n===void 0)return qn("GRPC error has no .code"),O.UNKNOWN;switch(n){case lt.OK:return O.OK;case lt.CANCELLED:return O.CANCELLED;case lt.UNKNOWN:return O.UNKNOWN;case lt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case lt.INTERNAL:return O.INTERNAL;case lt.UNAVAILABLE:return O.UNAVAILABLE;case lt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case lt.NOT_FOUND:return O.NOT_FOUND;case lt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case lt.ABORTED:return O.ABORTED;case lt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case lt.DATA_LOSS:return O.DATA_LOSS;default:return J(39323,{code:n})}}var hT=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var N_=null;var i5=new Or([4294967295,4294967295],0);function cN(n){let e=mS().encode(n),t=new dy;return t.update(e),new Uint8Array(t.digest())}function uN(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new Or([t,r],0),a=new Or([i,s],0);return[o,a]}var fT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ms(`Invalid padding: ${t}`);if(r<0)throw new Ms(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ms(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ms(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=Or.fromNumber(this.bitCount)}getBitIndex(e,t,r){let i=e.add(t.multiply(Or.fromNumber(r)));return i.compare(i5)===1&&(i=new Or([i.getBits(0),i.getBits(1)],0)),i.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],r=e%8;return(t&1<<r)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=cN(e),[r,i]=uN(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,r){let i=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=cN(e),[r,i]=uN(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ms=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Mf=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Mu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(te.min(),i,new Ve(se),Hr(),de())}},Mu=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,de(),de(),de())}};var va=class{constructor(e,t,r,i){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=i}},xf=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},Lf=class{constructor(e,t,r=bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ff=class{constructor(){this.pendingResponses=0,this.documentChanges=lN(),this._resumeToken=bt.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=de(),t=de(),r=de();return this.documentChanges.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:J(38017,{changeType:s})}}),new Mu(this._resumeToken,this._current,e,t,r)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=lN()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,Ee(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},s5="WatchChangeAggregator",pT=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=Hr(),this.pendingDocumentUpdatesByTarget=Sf(),this.pendingDocumentTargetMapping=Sf(),this.pendingTargetResets=new Ve(se)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let r=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&r.updateResumeToken(e.resumeToken);break;case 1:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case 2:r.recordTargetResponse(),r.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),r.updateResumeToken(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((r,i)=>{this.isActiveTarget(i)&&t(i)})}handleExistenceFilter(e){let t=e.targetId,r=e.existenceFilter.count,i=this.targetDataForActiveTarget(t);if(i){let s=i.target;if(iT(s))if(r===0){let o=new Q(s.path);this.removeDocumentFromTarget(t,o,zn.newNoDocument(o,te.min()))}else Ee(r===1,20013,{expectedCount:r});else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==r){let a=this.parseBloomFilter(e),c=a?this.applyBloomFilter(a,e,o):1;if(c!==0){this.resetTarget(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,u)}N_?.notifyOnExistenceFilterMismatch(o5(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,c))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o;try{o=$r(r).toUint8Array()}catch(c){if(c instanceof hT)return Fi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}let a;try{a=new fT(o,i,s)}catch(c){return c instanceof Ms?Fi("BloomFilter error: ",c):Fi("Applying bloom filter failed: ",c),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,r){let i=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return i===r-s?0:2}filterRemovedDocuments(e,t){let r=this.metadataProvider.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),i++)}),i}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&iT(a.target)){let c=new Q(a.target.path);!this.ensureDocumentUpdateByTarget(c).has(o)&&!this.targetContainsDocument(o,c)&&this.removeDocumentFromTarget(o,c,zn.newNoDocument(c,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let r=de();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.targetDataForActiveTarget(c);return u&&u.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(r=r.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let i=new Mf(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Hr(),this.pendingDocumentUpdatesByTarget=Sf(),this.pendingDocumentTargetMapping=Sf(),this.pendingTargetResets=new Ve(se),i}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let r=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(t.key,this.ensureDocumentUpdateByTarget(t.key).add(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,r){if(!this.isActiveTarget(e))return;let i=this.ensureTargetState(e);this.targetContainsDocument(e,t)?i.addDocumentChange(t,1):i.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).add(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let r=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new Ff,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new dt(se),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}ensureDocumentUpdateByTarget(e){let t=this.pendingDocumentUpdatesByTarget.get(e);return t||(t=new dt(se),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||z(s5,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new Ff),this.metadataProvider.getRemoteKeysForTarget(e).forEach(r=>{this.removeDocumentFromTarget(e,r,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function Sf(){return new Ve(Q.comparator)}function lN(){return new Ve(Q.comparator)}function o5(n,e,t,r,i){var s,o,a,c,u,l;let d={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},h=e.unchangedNames;return h&&(d.bloomFilter={applied:i===0,hashCount:(s=h?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(c=(a=(o=h?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&c!==void 0?c:0,padding:(l=(u=h?.bits)===null||u===void 0?void 0:u.padding)!==null&&l!==void 0?l:0,mightContain:p=>{var S;return(S=r?.mightContain(p))!==null&&S!==void 0?S:!1}}),d}var a5=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),c5=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),u5=(()=>{let n={};return n.and="AND",n.or="OR",n})();var Bf=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function l5(n){let e=n.code===void 0?O.UNKNOWN:If(n.code);return new B(e,n.message||"")}function gT(n,e){return n.useProto3Json||up(e)?e:{value:e}}function d5(n){let e;return typeof n=="object"?e=n.value:e=n,up(e)?null:e}function qr(n,e){if(n.useProto3Json){let r=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),i=("000000000"+e.nanoseconds).slice(-9);return`${r}.${i}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(n){let e=jr(n);return new Ue(e.seconds,e.nanos)}function Ck(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function h5(n,e){return n.useProto3Json?(Ee(e===void 0||typeof e=="string",58123),bt.fromBase64String(e||"")):(Ee(e===void 0||e instanceof Buffer||e instanceof Uint8Array,16193),bt.fromUint8Array(e||new Uint8Array))}function f5(n,e){return qr(n,e.toTimestamp())}function vr(n){return Ee(!!n,49232),te.fromTimestamp(bk(n))}function RS(n,e){return mT(n,e).canonicalString()}function mT(n,e){let t=g5(n).child("documents");return e===void 0?t:t.child(e)}function Ik(n){let e=Pe.fromString(n);return Ee(kk(e),10190,{key:e.toString()}),e}function xu(n,e){return RS(n.databaseId,e.path)}function k_(n,e){let t=Ik(e);if(t.get(1)!==n.databaseId.projectId)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Q(Ak(t))}function Dk(n,e){return RS(n.databaseId,e)}function p5(n){let e=Ik(n);return e.length===4?Pe.emptyPath():Ak(e)}function yT(n){return new Pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function g5(n){return new Pe(["projects",n.projectId,"databases",n.database])}function Ak(n){return Ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function dN(n,e,t){return{name:xu(n,e),fields:t.value.mapValue.fields}}function m5(n,e){let t;if("targetChange"in e){e.targetChange;let r=y5(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=h5(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&l5(o);t=new Lf(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=k_(n,r.document.name),s=vr(r.document.updateTime),o=r.document.createTime?vr(r.document.createTime):te.min(),a=new Zt({mapValue:{fields:r.document.fields}}),c=zn.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];t=new va(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=k_(n,r.document),s=r.readTime?vr(r.readTime):te.min(),o=zn.newNoDocument(i,s),a=r.removedTargetIds||[];t=new va([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=k_(n,r.document),s=r.removedTargetIds||[];t=new va([],s,i,null)}else if("filter"in e){e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new dT(i,s),a=r.targetId;t=new xf(a,o)}else return J(11601,{change:e});return t}function y5(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:J(39313,{state:n})}function v5(n){if(!("targetChange"in n))return te.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?te.min():vr(e.readTime)}function E5(n,e){let t;if(e instanceof zs)t={update:dN(n,e.key,e.value)};else if(e instanceof Pf)t={delete:xu(n,e.key)};else if(e instanceof Er)t={update:dN(n,e.key,e.data),updateMask:Y5(e.fieldMask)};else if(e instanceof aT)t={verify:xu(n,e.key)};else return J(16599,{mutationType:e.type});return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>w5(n,r))),e.precondition.isNone||(t.currentDocument=_5(n,e.precondition)),t}function _5(n,e){return e.updateTime!==void 0?{updateTime:f5(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:J(27497)}function T5(n,e){let t=n.updateTime?vr(n.updateTime):vr(e);return t.isEqual(te.min())&&(t=vr(e)),new oT(t,n.transformResults||[])}function S5(n,e){return n&&n.length>0?(Ee(e!==void 0,14353),n.map(t=>T5(t,e))):[]}function w5(n,e){let t=e.transform;if(t instanceof Ca)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof Vs)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof qs)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof Ia)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw J(20930,{transform:e.transform})}function b5(n,e){return{documents:[Dk(n,e.path)]}}function Rk(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Dk(n,i);let s=R5(e.filters);s&&(t.structuredQuery.where=s);let o=N5(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=gT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=P5(e.startAt)),e.endAt&&(t.structuredQuery.endAt=M5(e.endAt)),{queryTarget:t,parent:i}}function C5(n){let e=p5(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Ee(r===1,65062);let l=t.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];t.where&&(s=O5(t.where));let o=[];t.orderBy&&(o=k5(t.orderBy));let a=null;t.limit&&(a=d5(t.limit));let c=null;t.startAt&&(c=x5(t.startAt));let u=null;return t.endAt&&(u=L5(t.endAt)),S9(e,i,o,s,a,"F",c,u)}function I5(n,e){let t=D5(e.purpose);return t==null?null:{"goog-listen-tags":t}}function D5(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:n})}}function A5(n,e){let t,r=e.target;if(iT(r)?t={documents:b5(n,r)}:t={query:Rk(n,r).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=Ck(n,e.resumeToken);let i=gT(n,e.expectedCount);i!==null&&(t.expectedCount=i)}else if(e.snapshotVersion.compareTo(te.min())>0){t.readTime=qr(n,e.snapshotVersion.toTimestamp());let i=gT(n,e.expectedCount);i!==null&&(t.expectedCount=i)}return t}function R5(n){if(n.length!==0)return Nk(jn.create(n,"and"))}function O5(n){let e=Ok(n);return e instanceof jn&&sk(e)?e.getFilters():[e]}function Ok(n){return n.unaryFilter!==void 0?W5(n):n.fieldFilter!==void 0?K5(n):n.compositeFilter!==void 0?Q5(n):J(30097,{filter:n})}function N5(n){if(n.length!==0)return n.map(e=>j5(e))}function k5(n){return n.map(e=>$5(e))}function P5(n){return{before:n.inclusive,values:n.position}}function M5(n){return{before:!n.inclusive,values:n.position}}function x5(n){let e=!!n.before,t=n.values||[];return new wa(t,e)}function L5(n){let e=!n.before,t=n.values||[];return new wa(t,e)}function F5(n){return a5[n]}function B5(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function U5(n){return c5[n]}function V5(n){return u5[n]}function q5(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}function z5(n){switch(n){case"AND":return"and";case"OR":return"or";default:return J(1026)}}function ga(n){return{fieldPath:n.canonicalString()}}function ya(n){return tn.fromServerFormat(n.fieldPath)}function j5(n){return{field:ga(n.field),direction:F5(n.dir)}}function $5(n){return new Us(ya(n.field),B5(n.direction))}function Nk(n){return n instanceof Ze?H5(n):n instanceof jn?G5(n):J(54877,{filter:n})}function G5(n){let e=n.getFilters().map(t=>Nk(t));return e.length===1?e[0]:{compositeFilter:{op:V5(n.op),filters:e}}}function H5(n){if(n.op==="=="){if(nN(n.value))return{unaryFilter:{field:ga(n.field),op:"IS_NAN"}};if(tN(n.value))return{unaryFilter:{field:ga(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(nN(n.value))return{unaryFilter:{field:ga(n.field),op:"IS_NOT_NAN"}};if(tN(n.value))return{unaryFilter:{field:ga(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ga(n.field),op:U5(n.op),value:n.value}}}function W5(n){switch(n.unaryFilter.op){case"IS_NAN":let e=ya(n.unaryFilter.field);return Ze.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=ya(n.unaryFilter.field);return Ze.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=ya(n.unaryFilter.field);return Ze.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=ya(n.unaryFilter.field);return Ze.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}function K5(n){return Ze.create(ya(n.fieldFilter.field),q5(n.fieldFilter.op),n.fieldFilter.value)}function Q5(n){return jn.create(n.compositeFilter.filters.map(e=>Ok(e)),z5(n.compositeFilter.op))}function Y5(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function kk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Lu=class n{constructor(e,t,r,i,s=te.min(),o=te.min(),a=bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var vT=class{constructor(e){this.remoteSerializer=e}};function J5(n){let e=C5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sT(e,e.limit,"L"):e}function X5(n){return{name:n.name,query:J5(n.bundledQuery),readTime:vr(n.readTime)}}function Z5(n){return{id:n.id,version:n.version,createTime:vr(n.createTime)}}var eG=5,tG=10,nG=13,P_=15,rG=20,iG=25,sG=30,oG=37,aG=45,cG=50,uG=53,lG=55,dG=60,hG=2,Uf=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,eG);else if("booleanValue"in e)this.writeValueTypeLabel(t,tG),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,P_),t.writeNumber(Me(e.integerValue));else if("doubleValue"in e){let r=Me(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,nG):(this.writeValueTypeLabel(t,P_),Ou(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,rG),typeof r=="string"&&(r=jr(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,sG),t.writeBytes($r(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,aG),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?tk(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):ek(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):J(19022,{indexValue:e})}writeIndexString(e,t){this.writeValueTypeLabel(t,iG),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,lG);for(let i of Object.keys(r))this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexVector(e,t){var r,i;let s=e.fields||{};this.writeValueTypeLabel(t,uG);let o=_a,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.writeValueTypeLabel(t,P_),t.writeNumber(Me(a)),this.writeIndexString(o,t),this.writeIndexValueAux(s[o],t)}writeIndexArray(e,t){let r=e.values||[];this.writeValueTypeLabel(t,cG);for(let i of r)this.writeIndexValueAux(i,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,oG),Q.fromName(e).path.forEach(i=>{this.writeValueTypeLabel(t,dG),this.writeUnlabeledIndexString(i,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(hG)}};Uf.INSTANCE=new Uf;var ET=class{constructor(){this.collectionParentIndex=new _T}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Bs.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Bs.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},_T=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new dt(Pe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dt(Pe.comparator)).toArray()}};var xee=new Uint8Array(0);var M_=2,Fu=class n{constructor(e){this.lastId=e}next(){return this.lastId+=M_,this.lastId}static forTargetCache(){return new n(2-M_)}static forSyncEngine(){return new n(1-M_)}};var hN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gp=-1,Pk=40*1024*1024,yn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};yn.DEFAULT_COLLECTION_PERCENTILE=10;yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;yn.DEFAULT=new yn(Pk,yn.DEFAULT_COLLECTION_PERCENTILE,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);yn.DISABLED=new yn(gp,0,0);var fN="LruGarbageCollector",pN=1*1024*1024,fG=1*60*1e3,pG=5*60*1e3;function gN([n,e],[t,r]){let i=se(n,t);return i===0?se(e,r):i}var TT=class{constructor(e){this.maxElements=e,this.buffer=new dt(gN),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();gN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},ST=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==gp&&this.scheduleGC(fG)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){z(fN,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>E(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ma(t)?z(fN,"Ignoring IndexedDB error during garbage collection: ",t):yield Pa(t)}yield this.scheduleGC(pG)}))}},wT=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(vS.INVALID);let r=new TT(t);return this.delegate.forEachTarget(e,i=>r.addElement(i.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,i=>r.addElement(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.delegate.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===gp?(z("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(hN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hN):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,t))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>{if(u=Date.now(),fa()<=ce.DEBUG){let h=`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in ${a-o}ms
	Removed ${s} targets in ${c-a}ms
	Removed ${d} documents in ${u-c}ms
Total Duration: ${u-l}ms`;z("LruGarbageCollector",h)}return P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})})}};function gG(n,e){return new wT(n,e)}var bT=class{constructor(){this.changes=new Gr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,zn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var CT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var IT=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Du(r.mutation,i,mn.empty(),Ue.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,t,r=de()){let i=Ps();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=bu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Ps();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,de()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Hr(),o=Pu(),a=x9();return t.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Er)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Du(l.mutation,u,l.mutation.getFieldMask(),Ue.now())):o.set(u.key,mn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),t.forEach((u,l)=>{var d;return a.set(u,new CT(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Pu(),i=new Ve((o,a)=>o-a),s=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let l=r.get(c)||mn.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||de()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=pk();l.forEach(h=>{if(!s.has(h)){let p=_k(t.get(h),r.get(h));p!==null&&d.set(h,p),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return C9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(Ps()),a=Au,c=s;return o.next(u=>P.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?P.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,de())).next(l=>({batchId:a,changes:fk(l)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Q(t)).next(r=>{let i=bu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=bu();return this.indexManager.getCollectionParents(e,s).next(a=>P.forEach(a,c=>{let u=w9(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,zn.newInvalidDocument(l)))});let a=bu();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&Du(l.mutation,u,mn.empty(),Ue.now()),fp(t,u)&&(a=a.insert(c,u))}),a})}};var DT=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return P.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,Z5(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,X5(t)),P.resolve()}};var AT=class{constructor(){this.overlays=new Ve(Q.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Ps();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.saveOverlay(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.overlayByBatchId.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Ps(),s=t.length+1,o=new Q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ve((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=Ps(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=Ps(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return P.resolve(a)}saveOverlay(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.overlayByBatchId.get(i.largestBatchId).delete(r.key);this.overlayByBatchId.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lT(t,r));let s=this.overlayByBatchId.get(t);s===void 0&&(s=de(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(r.key))}};var RT=class{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Bu=class{constructor(){this.refsByKey=new dt(Je.compareByKey),this.refsByTarget=new dt(Je.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new Je(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.removeRef(new Je(e,t))}removeReferences(e,t){e.forEach(r=>this.removeReference(r,t))}removeReferencesForId(e){let t=new Q(new Pe([])),r=new Je(t,e),i=new Je(t,e+1),s=[];return this.refsByTarget.forEachInRange([r,i],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new Q(new Pe([])),r=new Je(t,e),i=new Je(t,e+1),s=de();return this.refsByTarget.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Je(e,0),r=this.refsByKey.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Je=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return Q.comparator(e.key,t.key)||se(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return se(e.targetOrBatchId,t.targetOrBatchId)||Q.comparator(e.key,t.key)}};var OT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new dt(Je.compareByKey)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new cT(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Je(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.indexOfBatchId(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?_S:this.nextBatchId-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Je(t,0),i=new Je(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([r,i],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(se);return t.forEach(i=>{let s=new Je(i,0),o=new Je(i,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{r=r.add(a.targetOrBatchId)})}),P.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;Q.isDocumentKey(s)||(s=s.child(""));let o=new Je(new Q(s),0),a=new dt(se);return this.batchesByDocumentKey.forEachWhile(c=>{let u=c.key.path;return r.isPrefixOf(u)?(u.length===i&&(a=a.add(c.targetOrBatchId)),!0):!1},o),P.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(r=>{let i=this.findMutationBatch(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){let r=this.indexOfExistingBatchId(t.batchId,"removed");Ee(r===0,55003),this.mutationQueue.shift();let i=this.batchesByDocumentKey;return P.forEach(t.mutations,s=>{let o=new Je(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=i})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new Je(t,0),i=this.batchesByDocumentKey.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var mG="-9223372036854775808";function yG(){return new Ve(Q.comparator)}var NT=class{constructor(e){this.sizer=e,this.docs=yG(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():zn.newInvalidDocument(t))}getEntries(e,t){let r=Hr();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():zn.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Hr(),o=t.path,a=new Q(o.child("__id"+mG+"__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||h$(d$(l),r)<=0||!i.has(l.key)&&!fp(t,l)||(s=s.insert(l.key,l.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){J(9500)}forEachDocumentKey(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new kT(this)}getSize(e){return P.resolve(this.size)}};function vG(n){return new NT(n)}var kT=class extends bT{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.documentCache.addEntry(e,i)):this.documentCache.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var PT=class{constructor(e){this.persistence=e,this.targets=new Gr(t=>CS(t),IS),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Bu,this.targetCount=0,this.targetIdGenerator=Fu.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),P.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new Fu(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.saveTargetData(t),P.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.references.containsKey(t))}};var EG="MemoryPersistence",Vf=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new vS(0),this._started=!1,this._started=!0,this.globalsCache=new RT,this.referenceDelegate=e(this),this.targetCache=new PT(this);let r=i=>this.referenceDelegate.documentSize(i);this.indexManager=new ET,this.remoteDocumentCache=vG(r),this.serializer=new vT(t),this.bundleCache=new DT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new OT(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){z(EG,"Starting transaction:",e);let i=new MT(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(s=>this.referenceDelegate.onTransactionCommitted(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return P.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}},MT=class extends $_{constructor(e){super(),this.currentSequenceNumber=e}},xT=class n{constructor(e){this.persistence=e,this.localViewReferences=new Bu,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw J(60996)}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),P.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.orphanedDocuments,i=>{let s=Q.fromPath(i);return this.isReferenced(e,s).next(o=>{o||r.removeEntry(s,te.min())})}).next(()=>(this._orphanedDocuments=null,r.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(r=>{r?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return P.or([()=>P.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}},qf=class n{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new Gr(r=>v$(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=gG(this,t)}static factory(e,t){return new n(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,r=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return P.forEach(this.orphanedSequenceNumbers,(r,i)=>this.isPinned(e,r,i).next(s=>s?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.forEachDocumentKey(e,a=>this.isPinned(e,a,t).next(c=>{c||(r++,s.removeEntry(a,te.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),P.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=lp(e.data.value)),t}isPinned(e,t,r){return P.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.orphanedSequenceNumbers.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Lee=30*60*1e3;function _G(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var OS="LocalStore",TG=5*60*1e6,LT=class{constructor(e,t,r,i){this.persistence=e,this.queryEngine=t,this.serializer=i,this.targetDataByTarget=new Ve(se),this.targetIdByTarget=new Gr(s=>CS(s),IS),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IT(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function SG(n,e,t,r){return new LT(n,e,t,r)}function Mk(n,e){return E(this,null,function*(){let t=ee(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let a=[],c=[],u=de();for(let l of s){a.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of o){c.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(i,u).next(l=>({affectedDocuments:l,removedBatchIds:a,addedBatchIds:c}))})})})}function wG(n,e){let t=ee(n),r=Ue.now(),i=e.reduce((a,c)=>a.add(c.key),de()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let c=Hr(),u=de();return t.remoteDocuments.getEntries(a,i).next(l=>{c=l,c.forEach((d,h)=>{h.isValidDocument()||(u=u.add(d))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,c)).next(l=>{s=l;let d=[];for(let h of e){let p=Q9(h,s.get(h.key).overlayedDocument);p!=null&&d.push(new Er(h.key,p,nk(p.value.mapValue),zr.exists(!0)))}return t.mutationQueue.addMutationBatch(a,r,d,e)}).next(l=>{o=l;let d=l.applyToLocalDocumentSet(s,u);return t.documentOverlayCache.saveOverlays(a,l.batchId,d)})}).then(()=>({batchId:o.batchId,changes:fk(s)}))}function bG(n,e){let t=ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return MG(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,CG(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function CG(n){let e=de();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function IG(n,e){let t=ee(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",r=>{let i;return t.mutationQueue.lookupMutationBatch(r,e).next(s=>(Ee(s!==null,37113),i=s.keys(),t.mutationQueue.removeMutationBatch(r,s))).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,i)).next(()=>t.localDocuments.getDocuments(r,i))})}function xk(n){let e=ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function DG(n,e){let t=ee(n),r=e.snapshotVersion,i=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=t.targetDataByTarget;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(t.targetCache.removeMatchingKeys(s,l.removedDocuments,d).next(()=>t.targetCache.addMatchingKeys(s,l.addedDocuments,d)));let p=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(bt.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):l.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(l.resumeToken,r)),i=i.insert(d,p),RG(h,p,l)&&a.push(t.targetCache.updateTargetData(s,p))});let c=Hr(),u=de();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(AG(s,o,e.documentUpdates).next(l=>{c=l.changedDocuments,u=l.existenceChangedKeys})),!r.isEqual(te.min())){let l=t.targetCache.getLastRemoteSnapshotVersion(s).next(d=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return P.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.targetDataByTarget=i,s))}function AG(n,e,t){let r=de(),i=de();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Hr();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):z(OS,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{changedDocuments:o,existenceChangedKeys:i}})}function RG(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=TG?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function OG(n,e){return E(this,null,function*(){let t=ee(n);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>P.forEach(e,i=>P.forEach(i.addedKeys,s=>t.persistence.referenceDelegate.addReference(r,i.targetId,s)).next(()=>P.forEach(i.removedKeys,s=>t.persistence.referenceDelegate.removeReference(r,i.targetId,s)))))}catch(r){if(Ma(r))z(OS,"Failed to update sequence numbers: "+r);else throw r}for(let r of e){let i=r.targetId;if(!r.fromCache){let s=t.targetDataByTarget.get(i),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(i,a)}}})}function NG(n,e){let t=ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=_S),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kG(n,e){let t=ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.targetCache.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.targetCache.allocateTargetId(r).next(o=>(i=new Lu(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.targetCache.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.targetDataByTarget.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(r.targetId,r),t.targetIdByTarget.set(e,r.targetId)),r})}function PG(n,e,t){let r=ee(n),i=r.targetIdByTarget.get(t);return i!==void 0?P.resolve(r.targetDataByTarget.get(i)):r.targetCache.getTargetData(e,t)}function FT(n,e,t){return E(this,null,function*(){let r=ee(n),i=r.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(Ma(o))z(OS,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}r.targetDataByTarget=r.targetDataByTarget.remove(e),r.targetIdByTarget.delete(i.target)})}function Lk(n,e,t){let r=ee(n),i=te.min(),s=de();return r.persistence.runTransaction("Execute query","readwrite",o=>PG(r,o,Vn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.queryEngine.getDocumentsMatchingQuery(o,e,t?i:te.min(),t?s:de())).next(a=>(xG(r,k9(e),a),{documents:a,remoteKeys:s})))}function MG(n,e,t,r){let i=t.batch,s=i.keys(),o=P.resolve();return s.forEach(a=>{o=o.next(()=>r.getEntry(e,a)).next(c=>{let u=t.docVersions.get(a);Ee(u!==null,48541),c.version.compareTo(u)<0&&(i.applyToRemoteDocument(c,t),c.isValidDocument()&&(c.setReadTime(t.commitVersion),r.addEntry(c)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,i))}function xG(n,e,t){let r=n.collectionGroupReadTime.get(e)||te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.collectionGroupReadTime.set(e,r)}var BT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var LG=100;function FG(){return aC()?8:p$(Ht())>0?6:4}var UT=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=LG,this.relativeIndexReadCostPerDocument=FG()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new BT;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,r,i){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(fa()<=ce.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",pa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),P.resolve()):(fa()<=ce.DEBUG&&z("QueryEngine","Query:",pa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*i?(fa()<=ce.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",pa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(t))):P.resolve())}performQueryUsingIndex(e,t){if(sN(t))return P.resolve(null);let r=Vn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=sT(t,null,"F"),r=Vn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=de(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.applyQuery(t,a);return this.needsRefill(t,u,o,c.readTime)?this.performQueryUsingIndex(e,sT(t,null,"F")):this.appendRemainingResults(e,u,t,c)}))})))}performQueryUsingRemoteKeys(e,t,r,i){return sN(t)||i.isEqual(te.min())?P.resolve(null):this.localDocumentsView.getDocuments(e,r).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,r,i)?P.resolve(null):(fa()<=ce.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pa(t)),this.appendRemainingResults(e,o,t,l$(i,Au)).next(a=>a))})}applyQuery(e,t){let r=new dt(dk(e));return t.forEach((i,s)=>{fp(e,s)&&(r=r.add(s))}),r}needsRefill(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(i)>0:!1}executeFullCollectionScan(e,t,r){return fa()<=ce.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",pa(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Bs.min(),r)}appendRemainingResults(e,t,r,i){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var zf=class{constructor(){this.activeTargetIds=V9()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var VT=class{constructor(){this.localState=new zf,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new zf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var qT=class{addCallback(e){}shutdown(){}};var zT=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var wf=null;function BG(){return 268435456+Math.round(2147483648*Math.random())}function x_(){return wf===null?wf=BG():wf++,"0x"+wf.toString(16)}function UG(n){return new Promise((e,t)=>{n((r,i)=>{r?t(r):e(i)})})}var VG="1.9.15",kt="GrpcConnection",qG=`gl-node/${process.versions.node} fire/${ka} grpc/${VG}`;function L_(n,e,t,r){Ee(e===null||e.type==="OAuth",36936);let i=new xs.Metadata;return e&&e.headers.forEach((s,o)=>i.set(o,s)),t&&t.headers.forEach((s,o)=>i.set(o,s)),r&&i.set("X-Firebase-GMPID",r),i.set("X-Goog-Api-Client",qG),i.set("Google-Cloud-Resource-Prefix",n),i.set("x-goog-request-params",n),i}var jT=class{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){z(kt,"Creating Firestore stub.");let e=this.databaseInfo.ssl?xs.credentials.createSsl():xs.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,i,s){let o=x_(),a=this.ensureActiveStub(),c=L_(this.databasePath,i,s,this.databaseInfo.appId),u=Object.assign({database:this.databasePath},r);return UG(l=>(z(kt,`RPC '${e}' ${o} invoked with request:`,r),a[e](u,c,(d,h)=>{d?(z(kt,`RPC '${e}' ${o} failed with error:`,d),l(new B(If(d.code),d.message))):(z(kt,`RPC '${e}' ${o} completed with response:`,h),l(void 0,h))})))}invokeStreamingRPC(e,t,r,i,s,o){let a=x_(),c=[],u=new vn;z(kt,`RPC '${e}' ${a} invoked (streaming) with request:`,r);let l=this.ensureActiveStub(),d=L_(this.databasePath,i,s,this.databaseInfo.appId),h=Object.assign(Object.assign({},r),{database:this.databasePath}),p=l[e](h,d),S=!1;return p.on("data",b=>{z(kt,`RPC ${e} ${a} received result:`,b),c.push(b),o!==void 0&&c.length===o&&(S=!0,u.resolve(c))}),p.on("end",()=>{z(kt,`RPC '${e}' ${a} completed.`),S||(S=!0,u.resolve(c))}),p.on("error",b=>{z(kt,`RPC '${e}' ${a} failed with error:`,b);let w=If(b.code);u.reject(new B(w,b.message))}),u.promise}openStream(e,t,r){let i=x_(),s=this.ensureActiveStub(),o=L_(this.databasePath,t,r,this.databaseInfo.appId),a=s[e](o),c=!1,u=h=>{c||(c=!0,l.callOnClose(h),a.end())},l=new zT({sendFn:h=>{if(c)z(kt,`RPC '${e}' stream ${i} not sending because gRPC stream is closed:`,h);else{z(kt,`RPC '${e}' stream ${i} sending:`,h);try{a.write(h)}catch(p){throw qn("Failure sending:",h),qn("Error:",p),p}}},closeFn:()=>{z(kt,`RPC '${e}' stream ${i} closed locally via close().`),u()}}),d=!1;return a.on("data",h=>{c||(z(kt,`RPC '${e}' stream ${i} received:`,h),d||(l.callOnConnected(),d=!0),l.callOnMessage(h))}),a.on("end",()=>{z(kt,`RPC '${e}' stream ${i} ended.`),u()}),a.on("error",h=>{if(!c){Fi(kt,`RPC '${e}' stream ${i} error. Code:`,h.code,"Message:",h.message);let p=If(h.code);u(new B(p,h.message))}}),z(kt,`Opening RPC '${e}' stream ${i} to ${this.databaseInfo.host}`),setTimeout(()=>{l.callOnOpen()},0),l}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},Fk={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},zG={nested:Fk},jG=Object.freeze({__proto__:null,nested:Fk,default:zG});var $G={longs:String,enums:String,defaults:!0,oneofs:!1};function GG(){let n=ON.fromJSON(jG,$G);return xs.loadPackageDefinition(n)}function HG(n){let e=GG();return new jT(e,n)}function WG(){return new qT}function mp(n){return new Bf(n,!1)}var KG="ExponentialBackoff",QG=1e3,YG=1.5,JG=60*1e3,jf=class{constructor(e,t,r=QG,i=YG,s=JG){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&z(KG,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var mN="PersistentStream",XG=60*1e3,ZG=10*1e3,$f=class{constructor(e,t,r,i,s,o,a,c){this.queue=e,this.idleTimerId=r,this.healthTimerId=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new jf(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}stop(){return E(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,XG,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return E(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return E(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(qn(t.toString()),qn("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.closeCount===t&&this.startStream(r,i)},r=>{e(()=>{let i=new B(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.handleStreamClose(i)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,ZG,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(i=>{r(()=>this.handleStreamClose(i))}),this.stream.onMessage(i=>{r(()=>++this.responseCount===1?this.onFirst(i):this.onNext(i))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>E(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return z(mN,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(z(mN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},$T=class extends $f{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=m5(this.serializer,e),r=v5(e);return this.listener.onWatchChange(t,r)}watch(e){let t={};t.database=yT(this.serializer),t.addTarget=A5(this.serializer,e);let r=I5(this.serializer,e);r&&(t.labels=r),this.sendRequest(t)}unwatch(e){let t={};t.database=yT(this.serializer),t.removeTarget=e,this.sendRequest(t)}},GT=class extends $f{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return Ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.onHandshakeComplete()}onNext(e){Ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=S5(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.onMutationResult(r,t)}writeHandshake(){let e={};e.database=yT(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>E5(this.serializer,r))};this.sendRequest(t)}};var HT=class{},WT=class extends HT{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,mT(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new B(O.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,r,i,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,mT(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(O.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function e8(n,e,t,r){return new WT(n,e,t,r)}function t8(n,e,t){let r=ee(n);return r.verifyInitialized(),new GT(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}function n8(n,e,t){let r=ee(n);return r.verifyInitialized(),new $T(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}var r8="OnlineStateTracker",yN=1,vN=10*1e3,KT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",vN,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${vN/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=yN&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${yN} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(qn(t),this.shouldWarnClientIsOffline=!1):z(r8,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var js="RemoteStore",i8=10,QT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{r.enqueueAndForget(()=>E(this,null,function*(){Ws(this)&&(z(js,"Restarting streams for network reachability change."),yield _8(this))}))}),this.onlineStateTracker=new KT(r,i)}};function s8(n,e,t,r,i){return new QT(n,e,t,r,i)}function yp(n){return E(this,null,function*(){if(Ws(n))for(let e of n.onNetworkStatusChange)yield e(!0)})}function Gu(n){return E(this,null,function*(){for(let e of n.onNetworkStatusChange)yield e(!1)})}function o8(n){return E(this,null,function*(){let e=ee(n);z(js,"RemoteStore shutting down."),e.offlineCauses.add(5),yield Gu(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function Bk(n,e){let t=ee(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),MS(t)?PS(t):xa(t).isOpen()&&kS(t,e))}function NS(n,e){let t=ee(n),r=xa(t);t.listenTargets.delete(e),r.isOpen()&&Uk(t,e),t.listenTargets.size===0&&(r.isOpen()?r.markIdle():Ws(t)&&t.onlineStateTracker.set("Unknown"))}function kS(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}xa(n).watch(e)}function Uk(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),xa(n).unwatch(e)}function PS(n){n.watchChangeAggregator=new pT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),xa(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function MS(n){return Ws(n)&&!xa(n).isStarted()&&n.listenTargets.size>0}function Ws(n){return ee(n).offlineCauses.size===0}function Vk(n){n.watchChangeAggregator=void 0}function a8(n){return E(this,null,function*(){n.onlineStateTracker.set("Online")})}function c8(n){return E(this,null,function*(){n.listenTargets.forEach((e,t)=>{kS(n,e)})})}function u8(n,e){return E(this,null,function*(){Vk(n),MS(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),PS(n)):n.onlineStateTracker.set("Unknown")})}function l8(n,e,t){return E(this,null,function*(){if(n.onlineStateTracker.set("Online"),e instanceof Lf&&e.state===2&&e.cause){try{yield h8(n,e)}catch(r){z(js,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Gf(n,r)}return}if(e instanceof va?n.watchChangeAggregator.handleDocumentChange(e):e instanceof xf?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(te.min()))try{let r=yield xk(n.localStore);t.compareTo(r)>=0&&(yield d8(n,t))}catch(r){z(js,"Failed to raise snapshot:",r),yield Gf(n,r)}})}function Gf(n,e,t){return E(this,null,function*(){if(Ma(e))n.offlineCauses.add(1),yield Gu(n),n.onlineStateTracker.set("Offline"),t||(t=()=>xk(n.localStore)),n.asyncQueue.enqueueRetryable(()=>E(null,null,function*(){z(js,"Retrying IndexedDB access"),yield t(),n.offlineCauses.delete(1),yield yp(n)}));else throw e})}function qk(n,e){return e().catch(t=>Gf(n,t,e))}function d8(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((r,i)=>{if(r.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(i);s&&n.listenTargets.set(i,s.withResumeToken(r.resumeToken,e))}}),t.targetMismatches.forEach((r,i)=>{let s=n.listenTargets.get(r);if(!s)return;n.listenTargets.set(r,s.withResumeToken(bt.EMPTY_BYTE_STRING,s.snapshotVersion)),Uk(n,r);let o=new Lu(s.target,r,i,s.sequenceNumber);kS(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}function h8(n,e){return E(this,null,function*(){let t=e.cause;for(let r of e.targetIds)n.listenTargets.has(r)&&(yield n.remoteSyncer.rejectListen(r,t),n.listenTargets.delete(r),n.watchChangeAggregator.removeTarget(r))})}function vp(n){return E(this,null,function*(){let e=ee(n),t=Wi(e),r=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:_S;for(;f8(e);)try{let i=yield NG(e.localStore,r);if(i===null){e.writePipeline.length===0&&t.markIdle();break}else r=i.batchId,p8(e,i)}catch(i){yield Gf(e,i)}zk(e)&&jk(e)})}function f8(n){return Ws(n)&&n.writePipeline.length<i8}function p8(n,e){n.writePipeline.push(e);let t=Wi(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function zk(n){return Ws(n)&&!Wi(n).isStarted()&&n.writePipeline.length>0}function jk(n){Wi(n).start()}function g8(n){return E(this,null,function*(){Wi(n).writeHandshake()})}function m8(n){return E(this,null,function*(){let e=Wi(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)})}function y8(n,e,t){return E(this,null,function*(){let r=n.writePipeline.shift(),i=uT.from(r,e,t);yield qk(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield vp(n)})}function v8(n,e){return E(this,null,function*(){e&&Wi(n).handshakeComplete&&(yield E8(n,e)),zk(n)&&jk(n)})}function E8(n,e){return E(this,null,function*(){if(r5(e.code)){let t=n.writePipeline.shift();Wi(n).inhibitBackoff(),yield qk(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield vp(n)}})}function _8(n){return E(this,null,function*(){let e=ee(n);e.offlineCauses.add(4),yield Gu(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield yp(e)})}function EN(n,e){return E(this,null,function*(){let t=ee(n);t.asyncQueue.verifyOperationInProgress(),z(js,"RemoteStore received new credentials");let r=Ws(t);t.offlineCauses.add(3),yield Gu(t),r&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield yp(t)})}function T8(n,e){return E(this,null,function*(){let t=ee(n);e?(t.offlineCauses.delete(2),yield yp(t)):e||(t.offlineCauses.add(2),yield Gu(t),t.onlineStateTracker.set("Unknown"))})}function xa(n){return n.watchStream||(n.watchStream=n8(n.datastore,n.asyncQueue,{onConnected:a8.bind(null,n),onOpen:c8.bind(null,n),onClose:u8.bind(null,n),onWatchChange:l8.bind(null,n)}),n.onNetworkStatusChange.push(e=>E(null,null,function*(){e?(n.watchStream.inhibitBackoff(),MS(n)?PS(n):n.onlineStateTracker.set("Unknown")):(yield n.watchStream.stop(),Vk(n))}))),n.watchStream}function Wi(n){return n.writeStream||(n.writeStream=t8(n.datastore,n.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:g8.bind(null,n),onClose:v8.bind(null,n),onHandshakeComplete:m8.bind(null,n),onMutationResult:y8.bind(null,n)}),n.onNetworkStatusChange.push(e=>E(null,null,function*(){e?(n.writeStream.inhibitBackoff(),yield vp(n)):(yield n.writeStream.stop(),n.writePipeline.length>0&&(z(js,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))}))),n.writeStream}var S8="AsyncQueue",YT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function xS(n,e){if(qn(S8,`${e}: ${n}`),Ma(n))return new B(O.UNAVAILABLE,`${e}: ${n}`);throw n}var Hf=class n{static emptySet(e){return new n(e.comparator)}constructor(e){e?this.comparator=(t,r)=>e(t,r)||Q.comparator(t.key,r.key):this.comparator=(t,r)=>Q.comparator(t.key,r.key),this.keyedMap=bu(),this.sortedSet=new Ve(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Wf=class{constructor(){this.changeMap=new Ve(Q.comparator)}track(e){let t=e.doc.key,r=this.changeMap.get(t);if(!r){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&r.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&r.type!==1?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):J(63341,{change:e,oldChange:r})}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,r)=>{e.push(r)}),e}},Aa=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Hf.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!hp(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var JT=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function w8(){return new XT}var XT=class{constructor(){this.queries=$k(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){D8(this,new B(O.ABORTED,"Firestore shutting down"))}};function $k(){return new Gr(n=>lk(n),hp)}function LS(n,e){return E(this,null,function*(){let t=ee(n),r=3,i=e.query,s=t.queries.get(i);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2):(s=new JT,r=e.listensToRemoteStore()?0:1);try{switch(r){case 0:s.viewSnap=yield t.onListen(i,!0);break;case 1:s.viewSnap=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i);break;default:break}}catch(o){let a=xS(o,`Initialization of query '${pa(e.query)}' failed`);e.onError(a);return}t.queries.set(i,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&BS(t)})}function FS(n,e){return E(this,null,function*(){let t=ee(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?i=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function b8(n,e){let t=ee(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(i)&&(r=!0);o.viewSnap=i}}r&&BS(t)}function C8(n,e,t){let r=ee(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function I8(n,e){let t=ee(n);t.onlineState=e;let r=!1;t.queries.forEach((i,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(r=!0)}),r&&BS(t)}function D8(n,e){let t=ee(n),r=t.queries;t.queries=$k(),r.forEach((i,s)=>{for(let o of s.listeners)o.onError(e)})}function BS(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var Gk=function(n){return n.Default="default",n.Cache="cache",n}(Gk||{}),Uu=class{constructor(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=r||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Aa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let r=t!=="Offline";return this.options.waitForSyncWhenOnline&&r?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Aa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==Gk.Cache}};var ZT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=i}static fromSnapshot(e,t){let r=de(),i=de();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key);break}return new n(e,t.fromCache,r,i)}};var Kf=class{constructor(e){this.key=e}},Qf=class{constructor(e){this.key=e}},eS=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=de(),this.mutatedKeys=de(),this.docComparator=dk(e),this.documentSet=new Hf(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let r=t?t.changeSet:new Wf,i=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),p=fp(this.query,d)?d:null,S=h?this.mutatedKeys.has(h.key):!1,b=p?p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations:!1,w=!1;h&&p?h.data.isEqual(p.data)?S!==b&&(r.track({type:3,doc:p}),w=!0):this.shouldWaitForSyncedDocument(h,p)||(r.track({type:2,doc:p}),w=!0,(c&&this.docComparator(p,c)>0||u&&this.docComparator(p,u)<0)&&(a=!0)):!h&&p?(r.track({type:0,doc:p}),w=!0):h&&!p&&(r.track({type:1,doc:h}),w=!0,(c||u)&&(a=!0)),w&&(p?(o=o.add(p),b?s=s.add(l):s=s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{documentSet:o,changeSet:r,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((d,h)=>A8(d.type,h.type)||this.docComparator(d.doc,h.doc)),this.applyTargetChange(r),i=i??!1;let a=t&&!i?this.updateLimboDocuments():[],u=this.limboDocuments.size===0&&this.current&&!i?1:0,l=u!==this.syncState;return this.syncState=u,o.length===0&&!l?{limboChanges:a}:{snapshot:new Aa(this.query,e.documentSet,s,o,e.mutatedKeys,u===0,l,!1,r?r.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Wf,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=de(),this.documentSet.forEach(r=>{this.shouldBeInLimbo(r.key)&&(this.limboDocuments=this.limboDocuments.add(r.key))});let t=[];return e.forEach(r=>{this.limboDocuments.has(r)||t.push(new Qf(r))}),this.limboDocuments.forEach(r=>{e.has(r)||t.push(new Kf(r))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=de();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Aa.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function A8(n,e){let t=r=>{switch(r){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return J(20277,{change:r})}};return t(n)-t(e)}var US="SyncEngine",tS=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},nS=class{constructor(e){this.key=e,this.receivedDocument=!1}},rS=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new Gr(a=>lk(a),hp),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Ve(Q.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new Bu,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Fu.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function R8(n,e,t,r,i,s,o){let a=new rS(n,e,t,r,i,s);return o&&(a._isPrimaryClient=!0),a}function O8(n,e,t=!0){return E(this,null,function*(){let r=Xk(n),i,s=r.queryViewsByQuery.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.computeInitialSnapshot()):i=yield Hk(r,e,t,!0),i})}function N8(n,e){return E(this,null,function*(){let t=Xk(n);yield Hk(t,e,!0,!1)})}function Hk(n,e,t,r){return E(this,null,function*(){let i=yield kG(n.localStore,Vn(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield k8(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Bk(n.remoteStore,i),a})}function k8(n,e,t,r,i){return E(this,null,function*(){n.applyDocChanges=(d,h,p)=>z8(n,d,h,p);let s=yield Lk(n.localStore,e,!0),o=new eS(e,s.remoteKeys),a=o.computeDocChanges(s.documents),c=Mu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);Jk(n,t,u.limboChanges);let l=new tS(e,t,o);return n.queryViewsByQuery.set(e,l),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),u.snapshot})}function P8(n,e,t){return E(this,null,function*(){let r=ee(n),i=r.queryViewsByQuery.get(e),s=r.queriesByTarget.get(i.targetId);if(s.length>1){r.queriesByTarget.set(i.targetId,s.filter(o=>!hp(o,e))),r.queryViewsByQuery.delete(e);return}r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield FT(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&NS(r.remoteStore,i.targetId),iS(r,i.targetId)}).catch(Pa))):(iS(r,i.targetId),yield FT(r.localStore,i.targetId,!0))})}function M8(n,e){return E(this,null,function*(){let t=ee(n),r=t.queryViewsByQuery.get(e),i=t.queriesByTarget.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),NS(t.remoteStore,r.targetId))})}function x8(n,e,t){return E(this,null,function*(){let r=G8(n);try{let i=yield wG(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),V8(r,i.batchId,t),yield Hu(r,i.changes),yield vp(r.remoteStore)}catch(i){let s=xS(i,"Failed to persist write");t.reject(s)}})}function Wk(n,e){return E(this,null,function*(){let t=ee(n);try{let r=yield DG(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(Ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.receivedDocument=!0:i.modifiedDocuments.size>0?Ee(o.receivedDocument,14607):i.removedDocuments.size>0&&(Ee(o.receivedDocument,42227),o.receivedDocument=!1))}),yield Hu(t,r,e)}catch(r){yield Pa(r)}})}function _N(n,e,t){let r=ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&i.push(a.snapshot)}),I8(r.eventManager,e),i.length&&r.syncEngineListener.onWatchChange(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function L8(n,e,t){return E(this,null,function*(){let r=ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.activeLimboResolutionsByTarget.get(e),s=i&&i.key;if(s){let o=new Ve(Q.comparator);o=o.insert(s,zn.newNoDocument(s,te.min()));let a=de().add(s),c=new Mf(te.min(),new Map,new Ve(se),o,a);yield Wk(r,c),r.activeLimboTargetsByKey=r.activeLimboTargetsByKey.remove(s),r.activeLimboResolutionsByTarget.delete(e),VS(r)}else yield FT(r.localStore,e,!1).then(()=>iS(r,e,t)).catch(Pa)})}function F8(n,e){return E(this,null,function*(){let t=ee(n),r=e.batch.batchId;try{let i=yield bG(t.localStore,e);Qk(t,r,null),Kk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Hu(t,i)}catch(i){yield Pa(i)}})}function B8(n,e,t){return E(this,null,function*(){let r=ee(n);try{let i=yield IG(r.localStore,e);Qk(r,e,t),Kk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Hu(r,i)}catch(i){yield Pa(i)}})}function Kk(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function U8(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(r=>{r.reject(new B(O.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function V8(n,e,t){let r=n.mutationUserCallbacks[n.currentUser.toKey()];r||(r=new Ve(se)),r=r.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=r}function Qk(n,e,t){let r=ee(n),i=r.mutationUserCallbacks[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.mutationUserCallbacks[r.currentUser.toKey()]=i}}function iS(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(r),t&&n.syncEngineListener.onWatchError(r,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(i=>{n.limboDocumentRefs.containsKey(i)||Yk(n,i)})}function Yk(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(NS(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),VS(n))}function Jk(n,e,t){for(let r of t)r instanceof Kf?(n.limboDocumentRefs.addReference(r.key,e),q8(n,r)):r instanceof Qf?(z(US,"Document no longer in limbo: "+r.key),n.limboDocumentRefs.removeReference(r.key,e),n.limboDocumentRefs.containsKey(r.key)||Yk(n,r.key)):J(19791,{limboChange:r})}function q8(n,e){let t=e.key,r=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(r)&&(z(US,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(r),VS(n))}function VS(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new Q(Pe.fromString(e)),r=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(r,new nS(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,r),Bk(n.remoteStore,new Lu(Vn(dp(t.path)),r,"TargetPurposeLimboResolution",vS.INVALID))}}function Hu(n,e,t){return E(this,null,function*(){let r=ee(n),i=[],s=[],o=[];r.queryViewsByQuery.isEmpty()||(r.queryViewsByQuery.forEach((a,c)=>{o.push(r.applyDocChanges(c,e,t).then(u=>{var l;if((u||t)&&r.isPrimaryClient){let d=u?!u.fromCache:(l=t?.targetChanges.get(c.targetId))===null||l===void 0?void 0:l.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);let d=ZT.fromSnapshot(c.targetId,u);s.push(d)}}))}),yield Promise.all(o),r.syncEngineListener.onWatchChange(i),yield OG(r.localStore,s))})}function z8(n,e,t,r){return E(this,null,function*(){let i=e.view.computeDocChanges(t);i.needsRefill&&(i=yield Lk(n.localStore,e.query,!1).then(({documents:c})=>e.view.computeDocChanges(c,i)));let s=r&&r.targetChanges.get(e.targetId),o=r&&r.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(i,n.isPrimaryClient,s,o);return Jk(n,e.targetId,a.limboChanges),a.snapshot})}function j8(n,e){return E(this,null,function*(){let t=ee(n);if(!t.currentUser.isEqual(e)){z(US,"User change. New user:",e.toKey());let i=yield Mk(t.localStore,e);t.currentUser=e,U8(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Hu(t,i.affectedDocuments)}})}function $8(n,e){let t=ee(n),r=t.activeLimboResolutionsByTarget.get(e);if(r&&r.receivedDocument)return de().add(r.key);{let i=de(),s=t.queriesByTarget.get(e);if(!s)return i;for(let o of s){let a=t.queryViewsByQuery.get(o);i=i.unionWith(a.view.syncedDocuments)}return i}}function Xk(n){let e=ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=L8.bind(null,e),e.syncEngineListener.onWatchChange=b8.bind(null,e.eventManager),e.syncEngineListener.onWatchError=C8.bind(null,e.eventManager),e}function G8(n){let e=ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=B8.bind(null,e),e}var Zk=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return E(this,null,function*(){this.serializer=mp(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return SG(this.persistence,new UT,t.initialUser,this.serializer)}createPersistence(t){return new Vf(xT.factory,this.serializer)}createSharedClientState(t){return new VT}terminate(){return E(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),sS=class extends Zk{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){Ee(this.persistence.referenceDelegate instanceof qf,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new ST(r,e.asyncQueue,t)}createPersistence(e){let t=this.cacheSizeBytes!==void 0?yn.withCacheSize(this.cacheSizeBytes):yn.DEFAULT;return new Vf(r=>qf.factory(r,t),this.serializer)}};var H8=(()=>{class n{initialize(t,r){return E(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>_N(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=j8.bind(null,this.syncEngine),yield T8(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return w8()}createDatastore(t){let r=mp(t.databaseInfo.databaseId),i=HG(t.databaseInfo);return e8(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return s8(this.localStore,this.datastore,t.asyncQueue,r=>_N(this.syncEngine,r,0),WG())}createSyncEngine(t,r){return R8(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return E(this,null,function*(){var t,r;yield o8(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}n.provider={build:()=>new n};return n})();var Vu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):qn("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var qi="FirestoreClient",W8=100,K8=11,Q8=20,Y8=22,oS=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ht.UNAUTHENTICATED,this.clientId=Ea.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>E(this,null,function*(){z(qi,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(z(qi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:W8}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>E(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=xS(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function F_(n,e){return E(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),z(qi,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>E(null,null,function*(){r.isEqual(i)||(yield Mk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{Fi("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{z("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Fi("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function TN(n,e){return E(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield X8(n);z(qi,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>EN(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>EN(e.remoteStore,i)),n._onlineComponents=e})}function J8(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===Y8||n.code===Q8||n.code===K8:!0}function X8(n){return E(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z(qi,"Using user provided OfflineComponentProvider");try{yield F_(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!J8(t))throw t;Fi("Error using user provided cache. Falling back to memory cache: "+t),yield F_(n,new Zk)}}else z(qi,"Using default OfflineComponentProvider"),yield F_(n,new sS(void 0));return n._offlineComponents})}function e1(n){return E(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(z(qi,"Using user provided OnlineComponentProvider"),yield TN(n,n._uninitializedComponentsProvider._online)):(z(qi,"Using default OnlineComponentProvider"),yield TN(n,new H8))),n._onlineComponents})}function Z8(n){return e1(n).then(e=>e.syncEngine)}function Yf(n){return E(this,null,function*(){let e=yield e1(n),t=e.eventManager;return t.onListen=O8.bind(null,e.syncEngine),t.onUnlisten=P8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=N8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=M8.bind(null,e.syncEngine),t})}function eH(n,e,t,r){let i=new Vu(r),s=new Uu(e,i,t);return n.asyncQueue.enqueueAndForget(()=>E(null,null,function*(){let o=yield Yf(n);return LS(o,s)})),()=>{i.mute(),n.asyncQueue.enqueueAndForget(()=>E(null,null,function*(){let o=yield Yf(n);return FS(o,s)}))}}function tH(n,e,t={}){let r=new vn;return n.asyncQueue.enqueueAndForget(()=>E(null,null,function*(){let i=yield Yf(n);return iH(i,n.asyncQueue,e,t,r)})),r.promise}function nH(n,e,t={}){let r=new vn;return n.asyncQueue.enqueueAndForget(()=>E(null,null,function*(){let i=yield Yf(n);return sH(i,n.asyncQueue,e,t,r)})),r.promise}function rH(n,e){let t=new vn;return n.asyncQueue.enqueueAndForget(()=>E(null,null,function*(){let r=yield Z8(n);return x8(r,e,t)})),t.promise}function iH(n,e,t,r,i){let s=new Vu({next:a=>{s.mute(),e.enqueueAndForget(()=>FS(n,o));let c=a.docs.has(t);!c&&a.fromCache?i.reject(new B(O.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&r.source==="server"?i.reject(new B(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:a=>i.reject(a)}),o=new Uu(dp(t.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return LS(n,o)}function sH(n,e,t,r,i){let s=new Vu({next:a=>{s.mute(),e.enqueueAndForget(()=>FS(n,o)),a.fromCache&&r.source==="server"?i.reject(new B(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(a)},error:a=>i.reject(a)}),o=new Uu(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return LS(n,o)}function oH(n,e){return n.timeoutSeconds===e.timeoutSeconds}function t1(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var aH="ComponentProvider",SN=new Map;function cH(n){let e=SN.get(n);e&&(z(aH,"Removing Datastore"),SN.delete(n),e.terminate())}function uH(n,e,t,r){return new H_(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,t1(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}var n1="firestore.googleapis.com",wN=!0,bN=5,CN=30,lH=!0,Jf=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new B(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=n1,this.ssl=wN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:wN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Pk;else{if(e.cacheSizeBytes!==gp&&e.cacheSizeBytes<pN)throw new B(O.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${pN}`);this.cacheSizeBytes=e.cacheSizeBytes}c$("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=lH:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=t1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),dH(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&oH(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function dH(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<bN)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${bN})`);if(n.timeoutSeconds>CN)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${CN})`)}}var Ra=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new B(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=i$(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return E(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return cH(this),Promise.resolve()}};function r1(n,e,t,r={}){var i;n=en(n,Ra);let s=ds(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(id(`https://${c}`),sd("Firestore",!0)),o.host!==n1&&o.host!==c&&Fi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!er(u,a)&&(n._setSettings(u),r.mockUserToken)){let l,d;if(typeof r.mockUserToken=="string")l=r.mockUserToken,d=ht.MOCK_USER;else{l=nC(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new B(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ht(h)}n._authCredentials=new U_(new Df(l,d))}}var zi=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},nt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if($u(t,n._jsonSchema))return new n(e,r||null,new Q(Pe.fromString(t.referencePath)))}};nt._jsonSchemaVersion="firestore/documentReference/1.0";nt._jsonSchema={type:Xe("string",nt._jsonSchemaVersion),referencePath:Xe("string")};var Bi=class n extends zi{constructor(e,t,r){super(e,t,dp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new nt(this.firestore,null,new Q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function i1(n,e,...t){if(n=Qe(n),kN("collection","path",e),n instanceof Ra){let r=Pe.fromString(e,...t);return KO(r),new Bi(n,null,r)}else{if(!(n instanceof nt)&&!(n instanceof Bi))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Pe.fromString(e,...t));return KO(r),new Bi(n.firestore,null,r)}}function qS(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=Ea.newId()),kN("doc","path",e),n instanceof Ra){let r=Pe.fromString(e,...t);return WO(r),new nt(n,null,new Q(r))}else{if(!(n instanceof nt)&&!(n instanceof Bi))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Pe.fromString(e,...t));return WO(r),new nt(n.firestore,n instanceof Bi?n.converter:null,new Q(r))}}var hH="AsyncQueue",Xf=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new jf(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new vn;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return E(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Ma(e))z(hH,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(r=>{this.failure=r,this.operationInProgress=!1;let i=IN(r);throw qn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.operationInProgress=!1,r))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=YT.createAndSchedule(this,e,t,r,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&J(47125,{messageOrStack:IN(this.failure)})}verifyOperationInProgress(){}drain(){return E(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function IN(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var _r=class extends Ra{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Xf,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return E(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Xf(e),this._firestoreClient=void 0,yield e}})}};function s1(n,e){let t=typeof n=="object"?n:fs(),r=typeof n=="string"?n:e||W_,i=wo(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=tC("firestore");s&&r1(i,...s)}return i}function Ep(n){if(n._terminated)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fH(n),n._firestoreClient}function fH(n){var e,t,r;let i=n._freezeSettings(),s=uH(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new oS(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&pH(n._componentsProvider))}function pH(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function gH(n,e=!0){n$(bo),Rn(new Ot("firestore",(t,{instanceIdentifier:r,options:i})=>{let s=t.getProvider("app").getImmediate(),o=new _r(new V_(t.getProvider("auth-internal")),new j_(s,t.getProvider("app-check-internal")),q$(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Fe(jO,$O,n),Fe(jO,$O,"esm2017")}var ji=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(bt.fromBase64String(e))}catch(t){throw new B(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($u(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};ji._jsonSchemaVersion="firestore/bytes/1.0";ji._jsonSchema={type:Xe("string",ji._jsonSchemaVersion),bytes:Xe("string")};var Oa=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new B(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var qu=class{constructor(e){this._methodName=e}};var $i=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new B(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new B(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if($u(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};$i._jsonSchemaVersion="firestore/geoPoint/1.0";$i._jsonSchema={type:Xe("string",$i._jsonSchemaVersion),latitude:Xe("number"),longitude:Xe("number")};var Gi=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return _G(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($u(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new B(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Gi._jsonSchemaVersion="firestore/vectorValue/1.0";Gi._jsonSchema={type:Xe("string",Gi._jsonSchemaVersion),vectorValues:Xe("object")};var mH=/^__.*__$/,aS=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Er(e,this.data,this.fieldMask,t,this.fieldTransforms):new zs(e,this.data,t,this.fieldTransforms)}},Zf=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Er(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function o1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{dataSource:n})}}var cS=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.contextWith({path:r,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.contextWith({path:r,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return np(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(o1(this.dataSource)&&mH.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},ep=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||mp(e)}createContext(e,t,r,i=!1){return new cS({dataSource:e,methodName:t,targetDoc:r,path:tn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function _p(n){let e=n._freezeSettings(),t=mp(n._databaseId);return new ep(n._databaseId,!!e.ignoreUndefinedProperties,t)}function a1(n,e,t,r,i,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,i);jS("Data must be an object, but it was:",o,r);let a=zS(r,o),c,u;if(s.merge)c=new mn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=uS(e,d,t);if(!o.contains(h))throw new B(O.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);u1(l,h)||l.push(h)}c=new mn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new aS(new Zt(a),c,u)}var tp=class n extends qu{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof n}};function yH(n,e,t,r){let i=n.createContext(1,e,t);jS("Data must be an object, but it was:",i,r);let s=[],o=Zt.empty();Hi(r,(c,u)=>{let l=$S(e,c,t);u=Qe(u);let d=i.childContextForFieldPath(l);if(u instanceof tp)s.push(l);else{let h=Wu(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new mn(s);return new Zf(o,a,i.fieldTransforms)}function vH(n,e,t,r,i,s){let o=n.createContext(1,e,t),a=[uS(e,r,t)],c=[i];if(s.length%2!==0)throw new B(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(uS(e,s[h])),c.push(s[h+1]);let u=[],l=Zt.empty();for(let h=a.length-1;h>=0;--h)if(!u1(u,a[h])){let p=a[h],S=c[h];S=Qe(S);let b=o.childContextForFieldPath(p);if(S instanceof tp)u.push(p);else{let w=Wu(S,b);w!=null&&(u.push(p),l.set(p,w))}}let d=new mn(u);return new Zf(l,d,o.fieldTransforms)}function EH(n,e,t,r=!1){let i=n.createContext(r?4:3,e);return Wu(t,i)}function Wu(n,e){if(n=Qe(n),c1(n))return jS("Unsupported field value:",e,n),zS(n,e);if(n instanceof qu)return TH(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return _H(n,e)}else return SH(n,e)}function zS(n,e){let t={};return WN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hi(n,(r,i)=>{let s=Wu(i,e.childContextForField(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function _H(n,e){let t=[],r=0;for(let i of n){let s=Wu(i,e.childContextForArray(r));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),r++}return{arrayValue:{values:t}}}function TH(n,e){if(!o1(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function SH(n,e){if(n=Qe(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return q9(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=Ue.fromDate(n);return{timestampValue:qr(e.serializer,t)}}else if(n instanceof Ue){let t=new Ue(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:qr(e.serializer,t)}}else{if(n instanceof $i)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ji)return{bytesValue:Ck(e.serializer,n._byteString)};if(n instanceof nt){let t=e.databaseId,r=n.firestore._databaseId;if(!r.isEqual(t))throw e.createError(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:RS(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof Gi)return wH(n,e);throw e.createError(`Unsupported field value: ${ap(n)}`)}}}function wH(n,e){return{mapValue:{fields:{[TS]:{stringValue:SS},[_a]:{arrayValue:{values:n.toArray().map(r=>{if(typeof r!="number")throw e.createError("VectorValues must only contain numeric values.");return AS(e.serializer,r)})}}}}}}function c1(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof Ue)&&!(n instanceof $i)&&!(n instanceof ji)&&!(n instanceof nt)&&!(n instanceof qu)&&!(n instanceof Gi)}function jS(n,e,t){if(!c1(t)||!PN(t)){let r=ap(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function uS(n,e,t){if(e=Qe(e),e instanceof Oa)return e._internalPath;if(typeof e=="string")return $S(n,e);throw np("Field path arguments must be of type string or ",n,!1,void 0,t)}var bH=new RegExp("[~\\*/\\[\\]]");function $S(n,e,t){if(e.search(bH)>=0)throw np(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Oa(...e.split("."))._internalPath}catch{throw np(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function np(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new B(O.INVALID_ARGUMENT,a+n+c)}function u1(n,e){return n.some(t=>t.isEqual(e))}var rp=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new lS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(Tp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},lS=class extends rp{data(){return super.data()}};function Tp(n,e){return typeof e=="string"?$S(n,e):e instanceof Oa?e._internalPath:e._delegate._internalPath}function l1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new B(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zu=class{},ip=class extends zu{};function d1(n,e,...t){let r=[];e instanceof zu&&r.push(e),r=r.concat(t),OH(r);for(let i of r)n=i._apply(n);return n}var sp=class n extends ip{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return p1(e._query,t),new zi(e.firestore,e.converter,DS(e._query,t))}_parse(e){let t=_p(e.firestore);return CH(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function h1(n,e,t){let r=e,i=Tp("where",n);return sp._create(i,r,t)}var dS=class n extends zu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:jn.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(AH(e._query,t),new zi(e.firestore,e.converter,DS(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var hS=class n extends ip{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=IH(e._query,this._field,this._direction);return new zi(e.firestore,e.converter,D9(e._query,t))}};function f1(n,e="asc"){let t=e,r=Tp("orderBy",n);return hS._create(r,t)}function CH(n,e,t,r,i,s,o){let a;if(i.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new B(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){AN(o,s);let u=[];for(let l of o)u.push(DN(r,n,l));a={arrayValue:{values:u}}}else a=DN(r,n,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&AN(o,s),a=EH(t,e,o,s==="in"||s==="not-in");return Ze.create(i,s,a)}function IH(n,e,t){if(n.startAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Us(e,t)}function DN(n,e,t){if(t=Qe(t),typeof t=="string"){if(t==="")throw new B(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uk(e)&&t.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Pe.fromString(t));if(!Q.isDocumentKey(r))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return eN(n,new Q(r))}else{if(t instanceof nt)return eN(n,t._key);throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ap(t)}.`)}}function AN(n,e){if(!Array.isArray(n)||n.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function DH(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function p1(n,e){let t=RH(n.filters,DH(e.op));if(t!==null)throw t===e.op?new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function AH(n,e){let t=n,r=e.getFlattenedFilters();for(let i of r)p1(t,i),t=DS(t,i)}function RH(n,e){for(let t of n)for(let r of t.getFlattenedFilters())if(e.indexOf(r.op)>=0)return r.op;return null}function OH(n){let e=n.filter(r=>r instanceof dS).length,t=n.filter(r=>r instanceof sp).length;if(e>1||e>0&&t>0)throw new B(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var fS=class{convertValue(e,t="none"){switch(Ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($r(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Hi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[_a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Me(o.doubleValue));return new Gi(s)}convertGeoPoint(e){return new $i(Me(e.latitude),Me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=cp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){let t=jr(e);return new Ue(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Pe.fromString(e);Ee(kk(r),9688,{name:e});let i=new Nf(r.get(1),r.get(3)),s=new Q(r.popFirst(5));return i.isEqual(t)||qn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function g1(n,e,t){let r;return n?t&&(t.merge||t.mergeFields)?r=n.toFirestore(e,t):r=n.toFirestore(e):r=e,r}function RN(n){return NH(n,["next","error","complete"])}function NH(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var pS=mS();function Ki(n){let e=JSON.stringify(n);return`${pS.encode(e).byteLength}${e}`}var kH={metadata:{id:"test-bundle",createTime:{seconds:1577836805,nanos:6},version:1,totalDocuments:1,totalBytes:416}};Ki(kH);var PH={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}};Ki(PH);var MH={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}};Ki(MH);var xH={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}};Ki(xH);var LH={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}};Ki(LH);var FH={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}};Ki(FH);var BH={namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:1590011379,nanos:191164e3}}};Ki(BH);var UH={namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:1590011379,nanos:543063e3}}};Ki(UH);var VH=1,op=class{constructor(e,t){this.firestore=e,this.bundleId=t,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new Ue(0,0),this.databaseId=e._databaseId,this.serializer=new Bf(this.databaseId,!0),this.userDataReader=new ep(this.databaseId,!0,this.serializer)}addBundleDocument(e,t){let r=this.documents.get(e.documentPath),i=r?.metadata.queries,s=e.readTime,o=r?.metadata.readTime?bk(r.metadata.readTime):null,a=!s&&o==null,c=s!==void 0&&(o==null||o<s);if((a||c)&&this.documents.set(e.documentPath,{document:this.toBundleDocument(e),metadata:{name:xu(this.serializer,e.documentKey),readTime:s?qr(this.serializer,s):void 0,exists:e.documentExists}}),s&&s>this.latestReadTime&&(this.latestReadTime=s),t){let u=this.documents.get(e.documentPath);u.metadata.queries=i||[],u.metadata.queries.push(t)}}addBundleQuery(e){if(this.namedQueries.has(e.name))throw new Error(`Query name conflict: ${name} has already been added.`);let t=new Ue(0,0);for(let s of e.docBundleDataArray)this.addBundleDocument(s,e.name),s.readTime&&s.readTime>t&&(t=s.readTime);let r=Rk(this.serializer,Vn(e.query)),i={parent:e.parent,structuredQuery:r.queryTarget.structuredQuery};this.namedQueries.set(e.name,{name:e.name,bundledQuery:i,readTime:qr(this.serializer,t)})}toBundleDocument(e){let t=this.userDataReader.createContext(4,"internal toBundledDocument"),r=zS(e.documentData,t);return{name:xu(this.serializer,e.documentKey),fields:r.mapValue.fields,updateTime:qr(this.serializer,e.versionTime),createTime:qr(this.serializer,e.createdTime)}}lengthPrefixedString(e){let t=JSON.stringify(e);return`${pS.encode(t).byteLength}${t}`}build(){let e="";for(let r of this.namedQueries.values())e+=this.lengthPrefixedString({namedQuery:r});for(let r of this.documents.values()){let i=r.metadata;e+=this.lengthPrefixedString({documentMetadata:i});let s=r.document;s&&(e+=this.lengthPrefixedString({document:s}))}let t={id:this.bundleId,createTime:qr(this.serializer,this.latestReadTime),version:VH,totalDocuments:this.documents.size,totalBytes:pS.encode(e).length};return e=this.lengthPrefixedString({metadata:t})+e,e}};function qH(n,e,t,r){let i=new op(n,Ea.newId());return i.addBundleDocument(m1(r,t,e)),i.build()}function zH(n,e,t,r,i,s,o){let a=[];for(let l=0;l<s.length;l++)a.push(m1(i[l],o[l],s[l]));let c={name:t,query:e,parent:r,docBundleDataArray:a},u=new op(n,t);return u.addBundleQuery(c),u.build()}function m1(n,e,t){return{documentData:e,documentKey:t.mutableCopy().key,documentPath:n,documentExists:!0,createdTime:t.createTime.toTimestamp(),readTime:t.readTime.toTimestamp(),versionTime:t.version.toTimestamp()}}var $s=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Gs=class n extends rp{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Na(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let r=this._document.data.field(Tp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new B(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};if(t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument())return t;let r=this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous");return t.bundle=qH(this._firestore,e,r,this.ref.path),t}};Gs._jsonSchemaVersion="firestore/documentSnapshot/1.0";Gs._jsonSchema={type:Xe("string",Gs._jsonSchemaVersion),bundleSource:Xe("string","DocumentSnapshot"),bundleName:Xe("string"),bundle:Xe("string")};var Na=class extends Gs{data(e={}){return super.data(e)}},Hs=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new $s(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Na(this._firestore,this._userDataWriter,r.key,r,new $s(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new B(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=jH(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new B(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ea.newId();let t=this._firestore._databaseId.database,i=`projects/${this._firestore._databaseId.projectId}/databases/${t}/documents`,s=[],o=[],a=[];return this.docs.forEach(c=>{c._document!==null&&(s.push(c._document),o.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),a.push(c.ref.path))}),e.bundle=zH(this._firestore,this.query._query,e.bundleName,i,a,s,o),e}};Hs._jsonSchemaVersion="firestore/querySnapshot/1.0";Hs._jsonSchema={type:Xe("string",Hs._jsonSchemaVersion),bundleSource:Xe("string","QuerySnapshot"),bundleName:Xe("string"),bundle:Xe("string")};function jH(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(r=>{let i=new Na(n._firestore,n._userDataWriter,r.doc.key,r.doc,new $s(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(r=>e||r.type!==3).map(r=>{let i=new Na(n._firestore,n._userDataWriter,r.doc.key,r.doc,new $s(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return r.type!==0&&(s=t.indexOf(r.doc.key),t=t.delete(r.doc.key)),r.type!==1&&(t=t.add(r.doc),o=t.indexOf(r.doc.key)),{type:$H(r.type),doc:i,oldIndex:s,newIndex:o}})}}function $H(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:n})}}function y1(n){n=en(n,nt);let e=en(n.firestore,_r),t=Ep(e);return tH(t,n._key).then(r=>S1(e,n,r))}var ju=class extends fS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new nt(this.firestore,null,t)}};function v1(n){n=en(n,zi);let e=en(n.firestore,_r),t=Ep(e),r=new ju(e);return l1(n._query),nH(t,n._query).then(i=>new Hs(e,r,n,i))}function E1(n,e,t){n=en(n,nt);let r=en(n.firestore,_r),i=g1(n.converter,e,t),s=_p(r),a=a1(s,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,zr.none());return HS(r,[a])}function _1(n,e,t,...r){n=en(n,nt);let i=en(n.firestore,_r),s=_p(i);e=Qe(e);let o;typeof e=="string"||e instanceof Oa?o=vH(s,"updateDoc",n._key,e,t,r):o=yH(s,"updateDoc",n._key,e);let a=o.toMutation(n._key,zr.exists(!0));return HS(i,[a])}function T1(n,e){let t=en(n.firestore,_r),r=qS(n),i=g1(n.converter,e),s=_p(n.firestore),a=a1(s,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,zr.exists(!1));return HS(t,[a]).then(()=>r)}function GS(n,...e){var t,r,i;n=Qe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]=="object"&&!RN(e[o])&&(s=e[o++]);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(RN(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,l;if(n instanceof nt)u=en(n.firestore,_r),l=dp(n._key.path),c={next:h=>{e[o]&&e[o](S1(u,n,h))},error:e[o+1],complete:e[o+2]};else{let h=en(n,zi);u=en(h.firestore,_r),l=h._query;let p=new ju(u);c={next:S=>{e[o]&&e[o](new Hs(u,p,h,S))},error:e[o+1],complete:e[o+2]},l1(n._query)}let d=Ep(u);return eH(d,l,a,c)}function HS(n,e){let t=Ep(n);return rH(t,e)}function S1(n,e,t){let r=t.docs.get(e._key),i=new ju(n);return new Gs(n,i,e._key,r,new $s(t.hasPendingWrites,t.fromCache),e.converter)}gH("node");var Sp=function(){return Sp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Sp.apply(this,arguments)};var WH={includeMetadataChanges:!1};function w1(n,e){return e===void 0&&(e=WH),new nn(function(t){var r=GS(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function b1(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Sp(Sp({},r),(t={},t[e.idField]=n.id,t))}function C1(n){return w1(n,{includeMetadataChanges:!0}).pipe(he(function(e){return e.docs}))}function I1(n,e){return e===void 0&&(e={}),C1(n).pipe(he(function(t){return t.map(function(r){return b1(r,e)})}))}var Ks=class{constructor(e){return e}},D1="firestore",WS=class{constructor(){return Io(D1)}};var KS=new X("angularfire2.firestore-instances");function KH(n,e){let t=Ac(D1,n,e);return t&&new Ks(t)}function QH(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ks(r)}}var YH={provide:WS,deps:[[new qt,KS]]},JH={provide:Ks,useFactory:KH,deps:[[new qt,KS],Ar]};function Xte(n,...e){return Fe("angularfire",ii.full,"fst"),rn([JH,YH,{provide:KS,useFactory:QH(n),multi:!0,deps:[ze,Rt,si,gs,[new qt,Uc],[new qt,Do],...e]}])}var Zte=De(I1,!0);var ene=De(T1,!0,2);var tne=De(i1,!0,2);var QS=De(qS,!0,2);var YS=De(y1,!0);var nne=De(v1,!0);var rne=De(s1,!0);var ine=De(f1,!0,2),sne=De(d1,!0,2);var A1=De(E1,!0,2);var one=De(_1,!0,2);var ane=De(h1,!0,2);var hne=(()=>{class n{constructor(t,r){this.auth=t,this.firestore=r,this.user=_n,this._loading=new Ne(!0),this.loading=this._loading.asObservable(),this.user=hI(this.auth),this.role=this.user.pipe(yt(i=>i?this.getUserRole(i.uid):(this._loading.next(!1),W(null))))}googleLogin(){return E(this,null,function*(){try{let t=yield vI(this.auth,new ey);return t.user&&(yield this.checkAndCreateUser(t.user.uid,t.user.email)),t}catch(t){throw console.error("Error al iniciar sesi\xF3n con Google:",t),t}})}checkAndCreateUser(t,r){return E(this,null,function*(){let i=QS(this.firestore,`users/${t}`);(yield YS(i)).exists()||(yield A1(i,{uid:t,email:r,role:"traveler"}))})}getUserRole(t){let r=QS(this.firestore,`users/${t}`);return We(YS(r)).pipe(yt(i=>{if(this._loading.next(!1),i.exists()){let s=i.data();return W(s.role)}return W(null)}))}emailPassLogin(t,r){return mI(this.auth,t,r)}emailPassSignup(t,r){return fI(this.auth,t,r)}setupRecaptcha(t){return new uy(this.auth,t,{size:"normal",callback:r=>{}})}signInWithPhoneNumber(t,r){return yI(this.auth,t,r)}verifyPhoneLogin(t,r){return gI(this.auth,oy.credential(t,r))}anonLogin(){return pI(this.auth)}logout(){return EI(this.auth)}static{this.\u0275fac=function(r){return new(r||n)(Y(_s),Y(Ks))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{je as a,Hn as b,Hp as c,Ga as d,il as e,Yr as f,ab as g,nP as h,fb as i,rP as j,iP as k,sP as l,cP as m,lP as n,dP as o,fP as p,pP as q,gP as r,mP as s,mb as t,yb as u,yP as v,yl as w,ns as x,c7 as y,Eb as z,ag as A,ec as B,io as C,pg as D,_l as E,kP as F,Cn as G,Cr as H,Fb as I,_g as J,sM as K,oM as L,VK as M,Yb as N,EM as O,qK as P,$l as Q,Xn as R,jg as S,Gg as T,P0 as U,Zn as V,B0 as W,Yx as X,Jx as Y,FQ as Z,tC as _,ds as $,id as aa,nC as ba,sd as ca,sC as da,Cc as ea,cC as fa,qQ as ga,Gt as ha,Dn as ia,er as ja,_L as ka,Qe as la,Ot as ma,tr as na,mC as oa,YQ as pa,Rn as qa,wo as ra,Wt as sa,bo as ta,fs as ua,Fe as va,ii as wa,Ac as xa,Io as ya,si as za,De as Aa,Ar as Ba,gs as Ca,VY as Da,qY as Ea,Do as Fa,_s as Ga,Uc as Ha,cX as Ia,hI as Ja,uX as Ka,Ue as La,Ks as Ma,Xte as Na,Zte as Oa,ene as Pa,tne as Qa,QS as Ra,YS as Sa,nne as Ta,rne as Ua,ine as Va,sne as Wa,one as Xa,ane as Ya,hne as Za};
